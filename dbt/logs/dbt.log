[0m12:10:50.118426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9035ba1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d90360715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9036b9c110>]}


============================== 12:10:50.125085 | 3a136398-db59-42ad-a0ed-9e1e15fb3752 ==============================
[0m12:10:50.125085 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:10:50.126540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/home/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m12:10:50.179613 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/home/user/.dbt')}
[0m12:10:50.179953 [info ] [MainThread]: Creating dbt configuration folder at 
[0m12:11:24.940630 [debug] [MainThread]: Starter project path: /home/user/miniconda3/lib/python3.12/site-packages/dbt/include/starter_project
[0m12:11:24.946004 [info ] [MainThread]: 
Your new dbt project "brave_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:11:24.947130 [info ] [MainThread]: Setting up your profile.
[0m12:14:12.711253 [info ] [MainThread]: Profile brave_project written to /home/user/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:14:12.723157 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 202.63713, "process_user_time": 1.264974, "process_kernel_time": 0.121285, "process_mem_max_rss": "103928", "process_in_blocks": "4392", "process_out_blocks": "88"}
[0m12:14:12.724250 [debug] [MainThread]: Command `dbt init` succeeded at 12:14:12.724044 after 202.64 seconds
[0m12:14:12.724946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d903595dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9035ba3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9035ba1fd0>]}
[0m12:14:12.725670 [debug] [MainThread]: Flushing usage events
[0m12:15:42.228753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c27019eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c272048f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c294f7b60>]}


============================== 12:15:42.230691 | b97c3caf-1612-448f-9066-a57fdc117a52 ==============================
[0m12:15:42.230691 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:15:42.231112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/home/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:15:42.268866 [info ] [MainThread]: dbt version: 1.8.8
[0m12:15:42.269208 [info ] [MainThread]: python version: 3.12.4
[0m12:15:42.269470 [info ] [MainThread]: python path: /home/user/miniconda3/bin/python
[0m12:15:42.269707 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.39
[0m12:15:42.417698 [info ] [MainThread]: Using profiles dir at /home/user/.dbt
[0m12:15:42.418074 [info ] [MainThread]: Using profiles.yml file at /home/user/.dbt/profiles.yml
[0m12:15:42.418331 [info ] [MainThread]: Using dbt_project.yml file at /home/user/Documents/AirflowSnowflakeProject/dbt/dbt_project.yml
[0m12:15:42.418696 [info ] [MainThread]: adapter type: snowflake
[0m12:15:42.418962 [info ] [MainThread]: adapter version: 1.8.4
[0m12:15:42.419215 [info ] [MainThread]: Configuration:
[0m12:15:42.419466 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:15:42.419702 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:15:42.419935 [info ] [MainThread]: Required dependencies:
[0m12:15:42.420189 [debug] [MainThread]: Executing "git --help"
[0m12:15:42.423343 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:15:42.423693 [debug] [MainThread]: STDERR: "b''"
[0m12:15:42.423952 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:15:42.424223 [info ] [MainThread]: Connection:
[0m12:15:42.424510 [info ] [MainThread]:   account: QDLMHKH-FM67721
[0m12:15:42.424777 [info ] [MainThread]:   user: BRAVE_LEARNER_QURRATULAIN
[0m12:15:42.425033 [info ] [MainThread]:   database: BRAVE_DATABASE
[0m12:15:42.425287 [info ] [MainThread]:   warehouse: BRAVE_WAREHOUSE
[0m12:15:42.425536 [info ] [MainThread]:   role: PROJECT_LEARNER_WRITE
[0m12:15:42.425773 [info ] [MainThread]:   schema: PROJECT_TEST
[0m12:15:42.426010 [info ] [MainThread]:   authenticator: None
[0m12:15:42.426244 [info ] [MainThread]:   oauth_client_id: None
[0m12:15:42.426492 [info ] [MainThread]:   query_tag: None
[0m12:15:42.426730 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:15:42.426964 [info ] [MainThread]:   host: None
[0m12:15:42.427198 [info ] [MainThread]:   port: None
[0m12:15:42.427443 [info ] [MainThread]:   proxy_host: None
[0m12:15:42.427679 [info ] [MainThread]:   proxy_port: None
[0m12:15:42.427913 [info ] [MainThread]:   protocol: None
[0m12:15:42.428147 [info ] [MainThread]:   connect_retries: 1
[0m12:15:42.428422 [info ] [MainThread]:   connect_timeout: None
[0m12:15:42.428661 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:15:42.428926 [info ] [MainThread]:   retry_all: False
[0m12:15:42.429181 [info ] [MainThread]:   insecure_mode: False
[0m12:15:42.429449 [info ] [MainThread]:   reuse_connections: None
[0m12:15:42.429808 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:15:42.430971 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:15:42.431497 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:15:42.431763 [debug] [MainThread]: On debug: select 1 as id
[0m12:15:42.432000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:49.791164 [debug] [MainThread]: SQL status: SUCCESS 1 in 7.359 seconds
[0m12:15:49.793860 [debug] [MainThread]: On debug: Close
[0m12:15:49.913134 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:15:49.914232 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:15:49.915199 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/user/Documents/AirflowSnowflakeProject/dbt/dbt_project.yml> not found

[0m12:15:49.917132 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 7.7199874, "process_user_time": 1.269336, "process_kernel_time": 0.089263, "process_mem_max_rss": "112580", "process_in_blocks": "2744", "process_out_blocks": "1328", "command_success": false}
[0m12:15:49.918617 [debug] [MainThread]: Command `dbt debug` failed at 12:15:49.918323 after 7.72 seconds
[0m12:15:49.919470 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:15:49.920312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c27c17440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c2608ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791c2626ef00>]}
[0m12:15:49.921444 [debug] [MainThread]: Flushing usage events
[0m12:26:36.311335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9cc8ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9b0b62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9b0b7f50>]}


============================== 12:26:36.313344 | 244004d8-40ee-4512-a624-c8c03997129a ==============================
[0m12:26:36.313344 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:26:36.313782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'profiles_dir': '/home/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:36.350638 [info ] [MainThread]: dbt version: 1.8.8
[0m12:26:36.350993 [info ] [MainThread]: python version: 3.12.4
[0m12:26:36.351263 [info ] [MainThread]: python path: /home/user/miniconda3/bin/python
[0m12:26:36.351516 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.39
[0m12:26:36.353750 [info ] [MainThread]: Using profiles dir at /home/user/.dbt
[0m12:26:36.354030 [info ] [MainThread]: Using profiles.yml file at /home/user/.dbt/profiles.yml
[0m12:26:36.354271 [info ] [MainThread]: Using dbt_project.yml file at /home/user/Documents/AirflowSnowflakeProject/dbt/dbt_project.yml
[0m12:26:36.425621 [info ] [MainThread]: Configuration:
[0m12:26:36.426014 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m12:26:36.426275 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:26:36.426531 [info ] [MainThread]: Required dependencies:
[0m12:26:36.426793 [debug] [MainThread]: Executing "git --help"
[0m12:26:36.429459 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:26:36.430613 [debug] [MainThread]: STDERR: "b''"
[0m12:26:36.431442 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:26:36.432304 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:26:36.433345 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:26:36.434254 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'brave_de_project'


[0m12:26:36.435965 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.17833683, "process_user_time": 0.965993, "process_kernel_time": 0.055941, "process_mem_max_rss": "89384", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m12:26:36.437269 [debug] [MainThread]: Command `dbt debug` failed at 12:26:36.436989 after 0.18 seconds
[0m12:26:36.438274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9b585160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9c6c2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725d9cc8ce00>]}
[0m12:26:36.439298 [debug] [MainThread]: Flushing usage events
[0m12:28:37.499275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb396d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb3986150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb39863c0>]}


============================== 12:28:37.505600 | 3030b027-c0a9-4f07-908a-fa71cfa2b696 ==============================
[0m12:28:37.505600 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:28:37.506977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:28:37.571980 [info ] [MainThread]: dbt version: 1.8.8
[0m12:28:37.572407 [info ] [MainThread]: python version: 3.12.4
[0m12:28:37.572726 [info ] [MainThread]: python path: /home/user/miniconda3/bin/python
[0m12:28:37.573023 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.39
[0m12:28:37.717870 [info ] [MainThread]: Using profiles dir at /home/user/.dbt
[0m12:28:37.718225 [info ] [MainThread]: Using profiles.yml file at /home/user/.dbt/profiles.yml
[0m12:28:37.718517 [info ] [MainThread]: Using dbt_project.yml file at /home/user/Documents/AirflowSnowflakeProject/dbt/dbt_project.yml
[0m12:28:37.718865 [info ] [MainThread]: adapter type: snowflake
[0m12:28:37.719129 [info ] [MainThread]: adapter version: 1.8.4
[0m12:28:37.788245 [info ] [MainThread]: Configuration:
[0m12:28:37.788651 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:28:37.788912 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:28:37.789159 [info ] [MainThread]: Required dependencies:
[0m12:28:37.789435 [debug] [MainThread]: Executing "git --help"
[0m12:28:37.792435 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:28:37.792784 [debug] [MainThread]: STDERR: "b''"
[0m12:28:37.793033 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:28:37.793284 [info ] [MainThread]: Connection:
[0m12:28:37.793550 [info ] [MainThread]:   account: QDLMHKH-FM67721
[0m12:28:37.793791 [info ] [MainThread]:   user: BRAVE_LEARNER_QURRATULAIN
[0m12:28:37.794091 [info ] [MainThread]:   database: BRAVE_DATABASE
[0m12:28:37.794509 [info ] [MainThread]:   warehouse: BRAVE_WAREHOUSE
[0m12:28:37.794881 [info ] [MainThread]:   role: PROJECT_LEARNER_WRITE
[0m12:28:37.795311 [info ] [MainThread]:   schema: PROJECT_TEST
[0m12:28:37.795742 [info ] [MainThread]:   authenticator: None
[0m12:28:37.796120 [info ] [MainThread]:   oauth_client_id: None
[0m12:28:37.796506 [info ] [MainThread]:   query_tag: None
[0m12:28:37.796918 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:28:37.797333 [info ] [MainThread]:   host: None
[0m12:28:37.797715 [info ] [MainThread]:   port: None
[0m12:28:37.798092 [info ] [MainThread]:   proxy_host: None
[0m12:28:37.798472 [info ] [MainThread]:   proxy_port: None
[0m12:28:37.798841 [info ] [MainThread]:   protocol: None
[0m12:28:37.799210 [info ] [MainThread]:   connect_retries: 1
[0m12:28:37.799601 [info ] [MainThread]:   connect_timeout: None
[0m12:28:37.799964 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:28:37.800329 [info ] [MainThread]:   retry_all: False
[0m12:28:37.800639 [info ] [MainThread]:   insecure_mode: False
[0m12:28:37.800884 [info ] [MainThread]:   reuse_connections: None
[0m12:28:37.801238 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:28:37.802643 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:28:37.803228 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:28:37.803546 [debug] [MainThread]: On debug: select 1 as id
[0m12:28:37.803816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:44.420522 [debug] [MainThread]: SQL status: SUCCESS 1 in 6.616 seconds
[0m12:28:44.423294 [debug] [MainThread]: On debug: Close
[0m12:28:44.513565 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:28:44.514674 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:28:44.516687 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 7.0491276, "process_user_time": 1.266479, "process_kernel_time": 0.091962, "process_mem_max_rss": "112380", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:28:44.518153 [debug] [MainThread]: Command `dbt debug` succeeded at 12:28:44.517874 after 7.05 seconds
[0m12:28:44.519100 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:28:44.520091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb3bce480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb2a782f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bcb388ef30>]}
[0m12:28:44.521177 [debug] [MainThread]: Flushing usage events
[0m12:30:44.092141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588f7cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58a387530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588f7cda0>]}


============================== 12:30:44.098506 | 2f54853f-68e0-474a-be4c-3f5ac09ec9b5 ==============================
[0m12:30:44.098506 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:30:44.099884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:44.278763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588af7950>]}
[0m12:30:44.288056 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h1sfvnek'
[0m12:30:44.288529 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:30:44.419921 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:30:44.421371 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:30:44.516468 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:30:44.531514 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:30:44.624435 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:30:44.631003 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m12:30:45.112746 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:45.113830 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m12:30:45.114966 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m12:30:45.115888 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:45.120208 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:45.121152 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.122001 [debug] [MainThread]: Checking out revision main.
[0m12:30:45.122863 [debug] [MainThread]: Executing "git remote set-branches origin main"
[0m12:30:45.127451 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:45.128276 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.129105 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags main"
[0m12:30:45.714255 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:45.715422 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            main       -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.0.2      -> 0.0.2\n * [new tag]         0.0.6      -> 0.0.6\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.10.0     -> 0.10.0\n * [new tag]         0.11.0     -> 0.11.0\n * [new tag]         0.12.0     -> 0.12.0\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         v0.0.3     -> v0.0.3\n * [new tag]         v0.0.4     -> v0.0.4\n * [new tag]         v0.0.5     -> v0.0.5\n * [new tag]         v0.11.0    -> v0.11.0\n'"
[0m12:30:45.716424 [debug] [MainThread]: Executing "git tag --list"
[0m12:30:45.720950 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.0.2\n0.0.6\n0.1.0\n0.10.0\n0.11.0\n0.12.0\n0.2.0\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.6.0\n0.7.0\n0.7.1\n0.8.0\n0.9.0\nv0.0.3\nv0.0.4\nv0.0.5\nv0.11.0\n'"
[0m12:30:45.721619 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.722184 [debug] [MainThread]: Executing "git reset --hard origin/main"
[0m12:30:45.734052 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m12:30:45.734872 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.735623 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:45.739450 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:45.740239 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.741026 [debug] [MainThread]: Checked out at 6499107.
[0m12:30:45.741936 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/dbt-labs/dbt-audit-helper.git" 
	is pinned to the "main" branch.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m12:30:45.742925 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:45.746980 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:45.747903 [debug] [MainThread]: STDERR: "b''"
[0m12:30:45.752698 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Montreal-Analytics/snowflake_utils.json
[0m12:30:45.837724 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Montreal-Analytics/snowflake_utils.json 200
[0m12:30:45.841454 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m12:30:45.933440 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m12:30:45.938017 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/data-mie/dbt_profiler.json
[0m12:30:46.037360 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/data-mie/dbt_profiler.json 200
[0m12:30:46.062286 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m12:30:46.066659 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:46.067142 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m12:30:46.067586 [debug] [MainThread]: command return code=128
[0m12:30:46.068695 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m12:30:46.069127 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:46.072525 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:46.072963 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.073348 [debug] [MainThread]: Checking out revision main.
[0m12:30:46.073827 [debug] [MainThread]: Executing "git remote set-branches origin main"
[0m12:30:46.077446 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:46.078322 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.079171 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags main"
[0m12:30:46.504516 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:46.505584 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            main       -> FETCH_HEAD\n'"
[0m12:30:46.506470 [debug] [MainThread]: Executing "git tag --list"
[0m12:30:46.511042 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.0.2\n0.0.6\n0.1.0\n0.10.0\n0.11.0\n0.12.0\n0.2.0\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.6.0\n0.7.0\n0.7.1\n0.8.0\n0.9.0\nv0.0.3\nv0.0.4\nv0.0.5\nv0.11.0\n'"
[0m12:30:46.512021 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.512896 [debug] [MainThread]: Executing "git reset --hard origin/main"
[0m12:30:46.525243 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m12:30:46.526152 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.526996 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:46.531019 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:46.531899 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.532724 [debug] [MainThread]: Already at 6499107, nothing to do.
[0m12:30:46.533630 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/dbt-labs/dbt-audit-helper.git" 
	is pinned to the "main" branch.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m12:30:46.534623 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:46.538663 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:46.539593 [debug] [MainThread]: STDERR: "b''"
[0m12:30:46.560460 [info ] [MainThread]: Updating lock file in file path: /home/user/Documents/AirflowSnowflakeProject/dbt/package-lock.yml
[0m12:30:46.567423 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6nq6i1uz'
[0m12:30:46.579207 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:30:46.959744 [info ] [MainThread]: Installed from version 1.1.1
[0m12:30:46.960313 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:30:46.960719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588f7ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588e001a0>]}
[0m12:30:46.961092 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:30:47.264863 [info ] [MainThread]: Installed from version 0.10.0
[0m12:30:47.265667 [info ] [MainThread]: Updated version available: 0.10.1
[0m12:30:47.266393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b5ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588fb9820>]}
[0m12:30:47.267109 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-audit-helper.git
[0m12:30:47.267783 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m12:30:47.723740 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:47.724542 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m12:30:47.725103 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m12:30:47.725655 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:47.729373 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:47.730160 [debug] [MainThread]: STDERR: "b''"
[0m12:30:47.730874 [debug] [MainThread]: Checking out revision 6499107b5960d7c6140a8a44345034e6eb7b336d.
[0m12:30:47.731613 [debug] [MainThread]: Executing "git fetch origin --depth 1 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m12:30:48.147471 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:48.148562 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            6499107b5960d7c6140a8a44345034e6eb7b336d -> FETCH_HEAD\n'"
[0m12:30:48.149469 [debug] [MainThread]: Executing "git reset --hard 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m12:30:48.162177 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m12:30:48.163129 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.163991 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:48.168145 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:48.169534 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.170859 [debug] [MainThread]: Checked out at 6499107.
[0m12:30:48.172239 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:48.176475 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:48.177326 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.180057 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m12:30:48.183980 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:48.184781 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m12:30:48.185508 [debug] [MainThread]: command return code=128
[0m12:30:48.187334 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m12:30:48.188082 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:48.191880 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:48.192655 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.193352 [debug] [MainThread]: Checking out revision 6499107b5960d7c6140a8a44345034e6eb7b336d.
[0m12:30:48.194110 [debug] [MainThread]: Executing "git fetch origin --depth 1 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m12:30:48.614706 [debug] [MainThread]: STDOUT: "b''"
[0m12:30:48.616323 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            6499107b5960d7c6140a8a44345034e6eb7b336d -> FETCH_HEAD\n'"
[0m12:30:48.617793 [debug] [MainThread]: Executing "git reset --hard 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m12:30:48.625214 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m12:30:48.626154 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.627043 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:30:48.631238 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m12:30:48.632199 [debug] [MainThread]: STDERR: "b''"
[0m12:30:48.633047 [debug] [MainThread]: Already at 6499107, nothing to do.
[0m12:30:48.659661 [info ] [MainThread]: Installed from revision 6499107b5960d7c6140a8a44345034e6eb7b336d
[0m12:30:48.660209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7a870>]}
[0m12:30:48.660711 [info ] [MainThread]: Installing Montreal-Analytics/snowflake_utils
[0m12:30:48.861998 [info ] [MainThread]: Installed from version 0.6.3
[0m12:30:48.863107 [info ] [MainThread]: Up to date!
[0m12:30:48.864156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588ac06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588a3df10>]}
[0m12:30:48.865239 [info ] [MainThread]: Installing dbt-labs/codegen
[0m12:30:49.091117 [info ] [MainThread]: Installed from version 0.12.1
[0m12:30:49.092243 [info ] [MainThread]: Up to date!
[0m12:30:49.093024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7a210>]}
[0m12:30:49.093736 [info ] [MainThread]: Installing data-mie/dbt_profiler
[0m12:30:49.385355 [info ] [MainThread]: Installed from version 0.8.1
[0m12:30:49.386182 [info ] [MainThread]: Updated version available: 0.8.3
[0m12:30:49.386914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f54853f-68e0-474a-be4c-3f5ac09ec9b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e588b7b860>]}
[0m12:30:49.387662 [info ] [MainThread]: 
[0m12:30:49.388331 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'data-mie/dbt_profiler']                 
Update your versions in packages.yml, then run dbt deps
[0m12:30:49.390395 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.330529, "process_user_time": 1.33925, "process_kernel_time": 0.128831, "process_mem_max_rss": "90472", "process_in_blocks": "192", "process_out_blocks": "5888"}
[0m12:30:49.391472 [debug] [MainThread]: Command `dbt deps` succeeded at 12:30:49.391254 after 5.33 seconds
[0m12:30:49.392169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58b0c3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58911fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73e58a297080>]}
[0m12:30:49.392911 [debug] [MainThread]: Flushing usage events
[0m12:32:48.623453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e299a4b8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e299a822030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e299a1c8320>]}


============================== 12:32:48.629812 | cffe78b3-b8e1-4f55-a3a1-253b8b259593 ==============================
[0m12:32:48.629812 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:32:48.631201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/user/.dbt', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:32:48.634247 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/user/.dbt/profiles.yml
  
[0m12:32:48.635533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.045296624, "process_user_time": 0.827594, "process_kernel_time": 0.07005, "process_mem_max_rss": "86204", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:32:48.636444 [debug] [MainThread]: Command `dbt run` failed at 12:32:48.636253 after 0.05 seconds
[0m12:32:48.637077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e299a856000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e299a32a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2999e16540>]}
[0m12:32:48.637786 [debug] [MainThread]: Flushing usage events
[0m12:33:55.263473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae245274b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae24389d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae24389e1b0>]}


============================== 12:33:55.269894 | e089004e-99da-42e1-be63-200a575c6fcc ==============================
[0m12:33:55.269894 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:33:55.271257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:33:55.536775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae242918590>]}
[0m12:33:55.576998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae244eaab40>]}
[0m12:33:55.577517 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:33:55.622171 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:33:55.622825 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:33:55.623138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae2427adac0>]}
[0m12:33:56.843859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.brave_de_project.raw_data
- models
- models.brave_de_project
- models.brave_de_project.data_mart
- seeds.brave_de_project
[0m12:33:56.847616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae2425ca510>]}
[0m12:33:56.916871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae242446e10>]}
[0m12:33:56.918025 [info ] [MainThread]: Found 843 macros
[0m12:33:56.918965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e089004e-99da-42e1-be63-200a575c6fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae242684fb0>]}
[0m12:33:56.922584 [info ] [MainThread]: 
[0m12:33:56.923551 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:33:56.924827 [debug] [MainThread]: Command end result
[0m12:33:56.961180 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7295215, "process_user_time": 2.484275, "process_kernel_time": 0.084009, "process_mem_max_rss": "113680", "process_in_blocks": "40", "process_out_blocks": "5248"}
[0m12:33:56.961717 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:56.961615 after 1.73 seconds
[0m12:33:56.962036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae2449938f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae2428b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae243790ad0>]}
[0m12:33:56.962338 [debug] [MainThread]: Flushing usage events
[0m12:37:52.642396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867011cd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867005eb500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867002fd190>]}


============================== 12:37:52.644296 | 90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7 ==============================
[0m12:37:52.644296 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:37:52.644786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:52.894932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866ff2916a0>]}
[0m12:37:52.935387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867003c8500>]}
[0m12:37:52.935956 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:37:52.961102 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:37:52.997127 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:37:52.997534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786700a599a0>]}
[0m12:37:54.153454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.brave_de_project
- models.brave_de_project.raw_data
- models
- models.brave_de_project.data_mart
- seeds.brave_de_project
[0m12:37:54.157216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78670148faa0>]}
[0m12:37:54.202002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866fefc8590>]}
[0m12:37:54.202418 [info ] [MainThread]: Found 843 macros
[0m12:37:54.202726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90bbe5da-5de3-40d9-9ee1-f68a46a9b7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78670073cf50>]}
[0m12:37:54.203761 [info ] [MainThread]: 
[0m12:37:54.204063 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:37:54.204461 [debug] [MainThread]: Command end result
[0m12:37:54.233266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6230034, "process_user_time": 2.36286, "process_kernel_time": 0.087957, "process_mem_max_rss": "115716", "process_out_blocks": "5248", "process_in_blocks": "0"}
[0m12:37:54.233787 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:54.233691 after 1.62 seconds
[0m12:37:54.234105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867011cd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866fedfb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866fef41d60>]}
[0m12:37:54.234412 [debug] [MainThread]: Flushing usage events
[0m12:38:26.306219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815ff149f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815ff736cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815ff5a2270>]}


============================== 12:38:26.312625 | 249de6db-4c3d-4021-bfa2-64a3fbaccb3a ==============================
[0m12:38:26.312625 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:38:26.313994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:26.362391 [info ] [MainThread]: dbt version: 1.8.8
[0m12:38:26.362764 [info ] [MainThread]: python version: 3.12.4
[0m12:38:26.363021 [info ] [MainThread]: python path: /home/user/miniconda3/bin/python
[0m12:38:26.363262 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.39
[0m12:38:26.511482 [info ] [MainThread]: Using profiles dir at /home/user/.dbt
[0m12:38:26.511890 [info ] [MainThread]: Using profiles.yml file at /home/user/.dbt/profiles.yml
[0m12:38:26.512158 [info ] [MainThread]: Using dbt_project.yml file at /home/user/Documents/AirflowSnowflakeProject/dbt/dbt_project.yml
[0m12:38:26.512517 [info ] [MainThread]: adapter type: snowflake
[0m12:38:26.512796 [info ] [MainThread]: adapter version: 1.8.4
[0m12:38:26.582003 [info ] [MainThread]: Configuration:
[0m12:38:26.582350 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:38:26.582638 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:38:26.582894 [info ] [MainThread]: Required dependencies:
[0m12:38:26.583161 [debug] [MainThread]: Executing "git --help"
[0m12:38:26.586129 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:38:26.586471 [debug] [MainThread]: STDERR: "b''"
[0m12:38:26.586714 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:38:26.586964 [info ] [MainThread]: Connection:
[0m12:38:26.587212 [info ] [MainThread]:   account: QDLMHKH-FM67721
[0m12:38:26.587468 [info ] [MainThread]:   user: BRAVE_LEARNER_QURRATULAIN
[0m12:38:26.587707 [info ] [MainThread]:   database: BRAVE_DATABASE
[0m12:38:26.587942 [info ] [MainThread]:   warehouse: BRAVE_WAREHOUSE
[0m12:38:26.588176 [info ] [MainThread]:   role: PROJECT_LEARNER_WRITE
[0m12:38:26.588456 [info ] [MainThread]:   schema: PROJECT_TEST
[0m12:38:26.588719 [info ] [MainThread]:   authenticator: None
[0m12:38:26.588978 [info ] [MainThread]:   oauth_client_id: None
[0m12:38:26.589233 [info ] [MainThread]:   query_tag: None
[0m12:38:26.589510 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:38:26.589761 [info ] [MainThread]:   host: None
[0m12:38:26.589997 [info ] [MainThread]:   port: None
[0m12:38:26.590230 [info ] [MainThread]:   proxy_host: None
[0m12:38:26.590483 [info ] [MainThread]:   proxy_port: None
[0m12:38:26.590725 [info ] [MainThread]:   protocol: None
[0m12:38:26.590958 [info ] [MainThread]:   connect_retries: 1
[0m12:38:26.591192 [info ] [MainThread]:   connect_timeout: None
[0m12:38:26.591453 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:38:26.591700 [info ] [MainThread]:   retry_all: False
[0m12:38:26.591934 [info ] [MainThread]:   insecure_mode: False
[0m12:38:26.592167 [info ] [MainThread]:   reuse_connections: None
[0m12:38:26.592523 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:38:26.593886 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:38:26.594459 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:38:26.594728 [debug] [MainThread]: On debug: select 1 as id
[0m12:38:26.594975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:33.431970 [debug] [MainThread]: SQL status: SUCCESS 1 in 6.837 seconds
[0m12:38:33.434878 [debug] [MainThread]: On debug: Close
[0m12:38:33.519633 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:38:33.520771 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:38:33.522808 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 7.2504334, "process_user_time": 1.227866, "process_kernel_time": 0.072932, "process_mem_max_rss": "112976", "process_out_blocks": "48", "process_in_blocks": "0"}
[0m12:38:33.524286 [debug] [MainThread]: Command `dbt debug` succeeded at 12:38:33.524006 after 7.25 seconds
[0m12:38:33.525241 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:38:33.526236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815ff149f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815ffd72360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7815fdccef00>]}
[0m12:38:33.527582 [debug] [MainThread]: Flushing usage events
[0m12:38:43.379349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7ff8e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7f6c9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7f4224e0>]}


============================== 12:38:43.385741 | 5a021d84-8d16-4759-a08a-d31d8ca223f9 ==============================
[0m12:38:43.385741 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:38:43.387109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:43.685655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a021d84-8d16-4759-a08a-d31d8ca223f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e453b30>]}
[0m12:38:43.726235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a021d84-8d16-4759-a08a-d31d8ca223f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e91ca40>]}
[0m12:38:43.726771 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:38:43.751847 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:38:43.804509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:43.804831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:43.805175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.brave_de_project.data_mart
- models
- models.brave_de_project.raw_data
- models.brave_de_project
- seeds.brave_de_project
[0m12:38:43.808956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a021d84-8d16-4759-a08a-d31d8ca223f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e3331d0>]}
[0m12:38:43.881368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a021d84-8d16-4759-a08a-d31d8ca223f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e11f260>]}
[0m12:38:43.881798 [info ] [MainThread]: Found 843 macros
[0m12:38:43.882934 [info ] [MainThread]: 
[0m12:38:43.883246 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:38:43.884567 [debug] [MainThread]: Command end result
[0m12:38:43.916628 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.57150054, "process_user_time": 1.321598, "process_kernel_time": 0.090834, "process_mem_max_rss": "115624", "process_out_blocks": "3488", "process_in_blocks": "0"}
[0m12:38:43.917117 [debug] [MainThread]: Command `dbt build` succeeded at 12:38:43.917025 after 0.57 seconds
[0m12:38:43.917444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7f4224e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e4c2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e7e356ed0>]}
[0m12:38:43.917753 [debug] [MainThread]: Flushing usage events
[0m12:40:34.809640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e34274a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e3267bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e4c10920>]}


============================== 12:40:34.811560 | 5c92d3bb-40a5-4fcf-b22f-a38a30386c3c ==============================
[0m12:40:34.811560 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:40:34.812004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -select brave_de_project/models/raw_data/stg_product_data_qu.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:40:35.060658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c92d3bb-40a5-4fcf-b22f-a38a30386c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e21051f0>]}
[0m12:40:35.100556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c92d3bb-40a5-4fcf-b22f-a38a30386c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e3161f70>]}
[0m12:40:35.101079 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:40:35.125689 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:40:35.179682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:35.180017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:35.180392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models
- models.brave_de_project.data_mart
- models.brave_de_project.raw_data
- models.brave_de_project
- seeds.brave_de_project
[0m12:40:35.184384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c92d3bb-40a5-4fcf-b22f-a38a30386c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e3161eb0>]}
[0m12:40:35.229718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c92d3bb-40a5-4fcf-b22f-a38a30386c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e1d023c0>]}
[0m12:40:35.230090 [info ] [MainThread]: Found 843 macros
[0m12:40:35.230390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c92d3bb-40a5-4fcf-b22f-a38a30386c3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e1d87680>]}
[0m12:40:35.230942 [warn ] [MainThread]: The selection criterion 'elect' does not match any enabled nodes
[0m12:40:35.231650 [warn ] [MainThread]: The selection criterion 'brave_de_project/models/raw_data/stg_product_data_qu.sql' does not match any enabled nodes
[0m12:40:35.232487 [info ] [MainThread]: 
[0m12:40:35.232781 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:35.234027 [debug] [MainThread]: Command end result
[0m12:40:35.271867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4942882, "process_user_time": 1.223035, "process_kernel_time": 0.072002, "process_mem_max_rss": "114320", "process_out_blocks": "3480", "process_in_blocks": "0"}
[0m12:40:35.272383 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:35.272281 after 0.49 seconds
[0m12:40:35.272710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e34274a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e3579040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f4e2089400>]}
[0m12:40:35.273008 [debug] [MainThread]: Flushing usage events
[0m12:44:23.419793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c873560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c370710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c8efc50>]}


============================== 12:44:23.421704 | 5d75e00d-f548-40ec-a285-be8e3485960d ==============================
[0m12:44:23.421704 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:44:23.422127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:23.667294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540ba40bf0>]}
[0m12:44:23.707056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540b5927b0>]}
[0m12:44:23.707589 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:44:23.732445 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:44:23.768515 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:44:23.768907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540aa63fe0>]}
[0m12:44:25.227893 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:44:25.228323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540be85130>]}
[0m12:44:25.514609 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.brave_de_project.test_stock_dates' (brave_de_project/tests/test_stock_dates.sql) depends on a node named 'dim_inventory_qu' in package '' which was not found
[0m12:44:25.589079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.brave_de_project
[0m12:44:25.597629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a97bda0>]}
[0m12:44:25.700824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a98cf50>]}
[0m12:44:25.701224 [info ] [MainThread]: Found 13 models, 52 data tests, 4 sources, 851 macros, 7 unit tests
[0m12:44:25.701554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a8c40b0>]}
[0m12:44:25.703593 [info ] [MainThread]: 
[0m12:44:25.704056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:25.707892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BRAVE_DATABASE'
[0m12:44:25.736930 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE"
[0m12:44:25.737941 [debug] [ThreadPool]: On list_BRAVE_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE"} */
show terse schemas in database BRAVE_DATABASE
    limit 10000
[0m12:44:25.738816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:30.148566 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.410 seconds
[0m12:44:30.152673 [debug] [ThreadPool]: On list_BRAVE_DATABASE: Close
[0m12:44:30.237786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE, now list_BRAVE_DATABASE_PROJECT_TEST)
[0m12:44:30.258709 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE_PROJECT_TEST"
[0m12:44:30.259450 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE_PROJECT_TEST"} */
show objects in BRAVE_DATABASE.PROJECT_TEST limit 10000
[0m12:44:30.260075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:44:34.236222 [debug] [ThreadPool]: SQL status: SUCCESS 99 in 3.976 seconds
[0m12:44:34.247340 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: Close
[0m12:44:34.360517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a57d670>]}
[0m12:44:34.361487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:34.362131 [info ] [MainThread]: 
[0m12:44:34.384175 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_inventory_data_qu
[0m12:44:34.386017 [info ] [Thread-1 (]: 1 of 13 START sql view model PROJECT_TEST.stg_inventory_data_qu ................ [RUN]
[0m12:44:34.387643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE_PROJECT_TEST, now model.brave_de_project.stg_inventory_data_qu)
[0m12:44:34.388804 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_inventory_data_qu
[0m12:44:34.411039 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_inventory_data_qu"
[0m12:44:34.412701 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_inventory_data_qu
[0m12:44:34.444280 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_inventory_data_qu"
[0m12:44:34.446136 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_inventory_data_qu"
[0m12:44:34.446705 [debug] [Thread-1 (]: On model.brave_de_project.stg_inventory_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_inventory_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu
  
  copy grants as (
    


with source as (

    select * from brave_database.de_project.inventory_data

),

staging_data as (

    select
        inventory_id,
        warehouse_id,
        stock_level,
        restock_date,
        supplier_id,
        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,
        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,
        reorder_level,
        quantity_in_stock,
        sales_volume,
        safety_stock,
        average_monthly_demand,
        last_restock_date,
        next_restock_date,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract last audit date from timestamp and
        -- convert to date format
        CAST(last_audit_date AS DATE) AS last_audit_date, 

        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        rating IS NULL OR TRIM(rating) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))
    )
 AS rating, 
      
        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        weight IS NULL OR TRIM(weight) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS prod_weight, 
        
        -- Change data type to NUMBER(38,2)
        
    IFF(
        discounts IS NULL OR TRIM(discounts) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS discounts

    from source

)

select * from staging_data
  );
[0m12:44:34.447121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:38.676652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.229 seconds
[0m12:44:38.710712 [debug] [Thread-1 (]: On model.brave_de_project.stg_inventory_data_qu: Close
[0m12:44:38.788581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540aeb3290>]}
[0m12:44:38.790345 [info ] [Thread-1 (]: 1 of 13 OK created sql view model PROJECT_TEST.stg_inventory_data_qu ........... [[32mSUCCESS 1[0m in 4.40s]
[0m12:44:38.792087 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_inventory_data_qu
[0m12:44:38.793356 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_product_data_qu
[0m12:44:38.794980 [info ] [Thread-1 (]: 2 of 13 START sql view model PROJECT_TEST.stg_product_data_qu .................. [RUN]
[0m12:44:38.796507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_inventory_data_qu, now model.brave_de_project.stg_product_data_qu)
[0m12:44:38.797622 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_product_data_qu
[0m12:44:38.804167 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_product_data_qu"
[0m12:44:38.805175 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_product_data_qu
[0m12:44:38.810142 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_product_data_qu"
[0m12:44:38.812041 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_product_data_qu"
[0m12:44:38.812690 [debug] [Thread-1 (]: On model.brave_de_project.stg_product_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_product_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.product_data

),

staging_data as (

    select
        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract warranty_period from varchar to NUMBER
        
    IFF(
        warranty_period IS NULL OR TRIM(warranty_period) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)
    )
 AS warranty_period_months, 
      
        -- Converting to smaller string
        CAST(product_name AS VARCHAR(64)) AS product_name,
        CAST(product_category AS VARCHAR(64)) AS product_category,
        CAST(product_color AS VARCHAR(64)) AS product_color,

        price,
        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       
        manufacturing_date,
        expiration_date,
        quantity_in_stock,
        rating,
        sales_volume,
        weight_grams,
        discount_percentage

    from source

)

select * from staging_data
  );
[0m12:44:38.813250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:42.467873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.654 seconds
[0m12:44:42.472914 [debug] [Thread-1 (]: On model.brave_de_project.stg_product_data_qu: Close
[0m12:44:42.565827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540954e9c0>]}
[0m12:44:42.567569 [info ] [Thread-1 (]: 2 of 13 OK created sql view model PROJECT_TEST.stg_product_data_qu ............. [[32mSUCCESS 1[0m in 3.77s]
[0m12:44:42.569259 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_product_data_qu
[0m12:44:42.570522 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_data_qu
[0m12:44:42.571863 [info ] [Thread-1 (]: 3 of 13 START sql view model PROJECT_TEST.stg_user_data_qu ..................... [RUN]
[0m12:44:42.573539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_product_data_qu, now model.brave_de_project.stg_user_data_qu)
[0m12:44:42.574628 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_data_qu
[0m12:44:42.584524 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_data_qu"
[0m12:44:42.585498 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_data_qu
[0m12:44:42.589455 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_user_data_qu"
[0m12:44:42.591681 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_user_data_qu"
[0m12:44:42.592316 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_user_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
  );
[0m12:44:42.592917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:46.431813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.839 seconds
[0m12:44:46.436859 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_data_qu: Close
[0m12:44:46.524077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735409d6a7b0>]}
[0m12:44:46.525842 [info ] [Thread-1 (]: 3 of 13 OK created sql view model PROJECT_TEST.stg_user_data_qu ................ [[32mSUCCESS 1[0m in 3.95s]
[0m12:44:46.527560 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_data_qu
[0m12:44:46.528777 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_journey_qu
[0m12:44:46.530307 [info ] [Thread-1 (]: 4 of 13 START sql view model PROJECT_TEST.stg_user_journey_qu .................. [RUN]
[0m12:44:46.531810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_data_qu, now model.brave_de_project.stg_user_journey_qu)
[0m12:44:46.532912 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_journey_qu
[0m12:44:46.540453 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_journey_qu"
[0m12:44:46.541479 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_journey_qu
[0m12:44:46.546238 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_user_journey_qu"
[0m12:44:46.550281 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_user_journey_qu"
[0m12:44:46.551027 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_journey_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_user_journey_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
  );
[0m12:44:46.551736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:50.805124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.253 seconds
[0m12:44:50.810111 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_journey_qu: Close
[0m12:44:50.907605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540ac5da30>]}
[0m12:44:50.909351 [info ] [Thread-1 (]: 4 of 13 OK created sql view model PROJECT_TEST.stg_user_journey_qu ............. [[32mSUCCESS 1[0m in 4.37s]
[0m12:44:50.911044 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_journey_qu
[0m12:44:50.912264 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_inv_detail_qu
[0m12:44:50.913853 [info ] [Thread-1 (]: 5 of 13 START sql incremental model PROJECT_TEST.dim_inv_detail_qu ............. [RUN]
[0m12:44:50.915426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_journey_qu, now model.brave_de_project.dim_inv_detail_qu)
[0m12:44:50.916538 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_inv_detail_qu
[0m12:44:50.925178 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:50.926289 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_inv_detail_qu
[0m12:44:50.960412 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:50.960825 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu
),


inventory_data AS (
   SELECT
      md5(cast(coalesce(cast(storage_condition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(inventory_status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as inv_detail_id,
      storage_condition,
      inventory_status
      
   FROM source
   GROUP BY storage_condition, inventory_status
)


SELECT * FROM inventory_data
  );
[0m12:44:50.961181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:54.441726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.480 seconds
[0m12:44:54.459437 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.460258 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
[0m12:44:54.531603 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.070 seconds
[0m12:44:54.540715 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.551337 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
[0m12:44:54.627964 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.076 seconds
[0m12:44:54.645597 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.651467 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_INV_DETAIL_QU"
[0m12:44:54.717267 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.065 seconds
[0m12:44:54.760344 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.761434 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.761802 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:44:54.841078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m12:44:54.842221 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:54.843349 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.inv_detail_id = DBT_INTERNAL_DEST.inv_detail_id
            )

    
    when matched then update set
        "INV_DETAIL_ID" = DBT_INTERNAL_SOURCE."INV_DETAIL_ID","STORAGE_CONDITION" = DBT_INTERNAL_SOURCE."STORAGE_CONDITION","INVENTORY_STATUS" = DBT_INTERNAL_SOURCE."INVENTORY_STATUS"
    

    when not matched then insert
        ("INV_DETAIL_ID", "STORAGE_CONDITION", "INVENTORY_STATUS")
    values
        ("INV_DETAIL_ID", "STORAGE_CONDITION", "INVENTORY_STATUS")

;
[0m12:44:56.062840 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 1.218 seconds
[0m12:44:56.064289 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:56.065423 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
COMMIT
[0m12:44:56.293230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m12:44:56.312524 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
[0m12:44:56.322816 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m12:44:56.323326 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp cascade
[0m12:44:56.426070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m12:44:56.430665 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: Close
[0m12:44:56.526357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x735409536120>]}
[0m12:44:56.528087 [info ] [Thread-1 (]: 5 of 13 OK created sql incremental model PROJECT_TEST.dim_inv_detail_qu ........ [[32mSUCCESS 6[0m in 5.61s]
[0m12:44:56.529783 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_inv_detail_qu
[0m12:44:56.530988 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_product_qu
[0m12:44:56.532434 [info ] [Thread-1 (]: 6 of 13 START sql incremental model PROJECT_TEST.dim_product_qu ................ [RUN]
[0m12:44:56.533622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_inv_detail_qu, now model.brave_de_project.dim_product_qu)
[0m12:44:56.534476 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_product_qu
[0m12:44:56.543079 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_product_qu"
[0m12:44:56.543895 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_product_qu
[0m12:44:56.549143 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:44:56.549767 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu
),

product_data AS (
   SELECT
   
       product_id,
       product_name,
       product_category,
       product_color,
       supplier_id,
       manufacturing_date,
       expiration_date,
       warranty_period_months
   
   FROM source
)


SELECT * FROM product_data
  );
[0m12:44:56.550318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:59.698645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.148 seconds
[0m12:44:59.706310 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:44:59.707490 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
[0m12:44:59.793807 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.085 seconds
[0m12:44:59.802859 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:44:59.803962 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
[0m12:44:59.866025 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.061 seconds
[0m12:44:59.874770 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:44:59.875869 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_PRODUCT_QU"
[0m12:44:59.941957 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.065 seconds
[0m12:44:59.949347 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_product_qu"
[0m12:44:59.951984 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:44:59.952837 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:00.035643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m12:45:00.036781 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:45:00.037968 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_product_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_NAME" = DBT_INTERNAL_SOURCE."PRODUCT_NAME","PRODUCT_CATEGORY" = DBT_INTERNAL_SOURCE."PRODUCT_CATEGORY","PRODUCT_COLOR" = DBT_INTERNAL_SOURCE."PRODUCT_COLOR","SUPPLIER_ID" = DBT_INTERNAL_SOURCE."SUPPLIER_ID","MANUFACTURING_DATE" = DBT_INTERNAL_SOURCE."MANUFACTURING_DATE","EXPIRATION_DATE" = DBT_INTERNAL_SOURCE."EXPIRATION_DATE","WARRANTY_PERIOD_MONTHS" = DBT_INTERNAL_SOURCE."WARRANTY_PERIOD_MONTHS"
    

    when not matched then insert
        ("PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_CATEGORY", "PRODUCT_COLOR", "SUPPLIER_ID", "MANUFACTURING_DATE", "EXPIRATION_DATE", "WARRANTY_PERIOD_MONTHS")
    values
        ("PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_CATEGORY", "PRODUCT_COLOR", "SUPPLIER_ID", "MANUFACTURING_DATE", "EXPIRATION_DATE", "WARRANTY_PERIOD_MONTHS")

;
[0m12:45:01.407903 [debug] [Thread-1 (]: SQL status: SUCCESS 20000 in 1.369 seconds
[0m12:45:01.409342 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:45:01.410484 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
COMMIT
[0m12:45:01.626151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m12:45:01.634812 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
[0m12:45:01.636994 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m12:45:01.637895 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp cascade
[0m12:45:01.742507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m12:45:01.747073 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: Close
[0m12:45:01.840219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7354095fbc20>]}
[0m12:45:01.841961 [info ] [Thread-1 (]: 6 of 13 OK created sql incremental model PROJECT_TEST.dim_product_qu ........... [[32mSUCCESS 20000[0m in 5.31s]
[0m12:45:01.843678 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_product_qu
[0m12:45:01.844904 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_user_qu
[0m12:45:01.846434 [info ] [Thread-1 (]: 7 of 13 START sql incremental model PROJECT_TEST.dim_user_qu ................... [RUN]
[0m12:45:01.847689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_product_qu, now model.brave_de_project.dim_user_qu)
[0m12:45:01.848785 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_user_qu
[0m12:45:01.854989 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_user_qu"
[0m12:45:01.856060 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_user_qu
[0m12:45:01.864013 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:01.864597 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
),


user_data AS (
   SELECT
      
      user_id,
      first_name,
      last_name,
      email,
      signup_date,
      preferred_language,
      dob,
      marketing_opt_in,
      account_status,
      loyalty_points_balance
   FROM source
   WHERE account_status = 'active'
)

SELECT * FROM user_data
  );
[0m12:45:01.865112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:05.362961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.498 seconds
[0m12:45:05.370601 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:05.371810 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
[0m12:45:05.466321 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m12:45:05.475694 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:05.476493 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
[0m12:45:05.555289 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m12:45:05.564301 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:05.565442 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_USER_QU"
[0m12:45:05.655835 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.089 seconds
[0m12:45:05.663681 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_user_qu"
[0m12:45:05.725879 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:05.726996 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:05.842532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m12:45:05.843843 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:05.845077 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_user_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        "USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","EMAIL" = DBT_INTERNAL_SOURCE."EMAIL","SIGNUP_DATE" = DBT_INTERNAL_SOURCE."SIGNUP_DATE","PREFERRED_LANGUAGE" = DBT_INTERNAL_SOURCE."PREFERRED_LANGUAGE","DOB" = DBT_INTERNAL_SOURCE."DOB","MARKETING_OPT_IN" = DBT_INTERNAL_SOURCE."MARKETING_OPT_IN","ACCOUNT_STATUS" = DBT_INTERNAL_SOURCE."ACCOUNT_STATUS","LOYALTY_POINTS_BALANCE" = DBT_INTERNAL_SOURCE."LOYALTY_POINTS_BALANCE"
    

    when not matched then insert
        ("USER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "SIGNUP_DATE", "PREFERRED_LANGUAGE", "DOB", "MARKETING_OPT_IN", "ACCOUNT_STATUS", "LOYALTY_POINTS_BALANCE")
    values
        ("USER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "SIGNUP_DATE", "PREFERRED_LANGUAGE", "DOB", "MARKETING_OPT_IN", "ACCOUNT_STATUS", "LOYALTY_POINTS_BALANCE")

;
[0m12:45:06.883310 [debug] [Thread-1 (]: SQL status: SUCCESS 3089 in 1.037 seconds
[0m12:45:06.884750 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:06.885856 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
COMMIT
[0m12:45:07.195319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.308 seconds
[0m12:45:07.203731 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
[0m12:45:07.205720 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m12:45:07.206750 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp cascade
[0m12:45:07.360007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m12:45:07.364546 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: Close
[0m12:45:07.465404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540958dd00>]}
[0m12:45:07.467105 [info ] [Thread-1 (]: 7 of 13 OK created sql incremental model PROJECT_TEST.dim_user_qu .............. [[32mSUCCESS 3089[0m in 5.62s]
[0m12:45:07.468808 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_user_qu
[0m12:45:07.470031 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_campaign_qu
[0m12:45:07.471534 [info ] [Thread-1 (]: 8 of 13 START sql incremental model PROJECT_TEST.dim_campaign_qu ............... [RUN]
[0m12:45:07.472777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_user_qu, now model.brave_de_project.dim_campaign_qu)
[0m12:45:07.474126 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_campaign_qu
[0m12:45:07.484837 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_campaign_qu"
[0m12:45:07.485863 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_campaign_qu
[0m12:45:07.495153 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:07.495806 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

campaign_data AS (
   SELECT
      --ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS campaign_id,
      md5(cast(coalesce(cast(campaign_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(medium as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(content as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS campaign_id,
      campaign_name,
      medium,
      source,
      content
     
   FROM source
   GROUP BY campaign_name, medium, source, content
)

SELECT * FROM campaign_data
  );
[0m12:45:07.496351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:11.007964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.512 seconds
[0m12:45:11.010780 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.011154 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
[0m12:45:11.076696 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m12:45:11.085217 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.086217 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
[0m12:45:11.158454 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m12:45:11.167177 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.168283 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_CAMPAIGN_QU"
[0m12:45:11.230131 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.061 seconds
[0m12:45:11.236759 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.239756 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.240843 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:11.331424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m12:45:11.332562 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:11.333697 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.campaign_id = DBT_INTERNAL_DEST.campaign_id
            )

    
    when matched then update set
        "CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","CAMPAIGN_NAME" = DBT_INTERNAL_SOURCE."CAMPAIGN_NAME","MEDIUM" = DBT_INTERNAL_SOURCE."MEDIUM","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","CONTENT" = DBT_INTERNAL_SOURCE."CONTENT"
    

    when not matched then insert
        ("CAMPAIGN_ID", "CAMPAIGN_NAME", "MEDIUM", "SOURCE", "CONTENT")
    values
        ("CAMPAIGN_ID", "CAMPAIGN_NAME", "MEDIUM", "SOURCE", "CONTENT")

;
[0m12:45:12.394453 [debug] [Thread-1 (]: SQL status: SUCCESS 256 in 1.060 seconds
[0m12:45:12.395767 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:12.396855 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
COMMIT
[0m12:45:12.612578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m12:45:12.620872 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
[0m12:45:12.623012 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m12:45:12.624124 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp cascade
[0m12:45:12.713884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m12:45:12.718331 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: Close
[0m12:45:12.816761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540aa13800>]}
[0m12:45:12.818483 [info ] [Thread-1 (]: 8 of 13 OK created sql incremental model PROJECT_TEST.dim_campaign_qu .......... [[32mSUCCESS 256[0m in 5.34s]
[0m12:45:12.820176 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_campaign_qu
[0m12:45:12.821429 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_location_qu
[0m12:45:12.822978 [info ] [Thread-1 (]: 9 of 13 START sql incremental model PROJECT_TEST.dim_search_location_qu ........ [RUN]
[0m12:45:12.824432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_campaign_qu, now model.brave_de_project.dim_search_location_qu)
[0m12:45:12.825625 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_location_qu
[0m12:45:12.833419 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_location_qu"
[0m12:45:12.834431 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_location_qu
[0m12:45:12.841830 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:12.842441 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

search_location_data AS (
   SELECT
       
      md5(cast(coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(city as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(region as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id, 
      country,
      city,
      region,
      zipcode

   FROM source
   GROUP BY city, country, region, zipcode
)

select * from search_location_data
  );
[0m12:45:12.842986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:16.017750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.174 seconds
[0m12:45:16.025531 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.026713 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
[0m12:45:16.108298 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.080 seconds
[0m12:45:16.117463 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.118594 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
[0m12:45:16.186301 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m12:45:16.195061 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.195863 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_SEARCH_LOCATION_QU"
[0m12:45:16.261942 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m12:45:16.268658 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.271852 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.272981 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:16.341696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m12:45:16.342830 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:16.343978 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.location_id = DBT_INTERNAL_DEST.location_id
            )

    
    when matched then update set
        "LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","CITY" = DBT_INTERNAL_SOURCE."CITY","REGION" = DBT_INTERNAL_SOURCE."REGION","ZIPCODE" = DBT_INTERNAL_SOURCE."ZIPCODE"
    

    when not matched then insert
        ("LOCATION_ID", "COUNTRY", "CITY", "REGION", "ZIPCODE")
    values
        ("LOCATION_ID", "COUNTRY", "CITY", "REGION", "ZIPCODE")

;
[0m12:45:17.945198 [debug] [Thread-1 (]: SQL status: SUCCESS 141519 in 1.600 seconds
[0m12:45:17.946809 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:17.947925 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
COMMIT
[0m12:45:18.252268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m12:45:18.260359 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
[0m12:45:18.262246 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m12:45:18.263030 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp cascade
[0m12:45:18.373858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m12:45:18.378400 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: Close
[0m12:45:18.480425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540ab8ab70>]}
[0m12:45:18.482114 [info ] [Thread-1 (]: 9 of 13 OK created sql incremental model PROJECT_TEST.dim_search_location_qu ... [[32mSUCCESS 141519[0m in 5.66s]
[0m12:45:18.483820 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_location_qu
[0m12:45:18.485033 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_qu
[0m12:45:18.486527 [info ] [Thread-1 (]: 10 of 13 START sql incremental model PROJECT_TEST.dim_search_qu ................ [RUN]
[0m12:45:18.487742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_location_qu, now model.brave_de_project.dim_search_qu)
[0m12:45:18.488836 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_qu
[0m12:45:18.497704 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_qu"
[0m12:45:18.498729 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_qu
[0m12:45:18.506881 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:18.507475 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

search_data AS (
   SELECT
      
     md5(cast(coalesce(cast(search_model as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_feature as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_terms_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as search_data_id,
      search_model,  
      search_type,
      search_feature,
      search_terms_type
        
   FROM source
   GROUP BY search_model, 
            search_type, 
            search_feature, 
            search_terms_type
)


SELECT * FROM search_data
  );
[0m12:45:18.508033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:22.464906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.957 seconds
[0m12:45:22.472499 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:22.473636 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
[0m12:45:22.547430 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.073 seconds
[0m12:45:22.556105 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:22.557201 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
[0m12:45:22.642575 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.084 seconds
[0m12:45:22.651220 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:22.652351 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_SEARCH_QU"
[0m12:45:22.721417 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.068 seconds
[0m12:45:22.727970 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_search_qu"
[0m12:45:22.730568 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:22.731426 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:22.800453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m12:45:22.801583 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:22.802725 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_search_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.search_data_id = DBT_INTERNAL_DEST.search_data_id
            )

    
    when matched then update set
        "SEARCH_DATA_ID" = DBT_INTERNAL_SOURCE."SEARCH_DATA_ID","SEARCH_MODEL" = DBT_INTERNAL_SOURCE."SEARCH_MODEL","SEARCH_TYPE" = DBT_INTERNAL_SOURCE."SEARCH_TYPE","SEARCH_FEATURE" = DBT_INTERNAL_SOURCE."SEARCH_FEATURE","SEARCH_TERMS_TYPE" = DBT_INTERNAL_SOURCE."SEARCH_TERMS_TYPE"
    

    when not matched then insert
        ("SEARCH_DATA_ID", "SEARCH_MODEL", "SEARCH_TYPE", "SEARCH_FEATURE", "SEARCH_TERMS_TYPE")
    values
        ("SEARCH_DATA_ID", "SEARCH_MODEL", "SEARCH_TYPE", "SEARCH_FEATURE", "SEARCH_TERMS_TYPE")

;
[0m12:45:23.512510 [debug] [Thread-1 (]: SQL status: SUCCESS 72 in 0.709 seconds
[0m12:45:23.513738 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:23.514803 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
COMMIT
[0m12:45:23.722234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m12:45:23.730147 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
[0m12:45:23.732139 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m12:45:23.733158 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp cascade
[0m12:45:23.812314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m12:45:23.816768 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: Close
[0m12:45:23.909630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a9f0d40>]}
[0m12:45:23.911330 [info ] [Thread-1 (]: 10 of 13 OK created sql incremental model PROJECT_TEST.dim_search_qu ........... [[32mSUCCESS 72[0m in 5.42s]
[0m12:45:23.913057 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_qu
[0m12:45:23.914303 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_inventory_management_qu
[0m12:45:23.915873 [info ] [Thread-1 (]: 11 of 13 START sql incremental model PROJECT_TEST.fact_inventory_management_qu . [RUN]
[0m12:45:23.917423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_qu, now model.brave_de_project.fact_inventory_management_qu)
[0m12:45:23.918554 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_inventory_management_qu
[0m12:45:23.925779 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:23.926816 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_inventory_management_qu
[0m12:45:23.933289 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:23.933913 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
  
  copy grants as (
    

WITH inventory_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu

),

product_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu 

),

inv_detail AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
),

inventory_management AS (
    SELECT
    
    id.inventory_id,
    id.product_id,
    id.warehouse_id,
    id.supplier_id,
    idt.inv_detail_id,

    pd.price,
    id.stock_level,
    id.reorder_level,
    id.quantity_in_stock,
    id.sales_volume,
    id.safety_stock,
    id.average_monthly_demand,
    id.rating,
    id.prod_weight,
    id.discounts,
    last_audit_date,
    last_restock_date,
    restock_date,
    next_restock_date
                
    FROM inventory_data id
    INNER JOIN inv_detail idt 
        ON id.inventory_status = idt.storage_condition
        AND idt.inventory_status = id.inventory_status
    LEFT JOIN product_data pd ON id.product_id = pd.product_id
)

SELECT * FROM inventory_management
WHERE price >= discounts
  );
[0m12:45:23.934489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:27.168886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.234 seconds
[0m12:45:27.176625 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.177610 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
[0m12:45:27.253999 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.075 seconds
[0m12:45:27.264475 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.265609 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
[0m12:45:27.338250 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.072 seconds
[0m12:45:27.348235 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.349029 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_INVENTORY_MANAGEMENT_QU"
[0m12:45:27.419709 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.070 seconds
[0m12:45:27.429561 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.433022 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.434029 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:27.513215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m12:45:27.514364 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:27.515713 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.inventory_id = DBT_INTERNAL_DEST.inventory_id
                ) and (
                    DBT_INTERNAL_SOURCE.warehouse_id = DBT_INTERNAL_DEST.warehouse_id
                ) and (
                    DBT_INTERNAL_SOURCE.supplier_id = DBT_INTERNAL_DEST.supplier_id
                )

    
    when matched then update set
        "INVENTORY_ID" = DBT_INTERNAL_SOURCE."INVENTORY_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","WAREHOUSE_ID" = DBT_INTERNAL_SOURCE."WAREHOUSE_ID","SUPPLIER_ID" = DBT_INTERNAL_SOURCE."SUPPLIER_ID","INV_DETAIL_ID" = DBT_INTERNAL_SOURCE."INV_DETAIL_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","STOCK_LEVEL" = DBT_INTERNAL_SOURCE."STOCK_LEVEL","REORDER_LEVEL" = DBT_INTERNAL_SOURCE."REORDER_LEVEL","QUANTITY_IN_STOCK" = DBT_INTERNAL_SOURCE."QUANTITY_IN_STOCK","SALES_VOLUME" = DBT_INTERNAL_SOURCE."SALES_VOLUME","SAFETY_STOCK" = DBT_INTERNAL_SOURCE."SAFETY_STOCK","AVERAGE_MONTHLY_DEMAND" = DBT_INTERNAL_SOURCE."AVERAGE_MONTHLY_DEMAND","RATING" = DBT_INTERNAL_SOURCE."RATING","PROD_WEIGHT" = DBT_INTERNAL_SOURCE."PROD_WEIGHT","DISCOUNTS" = DBT_INTERNAL_SOURCE."DISCOUNTS","LAST_AUDIT_DATE" = DBT_INTERNAL_SOURCE."LAST_AUDIT_DATE","LAST_RESTOCK_DATE" = DBT_INTERNAL_SOURCE."LAST_RESTOCK_DATE","RESTOCK_DATE" = DBT_INTERNAL_SOURCE."RESTOCK_DATE","NEXT_RESTOCK_DATE" = DBT_INTERNAL_SOURCE."NEXT_RESTOCK_DATE"
    

    when not matched then insert
        ("INVENTORY_ID", "PRODUCT_ID", "WAREHOUSE_ID", "SUPPLIER_ID", "INV_DETAIL_ID", "PRICE", "STOCK_LEVEL", "REORDER_LEVEL", "QUANTITY_IN_STOCK", "SALES_VOLUME", "SAFETY_STOCK", "AVERAGE_MONTHLY_DEMAND", "RATING", "PROD_WEIGHT", "DISCOUNTS", "LAST_AUDIT_DATE", "LAST_RESTOCK_DATE", "RESTOCK_DATE", "NEXT_RESTOCK_DATE")
    values
        ("INVENTORY_ID", "PRODUCT_ID", "WAREHOUSE_ID", "SUPPLIER_ID", "INV_DETAIL_ID", "PRICE", "STOCK_LEVEL", "REORDER_LEVEL", "QUANTITY_IN_STOCK", "SALES_VOLUME", "SAFETY_STOCK", "AVERAGE_MONTHLY_DEMAND", "RATING", "PROD_WEIGHT", "DISCOUNTS", "LAST_AUDIT_DATE", "LAST_RESTOCK_DATE", "RESTOCK_DATE", "NEXT_RESTOCK_DATE")

;
[0m12:45:28.320355 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.803 seconds
[0m12:45:28.321548 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:28.322518 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
COMMIT
[0m12:45:28.447563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m12:45:28.451049 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
[0m12:45:28.451960 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m12:45:28.452385 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp cascade
[0m12:45:28.576915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m12:45:28.581418 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: Close
[0m12:45:28.717545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540ac3dc10>]}
[0m12:45:28.719226 [info ] [Thread-1 (]: 11 of 13 OK created sql incremental model PROJECT_TEST.fact_inventory_management_qu  [[32mSUCCESS 0[0m in 4.80s]
[0m12:45:28.720910 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_inventory_management_qu
[0m12:45:28.722132 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:45:28.723655 [info ] [Thread-1 (]: 12 of 13 START sql incremental model PROJECT_TEST.fact_campaign_effectiveness_qu  [RUN]
[0m12:45:28.724894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_inventory_management_qu, now model.brave_de_project.fact_campaign_effectiveness_qu)
[0m12:45:28.726000 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:45:28.734716 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:28.735738 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:45:28.743207 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:28.743880 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
  
  copy grants as (
    

WITH user_journey AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu
),

valid_users as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
   WHERE account_status = 'active'

),

product_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu 
),

campaign_dim AS (
   SELECT * FROM BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
),

filteirng AS (
   SELECT
      
      p.price,
      uj.has_purchase,
      uj.has_atc,
      uj.has_pdp,
      uj.has_qv,
      uj.product_id,
      uj.user_id,
      cd.campaign_id -- Foreign key from dim_campaign
    
   FROM user_journey uj
   INNER JOIN campaign_dim cd
     ON uj.campaign_name = cd.campaign_name
    AND uj.medium = cd.medium
    AND uj.source = cd.source
    AND uj.content = cd.content

   INNER JOIN valid_users vu 
     ON uj.user_id = vu.user_id
   
   LEFT JOIN product_data p
     ON uj.product_id = p.product_id
   
   GROUP BY 
      cd.campaign_id,
      uj.product_id, 
      uj.user_id,
      p.price,
      uj.has_purchase,
      uj.has_atc,
      uj.has_pdp,
      uj.has_qv

),

final AS (
    SELECT
       
      campaign_id,
      product_id,
      price AS product_price,
      SUM(CASE WHEN has_purchase = TRUE THEN 1 ELSE 0 END) AS total_unit_sold,
      SUM(CASE WHEN has_atc = TRUE THEN 1 ELSE 0 END) AS total_atc,
      SUM(CASE WHEN has_qv = TRUE THEN 1 ELSE 0 END) AS total_qv,
      SUM(CASE WHEN has_pdp = TRUE THEN 1 ELSE 0 END) AS total_pdp,
      user_id

    FROM filteirng
    GROUP BY 
      campaign_id,
      product_id,
      user_id,
      price
      
)



SELECT * FROM final
  );
[0m12:45:28.744493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:32.937756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.193 seconds
[0m12:45:32.945539 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:32.946484 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
[0m12:45:33.431163 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.484 seconds
[0m12:45:33.440072 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:33.440874 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
[0m12:45:33.521691 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.080 seconds
[0m12:45:33.530358 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:33.531146 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_CAMPAIGN_EFFECTIVENESS_QU"
[0m12:45:33.773777 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.242 seconds
[0m12:45:33.781156 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:33.784268 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:33.785082 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:33.858492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m12:45:33.859648 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:33.860856 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                ) and (
                    DBT_INTERNAL_SOURCE.campaign_id = DBT_INTERNAL_DEST.campaign_id
                ) and (
                    DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
                )

    
    when matched then update set
        "CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_PRICE" = DBT_INTERNAL_SOURCE."PRODUCT_PRICE","TOTAL_UNIT_SOLD" = DBT_INTERNAL_SOURCE."TOTAL_UNIT_SOLD","TOTAL_ATC" = DBT_INTERNAL_SOURCE."TOTAL_ATC","TOTAL_QV" = DBT_INTERNAL_SOURCE."TOTAL_QV","TOTAL_PDP" = DBT_INTERNAL_SOURCE."TOTAL_PDP","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID"
    

    when not matched then insert
        ("CAMPAIGN_ID", "PRODUCT_ID", "PRODUCT_PRICE", "TOTAL_UNIT_SOLD", "TOTAL_ATC", "TOTAL_QV", "TOTAL_PDP", "USER_ID")
    values
        ("CAMPAIGN_ID", "PRODUCT_ID", "PRODUCT_PRICE", "TOTAL_UNIT_SOLD", "TOTAL_ATC", "TOTAL_QV", "TOTAL_PDP", "USER_ID")

;
[0m12:45:39.053673 [debug] [Thread-1 (]: SQL status: SUCCESS 308663 in 5.191 seconds
[0m12:45:39.055095 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:39.056219 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
COMMIT
[0m12:45:39.255672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m12:45:39.264229 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
[0m12:45:39.266452 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:45:39.267271 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp cascade
[0m12:45:39.514901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m12:45:39.519454 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: Close
[0m12:45:39.677608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a8ea0c0>]}
[0m12:45:39.679299 [info ] [Thread-1 (]: 12 of 13 OK created sql incremental model PROJECT_TEST.fact_campaign_effectiveness_qu  [[32mSUCCESS 308663[0m in 10.95s]
[0m12:45:39.681002 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:45:39.682247 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_search_product_performance_qu
[0m12:45:39.683773 [info ] [Thread-1 (]: 13 of 13 START sql incremental model PROJECT_TEST.fact_search_product_performance_qu  [RUN]
[0m12:45:39.685041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_campaign_effectiveness_qu, now model.brave_de_project.fact_search_product_performance_qu)
[0m12:45:39.686171 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_search_product_performance_qu
[0m12:45:39.695137 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:39.696178 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_search_product_performance_qu
[0m12:45:39.704623 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:39.705962 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
  
  copy grants as (
    


with user_journey as (
   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu 
),

valid_users as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
   WHERE account_status = 'active'

),

products as (
   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu   
),

search_data as (
   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
),

search_loc as (
   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
),

final AS (
   SELECT
  
      uj.search_event_id,
      uj.user_id,
      uj.product_id,
      sd.search_data_id,
      sl.location_id,

      uj.search_terms,
      uj.search_results_count,
      uj.search_timestamp, 
      
      vp.price,
      vp.rating,
      vp.sales_volume,
      vp.discount_percentage,
      vp.weight_grams,
      
      uj.has_qv,
      uj.has_pdp,
      uj.has_atc,
      uj.has_purchase

   FROM user_journey uj
   INNER JOIN search_data sd 
      ON uj.search_model = sd.search_model
      AND uj.search_type = sd.search_type
      AND uj.search_feature = sd.search_feature
      AND uj.search_terms_type = sd.search_terms_type
   INNER JOIN search_loc sl
      ON uj.country = sl.country
      AND uj.city = sl.city
      AND uj.region = sl.region
      AND uj.zipcode = sl.zipcode   

   INNER JOIN valid_users vu ON uj.user_id = vu.user_id
   LEFT JOIN products vp ON uj.product_id = vp.product_id
   
)


SELECT * FROM final
  );
[0m12:45:39.707209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:43.409740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.702 seconds
[0m12:45:43.421535 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.436419 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
[0m12:45:43.601468 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.164 seconds
[0m12:45:43.611412 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.612549 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
[0m12:45:43.675955 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.062 seconds
[0m12:45:43.685140 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.686072 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_SEARCH_PRODUCT_PERFORMANCE_QU"
[0m12:45:43.798480 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.111 seconds
[0m12:45:43.807648 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.811933 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.812992 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m12:45:43.891801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m12:45:43.892964 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:43.894278 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
                ) and (
                    DBT_INTERNAL_SOURCE.search_event_id = DBT_INTERNAL_DEST.search_event_id
                )

    
    when matched then update set
        "SEARCH_EVENT_ID" = DBT_INTERNAL_SOURCE."SEARCH_EVENT_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","SEARCH_DATA_ID" = DBT_INTERNAL_SOURCE."SEARCH_DATA_ID","LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","SEARCH_TERMS" = DBT_INTERNAL_SOURCE."SEARCH_TERMS","SEARCH_RESULTS_COUNT" = DBT_INTERNAL_SOURCE."SEARCH_RESULTS_COUNT","SEARCH_TIMESTAMP" = DBT_INTERNAL_SOURCE."SEARCH_TIMESTAMP","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RATING" = DBT_INTERNAL_SOURCE."RATING","SALES_VOLUME" = DBT_INTERNAL_SOURCE."SALES_VOLUME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE","WEIGHT_GRAMS" = DBT_INTERNAL_SOURCE."WEIGHT_GRAMS","HAS_QV" = DBT_INTERNAL_SOURCE."HAS_QV","HAS_PDP" = DBT_INTERNAL_SOURCE."HAS_PDP","HAS_ATC" = DBT_INTERNAL_SOURCE."HAS_ATC","HAS_PURCHASE" = DBT_INTERNAL_SOURCE."HAS_PURCHASE"
    

    when not matched then insert
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")
    values
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")

;
[0m12:45:48.054596 [debug] [Thread-1 (]: SQL status: SUCCESS 308683 in 4.159 seconds
[0m12:45:48.056031 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:48.057165 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
COMMIT
[0m12:45:48.446170 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m12:45:48.454521 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
[0m12:45:48.463061 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m12:45:48.464224 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp cascade
[0m12:45:48.668252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m12:45:48.672829 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: Close
[0m12:45:48.792806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d75e00d-f548-40ec-a285-be8e3485960d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540a91b560>]}
[0m12:45:48.794549 [info ] [Thread-1 (]: 13 of 13 OK created sql incremental model PROJECT_TEST.fact_search_product_performance_qu  [[32mSUCCESS 308683[0m in 9.11s]
[0m12:45:48.796243 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_search_product_performance_qu
[0m12:45:48.799361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:48.800723 [debug] [MainThread]: Connection 'model.brave_de_project.fact_search_product_performance_qu' was properly closed.
[0m12:45:48.802090 [info ] [MainThread]: 
[0m12:45:48.803146 [info ] [MainThread]: Finished running 4 view models, 9 incremental models in 0 hours 1 minutes and 23.10 seconds (83.10s).
[0m12:45:48.808258 [debug] [MainThread]: Command end result
[0m12:45:48.876226 [info ] [MainThread]: 
[0m12:45:48.876711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:48.877020 [info ] [MainThread]: 
[0m12:45:48.877322 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m12:45:48.878181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 85.490906, "process_user_time": 6.110017, "process_kernel_time": 0.207136, "process_mem_max_rss": "129580", "process_in_blocks": "88", "process_out_blocks": "7248"}
[0m12:45:48.878744 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:48.878641 after 85.49 seconds
[0m12:45:48.879122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c3225d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c8ee4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73540c8efd70>]}
[0m12:45:48.879512 [debug] [MainThread]: Flushing usage events
[0m12:46:14.130824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab5292480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab4b59cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab4b59ac0>]}


============================== 12:46:14.132762 | e769959f-c019-4327-b7cd-507e51b018a3 ==============================
[0m12:46:14.132762 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:46:14.133256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:46:14.381633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab39cac60>]}
[0m12:46:14.421639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab3acdd00>]}
[0m12:46:14.422162 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:46:14.446866 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:46:14.551098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:14.551453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:14.555344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.brave_de_project
[0m12:46:14.586070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab39ca150>]}
[0m12:46:14.602351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab33294c0>]}
[0m12:46:14.602756 [info ] [MainThread]: Found 13 models, 52 data tests, 4 sources, 851 macros, 7 unit tests
[0m12:46:14.603073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab54e1fa0>]}
[0m12:46:14.605603 [info ] [MainThread]: 
[0m12:46:14.606066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:14.609909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BRAVE_DATABASE_PROJECT_TEST'
[0m12:46:14.647104 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE_PROJECT_TEST"
[0m12:46:14.647802 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE_PROJECT_TEST"} */
show objects in BRAVE_DATABASE.PROJECT_TEST limit 10000
[0m12:46:14.648201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:18.264878 [debug] [ThreadPool]: SQL status: SUCCESS 99 in 3.616 seconds
[0m12:46:18.276671 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: Close
[0m12:46:18.391113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e769959f-c019-4327-b7cd-507e51b018a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab36d9f10>]}
[0m12:46:18.391877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:18.392442 [info ] [MainThread]: 
[0m12:46:18.396166 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_inventory_data_qu
[0m12:46:18.397414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE_PROJECT_TEST, now model.brave_de_project.stg_inventory_data_qu)
[0m12:46:18.398676 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_inventory_data_qu
[0m12:46:18.422089 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_inventory_data_qu"
[0m12:46:18.422995 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_inventory_data_qu
[0m12:46:18.424034 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_inventory_data_qu
[0m12:46:18.424649 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_product_data_qu
[0m12:46:18.425452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_inventory_data_qu, now model.brave_de_project.stg_product_data_qu)
[0m12:46:18.426113 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_product_data_qu
[0m12:46:18.430411 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_product_data_qu"
[0m12:46:18.430959 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_product_data_qu
[0m12:46:18.431627 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_product_data_qu
[0m12:46:18.432038 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_data_qu
[0m12:46:18.432597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_product_data_qu, now model.brave_de_project.stg_user_data_qu)
[0m12:46:18.433116 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_data_qu
[0m12:46:18.437076 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_data_qu"
[0m12:46:18.437591 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_data_qu
[0m12:46:18.438213 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_data_qu
[0m12:46:18.438612 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_journey_qu
[0m12:46:18.439105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_data_qu, now model.brave_de_project.stg_user_journey_qu)
[0m12:46:18.439591 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_journey_qu
[0m12:46:18.442448 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_journey_qu"
[0m12:46:18.442925 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_journey_qu
[0m12:46:18.443527 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_journey_qu
[0m12:46:18.443888 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_inv_detail_qu
[0m12:46:18.444360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_journey_qu, now model.brave_de_project.dim_inv_detail_qu)
[0m12:46:18.444842 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_inv_detail_qu
[0m12:46:18.456104 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_inv_detail_qu"
[0m12:46:18.456648 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_inv_detail_qu
[0m12:46:18.457251 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_inv_detail_qu
[0m12:46:18.457627 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_product_qu
[0m12:46:18.458127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_inv_detail_qu, now model.brave_de_project.dim_product_qu)
[0m12:46:18.458975 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_product_qu
[0m12:46:18.466504 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_product_qu"
[0m12:46:18.467838 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_product_qu
[0m12:46:18.469782 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_product_qu
[0m12:46:18.471006 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_user_qu
[0m12:46:18.472187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_product_qu, now model.brave_de_project.dim_user_qu)
[0m12:46:18.473519 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_user_qu
[0m12:46:18.480854 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_user_qu"
[0m12:46:18.481815 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_user_qu
[0m12:46:18.483045 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_user_qu
[0m12:46:18.483845 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_campaign_qu
[0m12:46:18.484587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_user_qu, now model.brave_de_project.dim_campaign_qu)
[0m12:46:18.485286 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_campaign_qu
[0m12:46:18.493594 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_campaign_qu"
[0m12:46:18.494447 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_campaign_qu
[0m12:46:18.495300 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_campaign_qu
[0m12:46:18.495848 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_location_qu
[0m12:46:18.496700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_campaign_qu, now model.brave_de_project.dim_search_location_qu)
[0m12:46:18.497217 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_location_qu
[0m12:46:18.559575 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_location_qu"
[0m12:46:18.560116 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_location_qu
[0m12:46:18.560690 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_location_qu
[0m12:46:18.561045 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_qu
[0m12:46:18.561387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_location_qu, now model.brave_de_project.dim_search_qu)
[0m12:46:18.561994 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_qu
[0m12:46:18.564876 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_qu"
[0m12:46:18.565320 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_qu
[0m12:46:18.565870 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_qu
[0m12:46:18.566205 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_inventory_management_qu
[0m12:46:18.566665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_qu, now model.brave_de_project.fact_inventory_management_qu)
[0m12:46:18.567104 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_inventory_management_qu
[0m12:46:18.569711 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_inventory_management_qu"
[0m12:46:18.570121 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_inventory_management_qu
[0m12:46:18.570626 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_inventory_management_qu
[0m12:46:18.570975 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m12:46:18.571303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_inventory_management_qu, now test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8)
[0m12:46:18.571757 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m12:46:18.580264 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"
[0m12:46:18.580721 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m12:46:18.581226 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m12:46:18.581575 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m12:46:18.581984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8, now test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620)
[0m12:46:18.582297 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m12:46:18.587842 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"
[0m12:46:18.588205 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m12:46:18.588718 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m12:46:18.589025 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m12:46:18.589406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620, now test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e)
[0m12:46:18.589696 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m12:46:18.592271 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"
[0m12:46:18.592645 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m12:46:18.593139 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m12:46:18.593476 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m12:46:18.593873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e, now test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc)
[0m12:46:18.594197 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m12:46:18.597672 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"
[0m12:46:18.598046 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m12:46:18.598584 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m12:46:18.598918 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m12:46:18.599308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc, now test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8)
[0m12:46:18.599638 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m12:46:18.603623 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"
[0m12:46:18.603995 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m12:46:18.604482 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m12:46:18.604792 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m12:46:18.605160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8, now test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53)
[0m12:46:18.605471 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m12:46:18.608167 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"
[0m12:46:18.608543 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m12:46:18.609020 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m12:46:18.609323 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m12:46:18.609701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53, now test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8)
[0m12:46:18.609985 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m12:46:18.612428 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"
[0m12:46:18.612794 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m12:46:18.613266 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m12:46:18.613581 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m12:46:18.613945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8, now test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514)
[0m12:46:18.614239 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m12:46:18.616713 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"
[0m12:46:18.617060 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m12:46:18.617554 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m12:46:18.617887 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_product_dates
[0m12:46:18.618274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514, now test.brave_de_project.test_product_dates)
[0m12:46:18.618588 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_product_dates
[0m12:46:18.620425 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_product_dates"
[0m12:46:18.620809 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_product_dates
[0m12:46:18.621293 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_product_dates
[0m12:46:18.621606 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m12:46:18.621966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_product_dates, now test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e)
[0m12:46:18.622240 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m12:46:18.624726 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"
[0m12:46:18.625106 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m12:46:18.625631 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m12:46:18.625963 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m12:46:18.626345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e, now test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d)
[0m12:46:18.626666 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m12:46:18.631529 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"
[0m12:46:18.631900 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m12:46:18.632374 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m12:46:18.632715 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m12:46:18.633096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d, now test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459)
[0m12:46:18.633409 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m12:46:18.636074 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"
[0m12:46:18.636436 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m12:46:18.636912 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m12:46:18.637213 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m12:46:18.637584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459, now test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9)
[0m12:46:18.637864 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m12:46:18.640449 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"
[0m12:46:18.640810 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m12:46:18.641279 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m12:46:18.641614 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_user_data
[0m12:46:18.642003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9, now test.brave_de_project.test_user_data)
[0m12:46:18.642304 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_user_data
[0m12:46:18.644196 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_user_data"
[0m12:46:18.644548 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_user_data
[0m12:46:18.645010 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_user_data
[0m12:46:18.645331 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m12:46:18.645723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_user_data, now test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc)
[0m12:46:18.646029 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m12:46:18.648574 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"
[0m12:46:18.648954 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m12:46:18.649432 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m12:46:18.649763 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:46:18.650152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc, now model.brave_de_project.fact_campaign_effectiveness_qu)
[0m12:46:18.650468 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:46:18.653120 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m12:46:18.653547 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:46:18.654066 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m12:46:18.654400 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m12:46:18.654842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_campaign_effectiveness_qu, now test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2)
[0m12:46:18.655255 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m12:46:18.657868 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"
[0m12:46:18.658224 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m12:46:18.658710 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m12:46:18.659035 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m12:46:18.659433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2, now test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672)
[0m12:46:18.659742 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m12:46:18.662181 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"
[0m12:46:18.662551 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m12:46:18.663022 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m12:46:18.663322 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m12:46:18.663686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672, now test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892)
[0m12:46:18.664038 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m12:46:18.667545 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"
[0m12:46:18.667922 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m12:46:18.668439 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m12:46:18.668774 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m12:46:18.669137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892, now test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b)
[0m12:46:18.669440 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m12:46:18.672166 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"
[0m12:46:18.672549 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m12:46:18.673020 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m12:46:18.673320 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m12:46:18.673698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b, now test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5)
[0m12:46:18.673973 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m12:46:18.676476 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"
[0m12:46:18.676819 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m12:46:18.677300 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m12:46:18.677616 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_campagin_combinations
[0m12:46:18.677979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5, now test.brave_de_project.test_campagin_combinations)
[0m12:46:18.678254 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_campagin_combinations
[0m12:46:18.680017 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_campagin_combinations"
[0m12:46:18.680358 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_campagin_combinations
[0m12:46:18.680853 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_campagin_combinations
[0m12:46:18.681186 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m12:46:18.681586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_campagin_combinations, now test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2)
[0m12:46:18.681887 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m12:46:18.684409 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"
[0m12:46:18.684774 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m12:46:18.685245 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m12:46:18.685564 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m12:46:18.685928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2, now test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42)
[0m12:46:18.686205 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m12:46:18.688599 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"
[0m12:46:18.688952 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m12:46:18.689447 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m12:46:18.689775 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m12:46:18.690159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42, now test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af)
[0m12:46:18.690467 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m12:46:18.692939 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"
[0m12:46:18.693286 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m12:46:18.693783 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m12:46:18.694087 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m12:46:18.694461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af, now test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee)
[0m12:46:18.694745 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m12:46:18.698267 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"
[0m12:46:18.698631 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m12:46:18.699121 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m12:46:18.699450 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m12:46:18.699839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee, now test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6)
[0m12:46:18.700143 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m12:46:18.702634 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"
[0m12:46:18.702995 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m12:46:18.703517 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m12:46:18.703847 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m12:46:18.704233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6, now test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6)
[0m12:46:18.704548 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m12:46:18.707200 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"
[0m12:46:18.707553 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m12:46:18.708038 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m12:46:18.708350 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m12:46:18.708729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6, now test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be)
[0m12:46:18.709009 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m12:46:18.711408 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"
[0m12:46:18.711752 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m12:46:18.712236 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m12:46:18.712555 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_search_product_performance_qu
[0m12:46:18.712921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be, now model.brave_de_project.fact_search_product_performance_qu)
[0m12:46:18.713301 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_search_product_performance_qu
[0m12:46:18.715876 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_search_product_performance_qu"
[0m12:46:18.716250 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_search_product_performance_qu
[0m12:46:18.716752 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_search_product_performance_qu
[0m12:46:18.717058 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m12:46:18.717483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_search_product_performance_qu, now test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1)
[0m12:46:18.717903 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m12:46:18.721366 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"
[0m12:46:18.721748 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m12:46:18.722216 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m12:46:18.722531 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m12:46:18.722896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1, now test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22)
[0m12:46:18.723182 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m12:46:18.725778 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"
[0m12:46:18.726144 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m12:46:18.726624 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m12:46:18.726953 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m12:46:18.727273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22, now test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df)
[0m12:46:18.727671 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m12:46:18.731071 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"
[0m12:46:18.731444 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m12:46:18.731916 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m12:46:18.732243 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m12:46:18.732569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df, now test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df)
[0m12:46:18.732930 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m12:46:18.735436 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"
[0m12:46:18.735825 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m12:46:18.736331 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m12:46:18.736676 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m12:46:18.737066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df, now test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1)
[0m12:46:18.737371 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m12:46:18.739907 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"
[0m12:46:18.740294 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m12:46:18.740817 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m12:46:18.741148 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m12:46:18.741842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1, now test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941)
[0m12:46:18.742950 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m12:46:18.751648 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"
[0m12:46:18.752850 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m12:46:18.754003 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m12:46:18.754765 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m12:46:18.755510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941, now test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c)
[0m12:46:18.756202 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m12:46:18.762264 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"
[0m12:46:18.763101 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m12:46:18.763890 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m12:46:18.764400 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m12:46:18.764932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c, now test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815)
[0m12:46:18.765404 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m12:46:18.769406 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"
[0m12:46:18.769969 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m12:46:18.770752 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m12:46:18.771255 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m12:46:18.771915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815, now test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc)
[0m12:46:18.772402 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m12:46:18.775271 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"
[0m12:46:18.776392 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m12:46:18.778124 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m12:46:18.779247 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m12:46:18.780308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc, now test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2)
[0m12:46:18.781411 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m12:46:18.792761 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"
[0m12:46:18.793922 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m12:46:18.795003 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m12:46:18.795692 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m12:46:18.796429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2, now test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617)
[0m12:46:18.797055 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m12:46:18.802517 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"
[0m12:46:18.803285 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m12:46:18.804279 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m12:46:18.804770 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fim_price_discount
[0m12:46:18.805298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617, now test.brave_de_project.test_fim_price_discount)
[0m12:46:18.805747 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fim_price_discount
[0m12:46:18.808471 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fim_price_discount"
[0m12:46:18.808999 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fim_price_discount
[0m12:46:18.809751 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fim_price_discount
[0m12:46:18.810224 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m12:46:18.810768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fim_price_discount, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03)
[0m12:46:18.811203 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m12:46:18.814835 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"
[0m12:46:18.815224 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m12:46:18.815752 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m12:46:18.816087 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m12:46:18.816484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7)
[0m12:46:18.816789 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m12:46:18.819394 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"
[0m12:46:18.819772 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m12:46:18.820274 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m12:46:18.820610 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m12:46:18.820964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e)
[0m12:46:18.821263 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m12:46:18.823914 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"
[0m12:46:18.824269 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m12:46:18.824771 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m12:46:18.825080 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m12:46:18.825458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52)
[0m12:46:18.825744 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m12:46:18.828278 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"
[0m12:46:18.828634 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m12:46:18.829125 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m12:46:18.829456 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_campaign_id
[0m12:46:18.829852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52, now test.brave_de_project.test_fce_campaign_id)
[0m12:46:18.830153 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_campaign_id
[0m12:46:18.832149 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_campaign_id"
[0m12:46:18.832502 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_campaign_id
[0m12:46:18.833004 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_campaign_id
[0m12:46:18.833332 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_product_id
[0m12:46:18.833704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_campaign_id, now test.brave_de_project.test_fce_product_id)
[0m12:46:18.833999 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_product_id
[0m12:46:18.836931 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_product_id"
[0m12:46:18.837276 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_product_id
[0m12:46:18.837785 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_product_id
[0m12:46:18.838090 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m12:46:18.838466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_product_id, now test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c)
[0m12:46:18.838753 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m12:46:18.841157 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"
[0m12:46:18.841531 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m12:46:18.842005 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m12:46:18.842305 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m12:46:18.842683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c, now test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc)
[0m12:46:18.842986 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m12:46:18.845590 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"
[0m12:46:18.845956 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m12:46:18.846470 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m12:46:18.846806 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m12:46:18.847169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5)
[0m12:46:18.847488 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m12:46:18.850151 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"
[0m12:46:18.850522 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m12:46:18.851025 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m12:46:18.851353 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m12:46:18.851750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986)
[0m12:46:18.852053 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m12:46:18.854568 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"
[0m12:46:18.854916 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m12:46:18.855389 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m12:46:18.855700 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m12:46:18.855997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986, now test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493)
[0m12:46:18.856351 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m12:46:18.858858 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"
[0m12:46:18.859224 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m12:46:18.859743 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m12:46:18.860074 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fspp_data
[0m12:46:18.860456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493, now test.brave_de_project.test_fspp_data)
[0m12:46:18.860753 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fspp_data
[0m12:46:18.862722 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fspp_data"
[0m12:46:18.863077 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fspp_data
[0m12:46:18.863585 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fspp_data
[0m12:46:18.864935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:18.865608 [debug] [MainThread]: Connection 'test.brave_de_project.test_fspp_data' was properly closed.
[0m12:46:18.879882 [debug] [MainThread]: Command end result
[0m12:46:18.995485 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:46:18.995759 [info ] [MainThread]: Building catalog
[0m12:46:19.003798 [debug] [ThreadPool]: Acquiring new snowflake connection 'BRAVE_DATABASE.information_schema'
[0m12:46:19.032609 [debug] [ThreadPool]: Using snowflake connection "BRAVE_DATABASE.information_schema"
[0m12:46:19.033610 [debug] [ThreadPool]: On BRAVE_DATABASE.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "BRAVE_DATABASE.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from BRAVE_DATABASE.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_product_data_qu' and upper("table_name") = upper('stg_product_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_campaign_qu' and upper("table_name") = upper('dim_campaign_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_inventory_data_qu' and upper("table_name") = upper('stg_inventory_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_location_qu' and upper("table_name") = upper('dim_search_location_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_qu' and upper("table_name") = upper('dim_search_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_search_product_performance_qu' and upper("table_name") = upper('fact_search_product_performance_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_inv_detail_qu' and upper("table_name") = upper('dim_inv_detail_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_journey_qu' and upper("table_name") = upper('stg_user_journey_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_data_qu' and upper("table_name") = upper('stg_user_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_campaign_effectiveness_qu' and upper("table_name") = upper('fact_campaign_effectiveness_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_product_qu' and upper("table_name") = upper('dim_product_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_user_qu' and upper("table_name") = upper('dim_user_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_inventory_management_qu' and upper("table_name") = upper('fact_inventory_management_qu')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from BRAVE_DATABASE.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_product_data_qu' and upper("table_name") = upper('stg_product_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_campaign_qu' and upper("table_name") = upper('dim_campaign_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_inventory_data_qu' and upper("table_name") = upper('stg_inventory_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_location_qu' and upper("table_name") = upper('dim_search_location_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_qu' and upper("table_name") = upper('dim_search_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_search_product_performance_qu' and upper("table_name") = upper('fact_search_product_performance_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_inv_detail_qu' and upper("table_name") = upper('dim_inv_detail_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_journey_qu' and upper("table_name") = upper('stg_user_journey_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_data_qu' and upper("table_name") = upper('stg_user_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_campaign_effectiveness_qu' and upper("table_name") = upper('fact_campaign_effectiveness_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_product_qu' and upper("table_name") = upper('dim_product_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_user_qu' and upper("table_name") = upper('dim_user_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_inventory_management_qu' and upper("table_name") = upper('fact_inventory_management_qu')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:46:19.034536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:28.078880 [debug] [ThreadPool]: SQL status: SUCCESS 181 in 9.044 seconds
[0m12:46:29.188567 [debug] [ThreadPool]: On BRAVE_DATABASE.information_schema: Close
[0m12:46:29.288620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly BRAVE_DATABASE.information_schema, now brave_database.information_schema)
[0m12:46:29.298655 [debug] [ThreadPool]: Using snowflake connection "brave_database.information_schema"
[0m12:46:29.299745 [debug] [ThreadPool]: On brave_database.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "brave_database.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from brave_database.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'product_data' and upper("table_name") = upper('product_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_journey' and upper("table_name") = upper('user_journey')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'inventory_data' and upper("table_name") = upper('inventory_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_data' and upper("table_name") = upper('user_data')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from brave_database.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'product_data' and upper("table_name") = upper('product_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_journey' and upper("table_name") = upper('user_journey')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'inventory_data' and upper("table_name") = upper('inventory_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_data' and upper("table_name") = upper('user_data')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:46:29.300744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:35.447491 [debug] [ThreadPool]: SQL status: SUCCESS 101 in 6.147 seconds
[0m12:46:35.470427 [debug] [ThreadPool]: On brave_database.information_schema: Close
[0m12:46:35.674138 [info ] [MainThread]: Catalog written to /home/user/Documents/AirflowSnowflakeProject/dbt/target/catalog.json
[0m12:46:35.675162 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 21.576868, "process_user_time": 2.750749, "process_kernel_time": 0.136037, "process_mem_max_rss": "126976", "process_out_blocks": "11208", "process_in_blocks": "0"}
[0m12:46:35.675738 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:46:35.675641 after 21.58 seconds
[0m12:46:35.676049 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:46:35.676282 [debug] [MainThread]: Connection 'brave_database.information_schema' was properly closed.
[0m12:46:35.676607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab4b31580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab38e5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744ab2981a60>]}
[0m12:46:35.676928 [debug] [MainThread]: Flushing usage events
[0m16:29:24.455132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b639d20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b64c77710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b643274a0>]}


============================== 16:29:24.461604 | cf7d8cf3-8ebc-4834-92c5-cc6a70878cfa ==============================
[0m16:29:24.461604 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:29:24.463008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/user/.dbt', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m16:29:24.595496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf7d8cf3-8ebc-4834-92c5-cc6a70878cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b637cf620>]}
[0m16:29:24.614209 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1920468, "process_user_time": 1.035302, "process_kernel_time": 0.077097, "process_mem_max_rss": "94820", "process_in_blocks": "240", "process_out_blocks": "8"}
[0m16:29:24.614709 [debug] [MainThread]: Command `dbt clean` succeeded at 16:29:24.614619 after 0.19 seconds
[0m16:29:24.615020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b65a109e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b639d20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a7b637a2c90>]}
[0m16:29:24.615317 [debug] [MainThread]: Flushing usage events
[0m16:29:36.111310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646f96d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646f0944a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646f095ee0>]}


============================== 16:29:36.117811 | 8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533 ==============================
[0m16:29:36.117811 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:29:36.119300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:36.231807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646ec783e0>]}
[0m16:29:36.253718 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-kovlgtzw'
[0m16:29:36.254255 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:29:36.365605 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:29:36.367055 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:29:36.450491 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:29:36.459980 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:29:36.532158 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:29:36.538494 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Montreal-Analytics/snowflake_utils.json
[0m16:29:36.684117 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Montreal-Analytics/snowflake_utils.json 200
[0m16:29:36.687447 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m16:29:36.762231 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m16:29:36.766978 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/data-mie/dbt_profiler.json
[0m16:29:36.842613 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/data-mie/dbt_profiler.json 200
[0m16:29:36.847692 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:29:37.275657 [info ] [MainThread]: Installed from version 1.1.1
[0m16:29:37.276759 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:29:37.277763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646ec794f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646ec78ce0>]}
[0m16:29:37.278764 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:29:37.541547 [info ] [MainThread]: Installed from version 0.10.0
[0m16:29:37.542459 [info ] [MainThread]: Updated version available: 0.10.1
[0m16:29:37.543248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7ed850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7ec680>]}
[0m16:29:37.543831 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-audit-helper.git
[0m16:29:37.544508 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m16:29:38.069393 [debug] [MainThread]: STDOUT: "b''"
[0m16:29:38.070520 [debug] [MainThread]: STDERR: "b"Cloning into 'd2deb5a374e89fe013946935cf9d0236'...\n""
[0m16:29:38.071695 [debug] [MainThread]: Pulling new dependency d2deb5a374e89fe013946935cf9d0236.
[0m16:29:38.072648 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:29:38.077200 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m16:29:38.078148 [debug] [MainThread]: STDERR: "b''"
[0m16:29:38.079309 [debug] [MainThread]: Checking out revision 6499107b5960d7c6140a8a44345034e6eb7b336d.
[0m16:29:38.080290 [debug] [MainThread]: Executing "git fetch origin --depth 1 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m16:29:38.514043 [debug] [MainThread]: STDOUT: "b''"
[0m16:29:38.515213 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            6499107b5960d7c6140a8a44345034e6eb7b336d -> FETCH_HEAD\n'"
[0m16:29:38.516182 [debug] [MainThread]: Executing "git reset --hard 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m16:29:38.528031 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m16:29:38.529004 [debug] [MainThread]: STDERR: "b''"
[0m16:29:38.529908 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:29:38.534134 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m16:29:38.535067 [debug] [MainThread]: STDERR: "b''"
[0m16:29:38.535946 [debug] [MainThread]: Checked out at 6499107.
[0m16:29:38.536843 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:29:38.541054 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m16:29:38.541986 [debug] [MainThread]: STDERR: "b''"
[0m16:29:38.546682 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-audit-helper.git d2deb5a374e89fe013946935cf9d0236"
[0m16:29:38.550422 [debug] [MainThread]: STDOUT: "b''"
[0m16:29:38.551334 [debug] [MainThread]: STDERR: "b"fatal: destination path 'd2deb5a374e89fe013946935cf9d0236' already exists and is not an empty directory.\n""
[0m16:29:38.552189 [debug] [MainThread]: command return code=128
[0m16:29:38.554671 [debug] [MainThread]: Updating existing dependency d2deb5a374e89fe013946935cf9d0236.
[0m16:29:38.555560 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:29:38.559809 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m16:29:38.560686 [debug] [MainThread]: STDERR: "b''"
[0m16:29:38.561469 [debug] [MainThread]: Checking out revision 6499107b5960d7c6140a8a44345034e6eb7b336d.
[0m16:29:38.562260 [debug] [MainThread]: Executing "git fetch origin --depth 1 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m16:29:39.015128 [debug] [MainThread]: STDOUT: "b''"
[0m16:29:39.016172 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-audit-helper\n * branch            6499107b5960d7c6140a8a44345034e6eb7b336d -> FETCH_HEAD\n'"
[0m16:29:39.017080 [debug] [MainThread]: Executing "git reset --hard 6499107b5960d7c6140a8a44345034e6eb7b336d"
[0m16:29:39.029775 [debug] [MainThread]: STDOUT: "b'HEAD is now at 6499107 Add tox-based Integration Testing Support (#111)\n'"
[0m16:29:39.030730 [debug] [MainThread]: STDERR: "b''"
[0m16:29:39.031610 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:29:39.035773 [debug] [MainThread]: STDOUT: "b'6499107b5960d7c6140a8a44345034e6eb7b336d\n'"
[0m16:29:39.036694 [debug] [MainThread]: STDERR: "b''"
[0m16:29:39.037543 [debug] [MainThread]: Already at 6499107, nothing to do.
[0m16:29:39.061579 [info ] [MainThread]: Installed from revision 6499107b5960d7c6140a8a44345034e6eb7b336d
[0m16:29:39.062161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7ed8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646ec43080>]}
[0m16:29:39.062710 [info ] [MainThread]: Installing Montreal-Analytics/snowflake_utils
[0m16:29:39.302617 [info ] [MainThread]: Installed from version 0.6.3
[0m16:29:39.303736 [info ] [MainThread]: Up to date!
[0m16:29:39.304701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7efb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7efe00>]}
[0m16:29:39.305701 [info ] [MainThread]: Installing dbt-labs/codegen
[0m16:29:39.576158 [info ] [MainThread]: Installed from version 0.12.1
[0m16:29:39.576939 [info ] [MainThread]: Up to date!
[0m16:29:39.577541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e80e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e80eed0>]}
[0m16:29:39.578211 [info ] [MainThread]: Installing data-mie/dbt_profiler
[0m16:29:39.978221 [info ] [MainThread]: Installed from version 0.8.1
[0m16:29:39.979368 [info ] [MainThread]: Updated version available: 0.8.3
[0m16:29:39.980431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8cae3f7a-07e8-4bd7-bfa4-0f1fd237e533', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e80e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e80e630>]}
[0m16:29:39.981500 [info ] [MainThread]: 
[0m16:29:39.982171 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_date', 'data-mie/dbt_profiler']                 
Update your versions in packages.yml, then run dbt deps
[0m16:29:39.984190 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.9049773, "process_user_time": 1.282655, "process_kernel_time": 0.122062, "process_mem_max_rss": "95200", "process_out_blocks": "5864", "process_in_blocks": "0"}
[0m16:29:39.985209 [debug] [MainThread]: Command `dbt deps` succeeded at 16:29:39.985020 after 3.91 seconds
[0m16:29:39.985909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646ee8e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646e7efe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a646eacdca0>]}
[0m16:29:39.986606 [debug] [MainThread]: Flushing usage events
[0m16:29:49.503297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27cfecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27d277a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27cfeed0>]}


============================== 16:29:49.509865 | 09af4c99-e2ba-49e6-8818-bfa5e7487462 ==============================
[0m16:29:49.509865 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:29:49.511267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:29:50.185226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2807bf50>]}
[0m16:29:50.225790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27ae8500>]}
[0m16:29:50.226326 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:29:50.271673 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:29:50.272411 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:29:50.272822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27b7b710>]}
[0m16:29:51.775030 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:29:51.775461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de3367590>]}
[0m16:29:52.005566 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.brave_de_project.test_stock_dates' (tests/test_stock_dates.sql) depends on a node named 'dim_inventory_qu' in package '' which was not found
[0m16:29:52.078110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.brave_de_project
[0m16:29:52.086822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de33d5b20>]}
[0m16:29:52.197164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddff29760>]}
[0m16:29:52.197615 [info ] [MainThread]: Found 13 models, 52 data tests, 4 sources, 851 macros, 7 unit tests
[0m16:29:52.201083 [info ] [MainThread]: 
[0m16:29:52.201597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:52.205528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BRAVE_DATABASE'
[0m16:29:52.215510 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE"
[0m16:29:52.215808 [debug] [ThreadPool]: On list_BRAVE_DATABASE: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE"} */
show terse schemas in database BRAVE_DATABASE
    limit 10000
[0m16:29:52.216067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:59.652180 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 7.436 seconds
[0m16:29:59.656465 [debug] [ThreadPool]: On list_BRAVE_DATABASE: Close
[0m16:29:59.742656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE, now list_BRAVE_DATABASE_PROJECT_TEST)
[0m16:29:59.763741 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE_PROJECT_TEST"
[0m16:29:59.764500 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE_PROJECT_TEST"} */
show objects in BRAVE_DATABASE.PROJECT_TEST limit 10000
[0m16:29:59.765164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:03.654135 [debug] [ThreadPool]: SQL status: SUCCESS 99 in 3.889 seconds
[0m16:30:03.664966 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: Close
[0m16:30:03.776367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de09f8170>]}
[0m16:30:03.777964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:03.779010 [info ] [MainThread]: 
[0m16:30:03.784642 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data
[0m16:30:03.785920 [info ] [Thread-1 (]: 1 of 100 START unit_test stg_inventory_data_qu::test_reformate_inventory_data .. [RUN]
[0m16:30:03.787210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE_PROJECT_TEST, now unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data)
[0m16:30:03.788317 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data
[0m16:30:03.789424 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data
[0m16:30:03.858552 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:03.859008 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"} */
describe table brave_database.de_project.inventory_data
[0m16:30:03.859320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:07.468101 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 3.608 seconds
[0m16:30:07.499863 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:07.511434 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:07.535801 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:07.536286 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_inventory_data__dbt_tmp
         as
        (select * from (
        


with  __dbt__cte__inventory_data as (

-- Fixture for inventory_data
select try_cast(null as NUMBER(38,0)) as inventory_id, try_cast(null as character varying(16777216)) as product_id, try_cast(null as NUMBER(38,0)) as warehouse_id, try_cast(null as NUMBER(38,0)) as stock_level, try_cast(null as DATE) as restock_date, try_cast(null as NUMBER(38,0)) as supplier_id, try_cast(null as character varying(16777216)) as storage_condition, try_cast(null as character varying(16777216)) as inventory_status, try_cast(null as TIMESTAMP_NTZ) as last_audit_date, try_cast(null as NUMBER(38,0)) as reorder_level, try_cast(null as NUMBER(38,0)) as quantity_in_stock, 
    
        try_cast('4,56' as character varying(16777216))
     as rating, try_cast(null as NUMBER(38,0)) as sales_volume, 
    
        try_cast('21,94744' as character varying(16777216))
     as weight, 
    
        try_cast('25,0333' as character varying(16777216))
     as discounts, try_cast(null as NUMBER(38,0)) as safety_stock, try_cast(null as NUMBER(38,0)) as average_monthly_demand, try_cast(null as DATE) as last_restock_date, try_cast(null as DATE) as next_restock_date
union all
select try_cast(null as NUMBER(38,0)) as inventory_id, try_cast(null as character varying(16777216)) as product_id, try_cast(null as NUMBER(38,0)) as warehouse_id, try_cast(null as NUMBER(38,0)) as stock_level, try_cast(null as DATE) as restock_date, try_cast(null as NUMBER(38,0)) as supplier_id, try_cast(null as character varying(16777216)) as storage_condition, try_cast(null as character varying(16777216)) as inventory_status, try_cast(null as TIMESTAMP_NTZ) as last_audit_date, try_cast(null as NUMBER(38,0)) as reorder_level, try_cast(null as NUMBER(38,0)) as quantity_in_stock, 
    
        try_cast('4' as character varying(16777216))
     as rating, try_cast(null as NUMBER(38,0)) as sales_volume, 
    
        try_cast(null as character varying(16777216))
     as weight, 
    
        try_cast('' as character varying(16777216))
     as discounts, try_cast(null as NUMBER(38,0)) as safety_stock, try_cast(null as NUMBER(38,0)) as average_monthly_demand, try_cast(null as DATE) as last_restock_date, try_cast(null as DATE) as next_restock_date
), source as (

    select * from __dbt__cte__inventory_data

),

staging_data as (

    select
        inventory_id,
        warehouse_id,
        stock_level,
        restock_date,
        supplier_id,
        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,
        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,
        reorder_level,
        quantity_in_stock,
        sales_volume,
        safety_stock,
        average_monthly_demand,
        last_restock_date,
        next_restock_date,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract last audit date from timestamp and
        -- convert to date format
        CAST(last_audit_date AS DATE) AS last_audit_date, 

        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        rating IS NULL OR TRIM(rating) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))
    )
 AS rating, 
      
        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        weight IS NULL OR TRIM(weight) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS prod_weight, 
        
        -- Change data type to NUMBER(38,2)
        
    IFF(
        discounts IS NULL OR TRIM(discounts) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS discounts

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:08.394689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m16:30:08.403296 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:08.404289 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_inventory_data__dbt_tmp
[0m16:30:08.509493 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.104 seconds
[0m16:30:08.533102 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:08.540803 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:08.541618 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    rating,prod_weight,discounts, 'actual' as "actual_or_expected"
  from (
    


with  __dbt__cte__inventory_data as (

-- Fixture for inventory_data
select try_cast(null as NUMBER(38,0)) as inventory_id, try_cast(null as character varying(16777216)) as product_id, try_cast(null as NUMBER(38,0)) as warehouse_id, try_cast(null as NUMBER(38,0)) as stock_level, try_cast(null as DATE) as restock_date, try_cast(null as NUMBER(38,0)) as supplier_id, try_cast(null as character varying(16777216)) as storage_condition, try_cast(null as character varying(16777216)) as inventory_status, try_cast(null as TIMESTAMP_NTZ) as last_audit_date, try_cast(null as NUMBER(38,0)) as reorder_level, try_cast(null as NUMBER(38,0)) as quantity_in_stock, 
    
        try_cast('4,56' as character varying(16777216))
     as rating, try_cast(null as NUMBER(38,0)) as sales_volume, 
    
        try_cast('21,94744' as character varying(16777216))
     as weight, 
    
        try_cast('25,0333' as character varying(16777216))
     as discounts, try_cast(null as NUMBER(38,0)) as safety_stock, try_cast(null as NUMBER(38,0)) as average_monthly_demand, try_cast(null as DATE) as last_restock_date, try_cast(null as DATE) as next_restock_date
union all
select try_cast(null as NUMBER(38,0)) as inventory_id, try_cast(null as character varying(16777216)) as product_id, try_cast(null as NUMBER(38,0)) as warehouse_id, try_cast(null as NUMBER(38,0)) as stock_level, try_cast(null as DATE) as restock_date, try_cast(null as NUMBER(38,0)) as supplier_id, try_cast(null as character varying(16777216)) as storage_condition, try_cast(null as character varying(16777216)) as inventory_status, try_cast(null as TIMESTAMP_NTZ) as last_audit_date, try_cast(null as NUMBER(38,0)) as reorder_level, try_cast(null as NUMBER(38,0)) as quantity_in_stock, 
    
        try_cast('4' as character varying(16777216))
     as rating, try_cast(null as NUMBER(38,0)) as sales_volume, 
    
        try_cast(null as character varying(16777216))
     as weight, 
    
        try_cast('' as character varying(16777216))
     as discounts, try_cast(null as NUMBER(38,0)) as safety_stock, try_cast(null as NUMBER(38,0)) as average_monthly_demand, try_cast(null as DATE) as last_restock_date, try_cast(null as DATE) as next_restock_date
), source as (

    select * from __dbt__cte__inventory_data

),

staging_data as (

    select
        inventory_id,
        warehouse_id,
        stock_level,
        restock_date,
        supplier_id,
        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,
        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,
        reorder_level,
        quantity_in_stock,
        sales_volume,
        safety_stock,
        average_monthly_demand,
        last_restock_date,
        next_restock_date,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract last audit date from timestamp and
        -- convert to date format
        CAST(last_audit_date AS DATE) AS last_audit_date, 

        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        rating IS NULL OR TRIM(rating) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))
    )
 AS rating, 
      
        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        weight IS NULL OR TRIM(weight) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS prod_weight, 
        
        -- Change data type to NUMBER(38,2)
        
    IFF(
        discounts IS NULL OR TRIM(discounts) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS discounts

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    rating, prod_weight, discounts, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('4.6' as NUMBER(38,1))
     as rating, 
    
        try_cast('21.95' as NUMBER(38,2))
     as prod_weight, 
    
        try_cast('25.03' as NUMBER(38,2))
     as discounts
union all
select 
    
        try_cast('4.0' as NUMBER(38,1))
     as rating, 
    
        try_cast('0' as NUMBER(38,2))
     as prod_weight, 
    
        try_cast('0' as NUMBER(38,2))
     as discounts
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:08.884282 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.342 seconds
[0m16:30:08.901878 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_inventory_data__dbt_tmp
[0m16:30:08.912236 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"
[0m16:30:08.912810 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_inventory_data__dbt_tmp cascade
[0m16:30:09.018325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m16:30:09.027097 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data: Close
[0m16:30:09.108096 [info ] [Thread-1 (]: 1 of 100 PASS stg_inventory_data_qu::test_reformate_inventory_data ............. [[32mPASS[0m in 5.32s]
[0m16:30:09.109957 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data
[0m16:30:09.111331 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_inventory_data_qu
[0m16:30:09.112792 [info ] [Thread-1 (]: 2 of 100 START sql view model PROJECT_TEST.stg_inventory_data_qu ............... [RUN]
[0m16:30:09.114091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_inventory_data_qu.test_reformate_inventory_data, now model.brave_de_project.stg_inventory_data_qu)
[0m16:30:09.115620 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_inventory_data_qu
[0m16:30:09.126537 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_inventory_data_qu"
[0m16:30:09.128097 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_inventory_data_qu
[0m16:30:09.186162 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_inventory_data_qu"
[0m16:30:09.188705 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_inventory_data_qu"
[0m16:30:09.189415 [debug] [Thread-1 (]: On model.brave_de_project.stg_inventory_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_inventory_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu
  
  copy grants as (
    


with source as (

    select * from brave_database.de_project.inventory_data

),

staging_data as (

    select
        inventory_id,
        warehouse_id,
        stock_level,
        restock_date,
        supplier_id,
        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,
        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,
        reorder_level,
        quantity_in_stock,
        sales_volume,
        safety_stock,
        average_monthly_demand,
        last_restock_date,
        next_restock_date,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract last audit date from timestamp and
        -- convert to date format
        CAST(last_audit_date AS DATE) AS last_audit_date, 

        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        rating IS NULL OR TRIM(rating) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))
    )
 AS rating, 
      
        -- Change data type from varchar to NUMBER(38,1)
        
    IFF(
        weight IS NULL OR TRIM(weight) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS prod_weight, 
        
        -- Change data type to NUMBER(38,2)
        
    IFF(
        discounts IS NULL OR TRIM(discounts) = '', 
        0, 
        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))
    )
 AS discounts

    from source

)

select * from staging_data
  );
[0m16:30:09.190024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:12.277324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.087 seconds
[0m16:30:12.314619 [debug] [Thread-1 (]: On model.brave_de_project.stg_inventory_data_qu: Close
[0m16:30:12.408456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e284b4fb0>]}
[0m16:30:12.410402 [info ] [Thread-1 (]: 2 of 100 OK created sql view model PROJECT_TEST.stg_inventory_data_qu .......... [[32mSUCCESS 1[0m in 3.29s]
[0m16:30:12.412237 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_inventory_data_qu
[0m16:30:12.413587 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty
[0m16:30:12.415151 [info ] [Thread-1 (]: 3 of 100 START unit_test stg_product_data_qu::test_reformate_product_data_warranty  [RUN]
[0m16:30:12.416827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_inventory_data_qu, now unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty)
[0m16:30:12.418065 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty
[0m16:30:12.419163 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty
[0m16:30:12.439803 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:12.440418 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"} */
describe table brave_database.de_project.product_data
[0m16:30:12.440928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:16.115853 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 3.675 seconds
[0m16:30:16.126090 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.141335 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.149196 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.149861 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_product_data_warranty__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__product_data as (

-- Fixture for product_data
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('22 months' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('m 24' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast(null as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
), source as (

    select * from __dbt__cte__product_data

),

staging_data as (

    select
        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract warranty_period from varchar to NUMBER
        
    IFF(
        warranty_period IS NULL OR TRIM(warranty_period) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)
    )
 AS warranty_period_months, 
      
        -- Converting to smaller string
        CAST(product_name AS VARCHAR(64)) AS product_name,
        CAST(product_category AS VARCHAR(64)) AS product_category,
        CAST(product_color AS VARCHAR(64)) AS product_color,

        price,
        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       
        manufacturing_date,
        expiration_date,
        quantity_in_stock,
        rating,
        sales_volume,
        weight_grams,
        discount_percentage

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:16.468668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m16:30:16.477239 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.478127 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_product_data_warranty__dbt_tmp
[0m16:30:16.555918 [debug] [Thread-1 (]: SQL status: SUCCESS 14 in 0.077 seconds
[0m16:30:16.564148 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.573686 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.574828 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    warranty_period_months, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__product_data as (

-- Fixture for product_data
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('22 months' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('m 24' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast(null as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
union all
select try_cast(null as character varying(16777216)) as product_id, try_cast(null as character varying(16777216)) as product_name, try_cast(null as character varying(16777216)) as product_category, try_cast(null as NUMBER(38,2)) as price, try_cast(null as character varying(16777216)) as supplier_id, try_cast(null as character varying(16777216)) as product_color, try_cast(null as DATE) as manufacturing_date, try_cast(null as DATE) as expiration_date, 
    
        try_cast('' as character varying(16777216))
     as warranty_period, try_cast(null as NUMBER(38,0)) as quantity_in_stock, try_cast(null as NUMBER(38,1)) as rating, try_cast(null as NUMBER(38,0)) as sales_volume, try_cast(null as NUMBER(38,0)) as weight_grams, try_cast(null as NUMBER(38,0)) as discount_percentage
), source as (

    select * from __dbt__cte__product_data

),

staging_data as (

    select
        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract warranty_period from varchar to NUMBER
        
    IFF(
        warranty_period IS NULL OR TRIM(warranty_period) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)
    )
 AS warranty_period_months, 
      
        -- Converting to smaller string
        CAST(product_name AS VARCHAR(64)) AS product_name,
        CAST(product_category AS VARCHAR(64)) AS product_category,
        CAST(product_color AS VARCHAR(64)) AS product_color,

        price,
        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       
        manufacturing_date,
        expiration_date,
        quantity_in_stock,
        rating,
        sales_volume,
        weight_grams,
        discount_percentage

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    warranty_period_months, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('22' as NUMBER(38,0))
     as warranty_period_months
union all
select 
    
        try_cast('24' as NUMBER(38,0))
     as warranty_period_months
union all
select 
    
        try_cast('0' as NUMBER(38,0))
     as warranty_period_months
union all
select 
    
        try_cast('0' as NUMBER(38,0))
     as warranty_period_months
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:16.893341 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.317 seconds
[0m16:30:16.902314 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_product_data_warranty__dbt_tmp
[0m16:30:16.912976 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"
[0m16:30:16.914131 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_product_data_warranty__dbt_tmp cascade
[0m16:30:16.992841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m16:30:16.998550 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty: Close
[0m16:30:17.087247 [info ] [Thread-1 (]: 3 of 100 PASS stg_product_data_qu::test_reformate_product_data_warranty ........ [[32mPASS[0m in 4.67s]
[0m16:30:17.089089 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty
[0m16:30:17.090425 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_product_data_qu
[0m16:30:17.091857 [info ] [Thread-1 (]: 5 of 100 START sql view model PROJECT_TEST.stg_product_data_qu ................. [RUN]
[0m16:30:17.093050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_product_data_qu.test_reformate_product_data_warranty, now model.brave_de_project.stg_product_data_qu)
[0m16:30:17.093935 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_product_data_qu
[0m16:30:17.103538 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_product_data_qu"
[0m16:30:17.104347 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_product_data_qu
[0m16:30:17.108768 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_product_data_qu"
[0m16:30:17.110812 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_product_data_qu"
[0m16:30:17.111511 [debug] [Thread-1 (]: On model.brave_de_project.stg_product_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_product_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.product_data

),

staging_data as (

    select
        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 
        
        -- Extract warranty_period from varchar to NUMBER
        
    IFF(
        warranty_period IS NULL OR TRIM(warranty_period) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)
    )
 AS warranty_period_months, 
      
        -- Converting to smaller string
        CAST(product_name AS VARCHAR(64)) AS product_name,
        CAST(product_category AS VARCHAR(64)) AS product_category,
        CAST(product_color AS VARCHAR(64)) AS product_color,

        price,
        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       
        manufacturing_date,
        expiration_date,
        quantity_in_stock,
        rating,
        sales_volume,
        weight_grams,
        discount_percentage

    from source

)

select * from staging_data
  );
[0m16:30:17.112154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:20.784503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.672 seconds
[0m16:30:20.789598 [debug] [Thread-1 (]: On model.brave_de_project.stg_product_data_qu: Close
[0m16:30:20.871362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e0bfeea50>]}
[0m16:30:20.873209 [info ] [Thread-1 (]: 5 of 100 OK created sql view model PROJECT_TEST.stg_product_data_qu ............ [[32mSUCCESS 1[0m in 3.78s]
[0m16:30:20.875003 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_product_data_qu
[0m16:30:20.876267 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates
[0m16:30:20.877305 [info ] [Thread-1 (]: 6 of 100 START unit_test stg_user_data_qu::test_reformate_user_data_dates ...... [RUN]
[0m16:30:20.879394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_product_data_qu, now unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates)
[0m16:30:20.880534 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates
[0m16:30:20.881637 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates
[0m16:30:20.902594 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:20.903332 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"} */
describe table brave_database.de_project.user_data
[0m16:30:20.903985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:24.765443 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 3.861 seconds
[0m16:30:24.774629 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:24.795158 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:24.802533 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:24.803076 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_dates__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, 
    
        try_cast('2024-10-03' as character varying(16777216))
     as signup_date, try_cast(null as character varying(16777216)) as preferred_language, 
    
        try_cast('2000-10-03' as character varying(16777216))
     as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, 
    
        try_cast(null as character varying(16777216))
     as signup_date, try_cast(null as character varying(16777216)) as preferred_language, 
    
        try_cast(null as character varying(16777216))
     as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:25.205000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m16:30:25.213623 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:25.214799 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_dates__dbt_tmp
[0m16:30:25.331544 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.116 seconds
[0m16:30:25.338712 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:25.345473 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:25.346575 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    signup_date,dob, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, 
    
        try_cast('2024-10-03' as character varying(16777216))
     as signup_date, try_cast(null as character varying(16777216)) as preferred_language, 
    
        try_cast('2000-10-03' as character varying(16777216))
     as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, 
    
        try_cast(null as character varying(16777216))
     as signup_date, try_cast(null as character varying(16777216)) as preferred_language, 
    
        try_cast(null as character varying(16777216))
     as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    signup_date, dob, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('datetime.date(2024, 10, 3)' as DATE)
     as signup_date, 
    
        try_cast('datetime.date(2000, 10, 3)' as DATE)
     as dob
union all
select 
    
        try_cast(null as DATE)
     as signup_date, 
    
        try_cast(null as DATE)
     as dob
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:25.462030 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.114 seconds
[0m16:30:25.470827 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_dates__dbt_tmp
[0m16:30:25.472606 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"
[0m16:30:25.473400 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_dates__dbt_tmp cascade
[0m16:30:25.593598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m16:30:25.599566 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates: Close
[0m16:30:25.679993 [info ] [Thread-1 (]: 6 of 100 PASS stg_user_data_qu::test_reformate_user_data_dates ................. [[32mPASS[0m in 4.80s]
[0m16:30:25.681759 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates
[0m16:30:25.683036 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email
[0m16:30:25.684182 [info ] [Thread-1 (]: 8 of 100 START unit_test stg_user_data_qu::test_reformate_user_data_email ...... [RUN]
[0m16:30:25.685323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_dates, now unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email)
[0m16:30:25.686302 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email
[0m16:30:25.687269 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email
[0m16:30:25.705079 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:25.705625 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"} */
describe table brave_database.de_project.user_data
[0m16:30:25.706066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:28.854222 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 3.148 seconds
[0m16:30:28.862630 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:28.885169 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:28.891099 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:28.891618 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_email__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, 
    
        try_cast('gtgtg@gmail.com' as character varying(16777216))
     as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, 
    
        try_cast('abcdefg@hi@klmn' as character varying(16777216))
     as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:29.466990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m16:30:29.475054 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:29.476059 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_email__dbt_tmp
[0m16:30:29.661589 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.185 seconds
[0m16:30:29.668052 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:29.676281 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:29.677332 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    email, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, 
    
        try_cast('gtgtg@gmail.com' as character varying(16777216))
     as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, 
    
        try_cast('abcdefg@hi@klmn' as character varying(16777216))
     as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, try_cast(null as character varying(16777216)) as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    email, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('gtgtg@gmail.com' as character varying(16777216))
     as email
union all
select 
    
        try_cast(null as character varying(16777216))
     as email
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:29.777137 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.099 seconds
[0m16:30:29.787200 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_email__dbt_tmp
[0m16:30:29.788654 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"
[0m16:30:29.789496 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_email__dbt_tmp cascade
[0m16:30:29.934713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m16:30:29.940225 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email: Close
[0m16:30:30.044767 [info ] [Thread-1 (]: 8 of 100 PASS stg_user_data_qu::test_reformate_user_data_email ................. [[32mPASS[0m in 4.36s]
[0m16:30:30.046496 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email
[0m16:30:30.047754 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points
[0m16:30:30.048895 [info ] [Thread-1 (]: 9 of 100 START unit_test stg_user_data_qu::test_reformate_user_data_loyalty_points  [RUN]
[0m16:30:30.050142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_email, now unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points)
[0m16:30:30.051107 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points
[0m16:30:30.052022 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points
[0m16:30:30.071778 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:30.072998 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"} */
describe table brave_database.de_project.user_data
[0m16:30:30.074049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:33.113034 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 3.039 seconds
[0m16:30:33.121239 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.158844 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.173080 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.174666 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_loyalty_points__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, 
    
        try_cast('1234.0' as character varying(16777216))
     as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, 
    
        try_cast(null as character varying(16777216))
     as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:33.629465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m16:30:33.637480 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.638648 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_loyalty_points__dbt_tmp
[0m16:30:33.732424 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.093 seconds
[0m16:30:33.738887 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.746650 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.747692 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    loyalty_points_balance, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__user_data as (

-- Fixture for user_data
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, 
    
        try_cast('1234.0' as character varying(16777216))
     as loyalty_points_balance
union all
select try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as first_name, try_cast(null as character varying(16777216)) as last_name, try_cast(null as character varying(16777216)) as email, try_cast(null as character varying(16777216)) as signup_date, try_cast(null as character varying(16777216)) as preferred_language, try_cast(null as character varying(16777216)) as dob, try_cast(null as character varying(16777216)) as marketing_opt_in, try_cast(null as character varying(16777216)) as account_status, 
    
        try_cast(null as character varying(16777216))
     as loyalty_points_balance
), source as (

    select * from __dbt__cte__user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    loyalty_points_balance, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('1234' as NUMBER(38,0))
     as loyalty_points_balance
union all
select 
    
        try_cast('0' as NUMBER(38,0))
     as loyalty_points_balance
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:33.878695 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.130 seconds
[0m16:30:33.889849 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_loyalty_points__dbt_tmp
[0m16:30:33.891540 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"
[0m16:30:33.892474 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_data_loyalty_points__dbt_tmp cascade
[0m16:30:34.020563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m16:30:34.025956 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points: Close
[0m16:30:34.114144 [info ] [Thread-1 (]: 9 of 100 PASS stg_user_data_qu::test_reformate_user_data_loyalty_points ........ [[32mPASS[0m in 4.06s]
[0m16:30:34.115892 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points
[0m16:30:34.117185 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_data_qu
[0m16:30:34.118596 [info ] [Thread-1 (]: 10 of 100 START sql view model PROJECT_TEST.stg_user_data_qu ................... [RUN]
[0m16:30:34.119658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_user_data_qu.test_reformate_user_data_loyalty_points, now model.brave_de_project.stg_user_data_qu)
[0m16:30:34.120576 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_data_qu
[0m16:30:34.128331 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_data_qu"
[0m16:30:34.129176 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_data_qu
[0m16:30:34.133692 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_user_data_qu"
[0m16:30:34.136247 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_user_data_qu"
[0m16:30:34.137010 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_data_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_user_data_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.user_data

),

staging_data as (

    select
        user_id,
        
        -- Converting to short field
        CAST(first_name AS VARCHAR(64)) AS first_name,
        CAST(last_name AS VARCHAR(64)) AS last_name,
        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,
        CAST(account_status AS VARCHAR(64)) AS account_status,

        -- Checking for invalid email id format 
        CASE 
            WHEN email not like '%_@__%.__%' THEN NULL 
            ELSE CAST(email AS VARCHAR(256)) 
        END AS email,

        -- Convert signup_date from VARCHAR to DATE
        
    IFF(
        signup_date IS NULL OR TRIM(signup_date) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(signup_date), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(signup_date) AS DATE), 
            NULL
        )
    )
 AS signup_date,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        dob IS NULL OR TRIM(dob) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(dob), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(dob) AS DATE), 
            NULL
        )
    )
 AS dob,

         -- Convert marketing_opt_in from VARCHAR to BOOLEAN
        CASE 
            WHEN marketing_opt_in = 'True' THEN TRUE
            WHEN marketing_opt_in = 'False' THEN FALSE
            ELSE False 
        END AS marketing_opt_in,

        -- Convert loyalty_points_balance from VARCHAR to NUMBER
        
    IFF(
        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)
    )
 AS loyalty_points_balance

    from source

)

select * from staging_data
  );
[0m16:30:34.137715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:37.705222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.567 seconds
[0m16:30:37.710312 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_data_qu: Close
[0m16:30:37.822527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddb562a20>]}
[0m16:30:37.824310 [info ] [Thread-1 (]: 10 of 100 OK created sql view model PROJECT_TEST.stg_user_data_qu .............. [[32mSUCCESS 1[0m in 3.70s]
[0m16:30:37.826035 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_data_qu
[0m16:30:37.827325 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey
[0m16:30:37.828719 [info ] [Thread-1 (]: 11 of 100 START unit_test stg_user_journey_qu::test_reformate_user_journey ..... [RUN]
[0m16:30:37.830244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_data_qu, now unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey)
[0m16:30:37.831362 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey
[0m16:30:37.832476 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey
[0m16:30:37.850897 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:37.851535 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"} */
describe table brave_database.de_project.user_journey
[0m16:30:37.852048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:41.829486 [debug] [Thread-1 (]: SQL status: SUCCESS 58 in 3.977 seconds
[0m16:30:41.851049 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:41.877062 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:41.886831 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:41.887524 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_journey__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__user_journey as (

-- Fixture for user_journey
select try_cast(null as character varying(16777216)) as search_event_id, try_cast(null as TIMESTAMP_NTZ) as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, 
    
        try_cast('andriod-prod' as character varying(16777216))
     as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, 
    
        try_cast('2024-10-03' as character varying(16777216))
     as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, 
    
        try_cast('76456' as character varying(16777216))
     as product_id
union all
select try_cast(null as character varying(16777216)) as search_event_id, try_cast(null as TIMESTAMP_NTZ) as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, 
    
        try_cast('ios' as character varying(16777216))
     as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, 
    
        try_cast(null as character varying(16777216))
     as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, 
    
        try_cast('prod-02928' as character varying(16777216))
     as product_id
), source as (

    select * from __dbt__cte__user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:42.390315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m16:30:42.399086 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:42.400305 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_journey__dbt_tmp
[0m16:30:42.494122 [debug] [Thread-1 (]: SQL status: SUCCESS 58 in 0.093 seconds
[0m16:30:42.508195 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:42.536012 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:42.537420 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    app_id,date_last_login,product_id, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__user_journey as (

-- Fixture for user_journey
select try_cast(null as character varying(16777216)) as search_event_id, try_cast(null as TIMESTAMP_NTZ) as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, 
    
        try_cast('andriod-prod' as character varying(16777216))
     as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, 
    
        try_cast('2024-10-03' as character varying(16777216))
     as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, 
    
        try_cast('76456' as character varying(16777216))
     as product_id
union all
select try_cast(null as character varying(16777216)) as search_event_id, try_cast(null as TIMESTAMP_NTZ) as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, 
    
        try_cast('ios' as character varying(16777216))
     as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, 
    
        try_cast(null as character varying(16777216))
     as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, 
    
        try_cast('prod-02928' as character varying(16777216))
     as product_id
), source as (

    select * from __dbt__cte__user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    app_id, date_last_login, product_id, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('andriod' as character varying(32))
     as app_id, 
    
        try_cast('datetime.date(2024,10,03)' as DATE)
     as date_last_login, 
    
        try_cast('76456' as NUMBER(38,0))
     as product_id
union all
select 
    
        try_cast('ios' as character varying(32))
     as app_id, 
    
        try_cast(null as DATE)
     as date_last_login, 
    
        try_cast('2928' as NUMBER(38,0))
     as product_id
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:42.790170 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.252 seconds
[0m16:30:42.799768 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_journey__dbt_tmp
[0m16:30:42.801448 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"
[0m16:30:42.802246 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_reformate_user_journey__dbt_tmp cascade
[0m16:30:42.930340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m16:30:42.936846 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey: Close
[0m16:30:43.026124 [info ] [Thread-1 (]: 11 of 100 PASS stg_user_journey_qu::test_reformate_user_journey ................ [[32mPASS[0m in 5.19s]
[0m16:30:43.028011 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey
[0m16:30:43.029313 [debug] [Thread-1 (]: Began running node unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey
[0m16:30:43.030491 [info ] [Thread-1 (]: 13 of 100 START unit_test stg_user_journey_qu::test_is_valid_ts_user_journey ... [RUN]
[0m16:30:43.031752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_user_journey_qu.test_reformate_user_journey, now unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey)
[0m16:30:43.032764 [debug] [Thread-1 (]: Began compiling node unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey
[0m16:30:43.033544 [debug] [Thread-1 (]: Began executing node unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey
[0m16:30:43.052329 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:43.052869 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"} */
describe table brave_database.de_project.user_journey
[0m16:30:43.053243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:45.910707 [debug] [Thread-1 (]: SQL status: SUCCESS 58 in 2.857 seconds
[0m16:30:45.928696 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:45.957874 [debug] [Thread-1 (]: Writing injected SQL for node "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:45.967961 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:45.968660 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"} */
create or replace temporary table BRAVE_DATABASE.PROJECT_TEST.test_is_valid_ts_user_journey__dbt_tmp
         as
        (select * from (
        

with  __dbt__cte__user_journey as (

-- Fixture for user_journey
select try_cast(null as character varying(16777216)) as search_event_id, 
    
        try_cast('2024-02-17 18:41:07' as TIMESTAMP_NTZ)
     as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, try_cast(null as character varying(16777216)) as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, try_cast(null as character varying(16777216)) as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, try_cast(null as character varying(16777216)) as product_id
union all
select try_cast(null as character varying(16777216)) as search_event_id, 
    
        try_cast('2024-02-17 18:42:07 UTC' as TIMESTAMP_NTZ)
     as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, try_cast(null as character varying(16777216)) as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, try_cast(null as character varying(16777216)) as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, try_cast(null as character varying(16777216)) as product_id
), source as (

    select * from __dbt__cte__user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
    ) as __dbt_sbq
    where false
    limit 0

        );
[0m16:30:46.360598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m16:30:46.369092 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:46.370245 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"} */
describe table BRAVE_DATABASE.PROJECT_TEST.test_is_valid_ts_user_journey__dbt_tmp
[0m16:30:46.443954 [debug] [Thread-1 (]: SQL status: SUCCESS 58 in 0.073 seconds
[0m16:30:46.455840 [debug] [Thread-1 (]: Writing runtime sql for node "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:46.476496 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:46.477589 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"} */
-- Build actual result given inputs
with dbt_internal_unit_test_actual as (
  select
    search_timestamp, 'actual' as "actual_or_expected"
  from (
    

with  __dbt__cte__user_journey as (

-- Fixture for user_journey
select try_cast(null as character varying(16777216)) as search_event_id, 
    
        try_cast('2024-02-17 18:41:07' as TIMESTAMP_NTZ)
     as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, try_cast(null as character varying(16777216)) as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, try_cast(null as character varying(16777216)) as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, try_cast(null as character varying(16777216)) as product_id
union all
select try_cast(null as character varying(16777216)) as search_event_id, 
    
        try_cast('2024-02-17 18:42:07 UTC' as TIMESTAMP_NTZ)
     as timestamp, try_cast(null as TIMESTAMP_NTZ) as collector_tstamp, try_cast(null as character varying(16777216)) as app_id, try_cast(null as BOOLEAN) as has_qv, try_cast(null as BOOLEAN) as has_pdp, try_cast(null as BOOLEAN) as has_atc, try_cast(null as BOOLEAN) as has_purchase, try_cast(null as character varying(16777216)) as impressions_with_attributions, try_cast(null as character varying(16777216)) as cart_id, try_cast(null as character varying(16777216)) as session_id, try_cast(null as character varying(16777216)) as search_request_id, try_cast(null as NUMBER(38,0)) as search_results_count, try_cast(null as character varying(16777216)) as search_terms, try_cast(null as character varying(16777216)) as search_feature, try_cast(null as character varying(16777216)) as search_terms_type, try_cast(null as character varying(16777216)) as search_type, try_cast(null as character varying(16777216)) as aes_hash, try_cast(null as character varying(16777216)) as date_last_login, try_cast(null as DATE) as date_last_purchase, try_cast(null as character varying(16777216)) as grocery_home_store_id, try_cast(null as NUMBER(38,1)) as lifetime_offline_orders_count, try_cast(null as NUMBER(38,1)) as lifetime_online_orders_count, try_cast(null as character varying(16777216)) as login_status, try_cast(null as character varying(16777216)) as user_id, try_cast(null as character varying(16777216)) as registration_status, try_cast(null as character varying(16777216)) as rx_home_store_id, try_cast(null as character varying(16777216)) as sha256_hash, try_cast(null as character varying(16777216)) as banner, try_cast(null as character varying(16777216)) as auto_localized_store_id, try_cast(null as character varying(16777216)) as fulfillment_type, try_cast(null as NUMBER(38,1)) as selected_store_id, try_cast(null as DATE) as selected_timeslot_date, try_cast(null as character varying(16777216)) as selected_timeslot_time, try_cast(null as character varying(16777216)) as selected_timeslot_type, try_cast(null as character varying(16777216)) as shopping_mode, try_cast(null as character varying(16777216)) as device_class, try_cast(null as NUMBER(38,1)) as br_viewwidth, try_cast(null as NUMBER(38,1)) as br_viewheight, try_cast(null as NUMBER(38,0)) as dvce_screenwidth, try_cast(null as NUMBER(38,0)) as dvce_screenheight, try_cast(null as NUMBER(38,1)) as doc_width, try_cast(null as NUMBER(38,1)) as doc_height, try_cast(null as character varying(16777216)) as mkt_medium, try_cast(null as character varying(16777216)) as mkt_source, try_cast(null as character varying(16777216)) as mkt_content, try_cast(null as character varying(16777216)) as mkt_campaign, try_cast(null as character varying(16777216)) as br_lang, try_cast(null as character varying(16777216)) as page_language, try_cast(null as character varying(16777216)) as geo_country, try_cast(null as character varying(16777216)) as geo_region, try_cast(null as character varying(16777216)) as geo_city, try_cast(null as character varying(16777216)) as geo_zipcode, try_cast(null as NUMBER(38,4)) as geo_latitude, try_cast(null as NUMBER(38,4)) as geo_longitude, try_cast(null as character varying(16777216)) as geo_timezone, try_cast(null as character varying(16777216)) as search_model, try_cast(null as character varying(16777216)) as product_id
), source as (

    select * from __dbt__cte__user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
  ) _dbt_internal_unit_test_actual
),
-- Build expected result
dbt_internal_unit_test_expected as (
  select
    search_timestamp, 'expected' as "actual_or_expected"
  from (
    select 
    
        try_cast('2024-02-17 18:41:07' as TIMESTAMP_NTZ)
     as search_timestamp
union all
select 
    
        try_cast(null as TIMESTAMP_NTZ)
     as search_timestamp
  ) _dbt_internal_unit_test_expected
)
-- Union actual and expected results
select * from dbt_internal_unit_test_actual
union all
select * from dbt_internal_unit_test_expected
[0m16:30:46.632934 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.154 seconds
[0m16:30:46.642277 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.test_is_valid_ts_user_journey__dbt_tmp
[0m16:30:46.644311 [debug] [Thread-1 (]: Using snowflake connection "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"
[0m16:30:46.645455 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey"} */
drop table if exists BRAVE_DATABASE.PROJECT_TEST.test_is_valid_ts_user_journey__dbt_tmp cascade
[0m16:30:46.754852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m16:30:46.760445 [debug] [Thread-1 (]: On unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey: Close
[0m16:30:46.855115 [info ] [Thread-1 (]: 13 of 100 PASS stg_user_journey_qu::test_is_valid_ts_user_journey .............. [[32mPASS[0m in 3.82s]
[0m16:30:46.856863 [debug] [Thread-1 (]: Finished running node unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey
[0m16:30:46.858180 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_journey_qu
[0m16:30:46.859549 [info ] [Thread-1 (]: 14 of 100 START sql view model PROJECT_TEST.stg_user_journey_qu ................ [RUN]
[0m16:30:46.860731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly unit_test.brave_de_project.stg_user_journey_qu.test_is_valid_ts_user_journey, now model.brave_de_project.stg_user_journey_qu)
[0m16:30:46.861770 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_journey_qu
[0m16:30:46.870281 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_journey_qu"
[0m16:30:46.871232 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_journey_qu
[0m16:30:46.878678 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.stg_user_journey_qu"
[0m16:30:46.882276 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.stg_user_journey_qu"
[0m16:30:46.882989 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_journey_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.stg_user_journey_qu"} */
create or replace   view BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu
  
  copy grants as (
    

with source as (

    select * from brave_database.de_project.user_journey

),

staging_data as (

    select
        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,
        has_qv,
        has_pdp,
        has_atc,
        has_purchase,
        impressions_with_attributions,
        cart_id,
        CAST(session_id AS VARCHAR(64)) AS session_id,
        search_request_id,
        search_results_count,
        CAST(search_terms AS VARCHAR(64)) AS search_terms,
        CAST(search_feature AS VARCHAR(64)) AS search_feature,
        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,
        CAST(search_type AS VARCHAR(64)) AS search_type,
        aes_hash,
        date_last_purchase,
        login_status,
        CAST(user_id AS VARCHAR(64)) AS user_id,     
        sha256_hash,
        banner,  
        fulfillment_type,
        selected_timeslot_date,
        selected_timeslot_time,
        selected_timeslot_type,    
        br_viewwidth,
        br_viewheight,
        dvce_screenwidth,
        dvce_screenheight,
        doc_width,
        doc_height,
        CAST(mkt_medium AS VARCHAR(64)) AS medium,
        CAST(mkt_source AS VARCHAR(64)) AS source,
        CAST(mkt_content AS VARCHAR(64)) AS content,
        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     
        geo_latitude AS latitude,
        geo_longitude AS longitude,

        -- Reformat data
        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,

        -- Convert dob from VARCHAR to DATE
        
    IFF(
        date_last_login IS NULL OR TRIM(date_last_login) = '', 
        NULL, 
        IFF(
            REGEXP_LIKE(TRIM(date_last_login), '^\d{4}-\d{2}-\d{2}$'), 
            TRY_CAST(TRIM(date_last_login) AS DATE), 
            NULL
        )
    )
 AS date_last_login,

        -- converting to interger, as count can only be integer
        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,
        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,

        -- converting id to integer number
        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,
        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,
        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,
        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,

        -- Truncate the field to necessary length
        CAST(registration_status AS VARCHAR(32)) AS registration_status,
        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,
        CAST(device_class AS VARCHAR(32)) AS device_class,
        CAST(br_lang AS VARCHAR(32)) AS br_language,
        CAST(page_language AS VARCHAR(32)) AS page_language,
        CAST(geo_country AS VARCHAR(32)) AS country,
        CAST(geo_region AS VARCHAR(32)) AS region,
        CAST(geo_city AS VARCHAR(32)) AS city,
        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,
        CAST(search_model AS VARCHAR(32)) AS search_model,
        CAST(geo_timezone AS VARCHAR(32)) AS timezone,

        -- Extract product id from varchar string and cast to NUMBER
        
    IFF(
        product_id IS NULL OR TRIM(product_id) = '', 
        0, 
        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)
    )
 AS product_id, 

        -- Converting timestamp to
        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,
        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,
     

    from source

)

select * from staging_data
  );
[0m16:30:46.883656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:50.546002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.662 seconds
[0m16:30:50.551420 [debug] [Thread-1 (]: On model.brave_de_project.stg_user_journey_qu: Close
[0m16:30:50.651420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc6b81fa0>]}
[0m16:30:50.653208 [info ] [Thread-1 (]: 14 of 100 OK created sql view model PROJECT_TEST.stg_user_journey_qu ........... [[32mSUCCESS 1[0m in 3.79s]
[0m16:30:50.654938 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_journey_qu
[0m16:30:50.656206 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_inv_detail_qu
[0m16:30:50.657589 [info ] [Thread-1 (]: 4 of 100 START sql incremental model PROJECT_TEST.dim_inv_detail_qu ............ [RUN]
[0m16:30:50.659407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_journey_qu, now model.brave_de_project.dim_inv_detail_qu)
[0m16:30:50.660218 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_inv_detail_qu
[0m16:30:50.667756 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:50.668869 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_inv_detail_qu
[0m16:30:50.697717 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:50.698139 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu
),


inventory_data AS (
   SELECT
      md5(cast(coalesce(cast(storage_condition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(inventory_status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as inv_detail_id,
      storage_condition,
      inventory_status
      
   FROM source
   GROUP BY storage_condition, inventory_status
)


SELECT * FROM inventory_data
  );
[0m16:30:50.698517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:54.120636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.422 seconds
[0m16:30:54.128355 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.129563 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
[0m16:30:54.201687 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.071 seconds
[0m16:30:54.209988 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.211047 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
[0m16:30:54.282612 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.070 seconds
[0m16:30:54.300398 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.301167 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_INV_DETAIL_QU"
[0m16:30:54.371725 [debug] [Thread-1 (]: SQL status: SUCCESS 3 in 0.070 seconds
[0m16:30:54.414152 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.415216 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.415576 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:30:54.490329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m16:30:54.491523 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:54.492682 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.inv_detail_id = DBT_INTERNAL_DEST.inv_detail_id
            )

    
    when matched then update set
        "INV_DETAIL_ID" = DBT_INTERNAL_SOURCE."INV_DETAIL_ID","STORAGE_CONDITION" = DBT_INTERNAL_SOURCE."STORAGE_CONDITION","INVENTORY_STATUS" = DBT_INTERNAL_SOURCE."INVENTORY_STATUS"
    

    when not matched then insert
        ("INV_DETAIL_ID", "STORAGE_CONDITION", "INVENTORY_STATUS")
    values
        ("INV_DETAIL_ID", "STORAGE_CONDITION", "INVENTORY_STATUS")

;
[0m16:30:55.261418 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.767 seconds
[0m16:30:55.262843 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:55.263981 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
COMMIT
[0m16:30:55.505171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m16:30:55.517118 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp
[0m16:30:55.523029 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_inv_detail_qu"
[0m16:30:55.523813 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_inv_detail_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu__dbt_tmp cascade
[0m16:30:55.596508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m16:30:55.601168 [debug] [Thread-1 (]: On model.brave_de_project.dim_inv_detail_qu: Close
[0m16:30:55.705405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc6b05fa0>]}
[0m16:30:55.707187 [info ] [Thread-1 (]: 4 of 100 OK created sql incremental model PROJECT_TEST.dim_inv_detail_qu ....... [[32mSUCCESS 6[0m in 5.05s]
[0m16:30:55.708952 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_inv_detail_qu
[0m16:30:55.710213 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_product_qu
[0m16:30:55.711950 [info ] [Thread-1 (]: 7 of 100 START sql incremental model PROJECT_TEST.dim_product_qu ............... [RUN]
[0m16:30:55.713097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_inv_detail_qu, now model.brave_de_project.dim_product_qu)
[0m16:30:55.714025 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_product_qu
[0m16:30:55.720917 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_product_qu"
[0m16:30:55.721808 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_product_qu
[0m16:30:55.727655 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:55.728347 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu
),

product_data AS (
   SELECT
   
       product_id,
       product_name,
       product_category,
       product_color,
       supplier_id,
       manufacturing_date,
       expiration_date,
       warranty_period_months
   
   FROM source
)


SELECT * FROM product_data
  );
[0m16:30:55.728999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:59.003175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.274 seconds
[0m16:30:59.010929 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:59.012131 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
[0m16:30:59.071615 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.058 seconds
[0m16:30:59.080394 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:59.081311 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
[0m16:30:59.148696 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.066 seconds
[0m16:30:59.157434 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:59.158576 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_PRODUCT_QU"
[0m16:30:59.209703 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.050 seconds
[0m16:30:59.217094 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_product_qu"
[0m16:30:59.220426 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:59.221214 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:30:59.287232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m16:30:59.288461 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:30:59.289685 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_product_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_NAME" = DBT_INTERNAL_SOURCE."PRODUCT_NAME","PRODUCT_CATEGORY" = DBT_INTERNAL_SOURCE."PRODUCT_CATEGORY","PRODUCT_COLOR" = DBT_INTERNAL_SOURCE."PRODUCT_COLOR","SUPPLIER_ID" = DBT_INTERNAL_SOURCE."SUPPLIER_ID","MANUFACTURING_DATE" = DBT_INTERNAL_SOURCE."MANUFACTURING_DATE","EXPIRATION_DATE" = DBT_INTERNAL_SOURCE."EXPIRATION_DATE","WARRANTY_PERIOD_MONTHS" = DBT_INTERNAL_SOURCE."WARRANTY_PERIOD_MONTHS"
    

    when not matched then insert
        ("PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_CATEGORY", "PRODUCT_COLOR", "SUPPLIER_ID", "MANUFACTURING_DATE", "EXPIRATION_DATE", "WARRANTY_PERIOD_MONTHS")
    values
        ("PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_CATEGORY", "PRODUCT_COLOR", "SUPPLIER_ID", "MANUFACTURING_DATE", "EXPIRATION_DATE", "WARRANTY_PERIOD_MONTHS")

;
[0m16:31:00.507500 [debug] [Thread-1 (]: SQL status: SUCCESS 20000 in 1.216 seconds
[0m16:31:00.508951 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:31:00.510082 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
COMMIT
[0m16:31:00.755017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m16:31:00.763648 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp
[0m16:31:00.765749 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_product_qu"
[0m16:31:00.766825 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_product_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_product_qu__dbt_tmp cascade
[0m16:31:00.877696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m16:31:00.882399 [debug] [Thread-1 (]: On model.brave_de_project.dim_product_qu: Close
[0m16:31:00.993498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc6114290>]}
[0m16:31:00.995231 [info ] [Thread-1 (]: 7 of 100 OK created sql incremental model PROJECT_TEST.dim_product_qu .......... [[32mSUCCESS 20000[0m in 5.28s]
[0m16:31:00.996987 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_product_qu
[0m16:31:00.998254 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_user_qu
[0m16:31:01.000216 [info ] [Thread-1 (]: 12 of 100 START sql incremental model PROJECT_TEST.dim_user_qu ................. [RUN]
[0m16:31:01.001605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_product_qu, now model.brave_de_project.dim_user_qu)
[0m16:31:01.002731 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_user_qu
[0m16:31:01.009815 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_user_qu"
[0m16:31:01.010902 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_user_qu
[0m16:31:01.016793 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:01.017437 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
),


user_data AS (
   SELECT
      
      user_id,
      first_name,
      last_name,
      email,
      signup_date,
      preferred_language,
      dob,
      marketing_opt_in,
      account_status,
      loyalty_points_balance
   FROM source
   WHERE account_status = 'active'
)

SELECT * FROM user_data
  );
[0m16:31:01.017991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:04.720686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.702 seconds
[0m16:31:04.728364 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:04.729557 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
[0m16:31:04.808477 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m16:31:04.817667 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:04.818722 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
[0m16:31:04.901832 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.082 seconds
[0m16:31:04.911419 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:04.912567 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_USER_QU"
[0m16:31:04.998370 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.085 seconds
[0m16:31:05.006174 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_user_qu"
[0m16:31:05.008865 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:05.009757 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:31:05.114573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m16:31:05.115734 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:05.116949 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_user_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
            )

    
    when matched then update set
        "USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","EMAIL" = DBT_INTERNAL_SOURCE."EMAIL","SIGNUP_DATE" = DBT_INTERNAL_SOURCE."SIGNUP_DATE","PREFERRED_LANGUAGE" = DBT_INTERNAL_SOURCE."PREFERRED_LANGUAGE","DOB" = DBT_INTERNAL_SOURCE."DOB","MARKETING_OPT_IN" = DBT_INTERNAL_SOURCE."MARKETING_OPT_IN","ACCOUNT_STATUS" = DBT_INTERNAL_SOURCE."ACCOUNT_STATUS","LOYALTY_POINTS_BALANCE" = DBT_INTERNAL_SOURCE."LOYALTY_POINTS_BALANCE"
    

    when not matched then insert
        ("USER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "SIGNUP_DATE", "PREFERRED_LANGUAGE", "DOB", "MARKETING_OPT_IN", "ACCOUNT_STATUS", "LOYALTY_POINTS_BALANCE")
    values
        ("USER_ID", "FIRST_NAME", "LAST_NAME", "EMAIL", "SIGNUP_DATE", "PREFERRED_LANGUAGE", "DOB", "MARKETING_OPT_IN", "ACCOUNT_STATUS", "LOYALTY_POINTS_BALANCE")

;
[0m16:31:06.075077 [debug] [Thread-1 (]: SQL status: SUCCESS 3089 in 0.957 seconds
[0m16:31:06.076460 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:06.077554 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
COMMIT
[0m16:31:06.249218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m16:31:06.261408 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp
[0m16:31:06.263646 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_user_qu"
[0m16:31:06.264787 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_user_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_user_qu__dbt_tmp cascade
[0m16:31:06.341244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:31:06.345815 [debug] [Thread-1 (]: On model.brave_de_project.dim_user_qu: Close
[0m16:31:06.442666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de3394a40>]}
[0m16:31:06.444367 [info ] [Thread-1 (]: 12 of 100 OK created sql incremental model PROJECT_TEST.dim_user_qu ............ [[32mSUCCESS 3089[0m in 5.44s]
[0m16:31:06.446429 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_user_qu
[0m16:31:06.447928 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_campaign_qu
[0m16:31:06.449753 [info ] [Thread-1 (]: 15 of 100 START sql incremental model PROJECT_TEST.dim_campaign_qu ............. [RUN]
[0m16:31:06.451340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_user_qu, now model.brave_de_project.dim_campaign_qu)
[0m16:31:06.452509 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_campaign_qu
[0m16:31:06.463776 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_campaign_qu"
[0m16:31:06.465179 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_campaign_qu
[0m16:31:06.473975 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:06.475218 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

campaign_data AS (
   SELECT
      --ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS campaign_id,
      md5(cast(coalesce(cast(campaign_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(medium as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(content as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS campaign_id,
      campaign_name,
      medium,
      source,
      content
     
   FROM source
   GROUP BY campaign_name, medium, source, content
)

SELECT * FROM campaign_data
  );
[0m16:31:06.476370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:09.468955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.992 seconds
[0m16:31:09.476707 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.477891 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
[0m16:31:09.544453 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m16:31:09.553336 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.554500 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
[0m16:31:09.654919 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.099 seconds
[0m16:31:09.663325 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.664482 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_CAMPAIGN_QU"
[0m16:31:09.752544 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.087 seconds
[0m16:31:09.759164 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.761745 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.762611 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:31:09.841003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m16:31:09.842173 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:09.843350 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.campaign_id = DBT_INTERNAL_DEST.campaign_id
            )

    
    when matched then update set
        "CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","CAMPAIGN_NAME" = DBT_INTERNAL_SOURCE."CAMPAIGN_NAME","MEDIUM" = DBT_INTERNAL_SOURCE."MEDIUM","SOURCE" = DBT_INTERNAL_SOURCE."SOURCE","CONTENT" = DBT_INTERNAL_SOURCE."CONTENT"
    

    when not matched then insert
        ("CAMPAIGN_ID", "CAMPAIGN_NAME", "MEDIUM", "SOURCE", "CONTENT")
    values
        ("CAMPAIGN_ID", "CAMPAIGN_NAME", "MEDIUM", "SOURCE", "CONTENT")

;
[0m16:31:10.798461 [debug] [Thread-1 (]: SQL status: SUCCESS 256 in 0.954 seconds
[0m16:31:10.799842 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:10.800947 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
COMMIT
[0m16:31:11.031054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m16:31:11.042326 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp
[0m16:31:11.043899 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_campaign_qu"
[0m16:31:11.044708 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_campaign_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu__dbt_tmp cascade
[0m16:31:11.120478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:31:11.124968 [debug] [Thread-1 (]: On model.brave_de_project.dim_campaign_qu: Close
[0m16:31:11.571938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc6179af0>]}
[0m16:31:11.573673 [info ] [Thread-1 (]: 15 of 100 OK created sql incremental model PROJECT_TEST.dim_campaign_qu ........ [[32mSUCCESS 256[0m in 5.12s]
[0m16:31:11.575477 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_campaign_qu
[0m16:31:11.576723 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_location_qu
[0m16:31:11.578339 [info ] [Thread-1 (]: 16 of 100 START sql incremental model PROJECT_TEST.dim_search_location_qu ...... [RUN]
[0m16:31:11.580235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_campaign_qu, now model.brave_de_project.dim_search_location_qu)
[0m16:31:11.581466 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_location_qu
[0m16:31:11.590334 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_location_qu"
[0m16:31:11.591410 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_location_qu
[0m16:31:11.597349 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:11.597979 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

search_location_data AS (
   SELECT
       
      md5(cast(coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(city as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(region as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id, 
      country,
      city,
      region,
      zipcode

   FROM source
   GROUP BY city, country, region, zipcode
)

select * from search_location_data
  );
[0m16:31:11.598551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:15.085503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.487 seconds
[0m16:31:15.093251 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.094432 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
[0m16:31:15.173965 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.079 seconds
[0m16:31:15.182931 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.184086 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
[0m16:31:15.305875 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.121 seconds
[0m16:31:15.314315 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.315484 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_SEARCH_LOCATION_QU"
[0m16:31:15.371355 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.055 seconds
[0m16:31:15.378015 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.381045 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.382194 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:31:15.493541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m16:31:15.494712 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:15.495891 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.location_id = DBT_INTERNAL_DEST.location_id
            )

    
    when matched then update set
        "LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","CITY" = DBT_INTERNAL_SOURCE."CITY","REGION" = DBT_INTERNAL_SOURCE."REGION","ZIPCODE" = DBT_INTERNAL_SOURCE."ZIPCODE"
    

    when not matched then insert
        ("LOCATION_ID", "COUNTRY", "CITY", "REGION", "ZIPCODE")
    values
        ("LOCATION_ID", "COUNTRY", "CITY", "REGION", "ZIPCODE")

;
[0m16:31:16.947272 [debug] [Thread-1 (]: SQL status: SUCCESS 141519 in 1.450 seconds
[0m16:31:16.948690 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:16.949812 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
COMMIT
[0m16:31:17.157064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m16:31:17.169169 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp
[0m16:31:17.170899 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_location_qu"
[0m16:31:17.171688 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_location_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu__dbt_tmp cascade
[0m16:31:17.240409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m16:31:17.244988 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_location_qu: Close
[0m16:31:17.345053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc618f6b0>]}
[0m16:31:17.346862 [info ] [Thread-1 (]: 16 of 100 OK created sql incremental model PROJECT_TEST.dim_search_location_qu . [[32mSUCCESS 141519[0m in 5.76s]
[0m16:31:17.348658 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_location_qu
[0m16:31:17.349917 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_qu
[0m16:31:17.351531 [info ] [Thread-1 (]: 17 of 100 START sql incremental model PROJECT_TEST.dim_search_qu ............... [RUN]
[0m16:31:17.352878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_location_qu, now model.brave_de_project.dim_search_qu)
[0m16:31:17.353698 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_qu
[0m16:31:17.361341 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_qu"
[0m16:31:17.362332 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_qu
[0m16:31:17.367342 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:17.367963 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
  
  copy grants as (
    

with source as (

   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu

),

search_data AS (
   SELECT
      
     md5(cast(coalesce(cast(search_model as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_feature as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_terms_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as search_data_id,
      search_model,  
      search_type,
      search_feature,
      search_terms_type
        
   FROM source
   GROUP BY search_model, 
            search_type, 
            search_feature, 
            search_terms_type
)


SELECT * FROM search_data
  );
[0m16:31:17.368524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:20.477090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.108 seconds
[0m16:31:20.484769 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:20.485948 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
[0m16:31:20.563208 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.076 seconds
[0m16:31:20.571795 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:20.572859 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
[0m16:31:20.647866 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.074 seconds
[0m16:31:20.656252 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:20.657424 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."DIM_SEARCH_QU"
[0m16:31:20.747153 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.089 seconds
[0m16:31:20.753812 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.dim_search_qu"
[0m16:31:20.756893 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:20.758017 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:31:20.854169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m16:31:20.855326 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:20.856519 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.dim_search_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.search_data_id = DBT_INTERNAL_DEST.search_data_id
            )

    
    when matched then update set
        "SEARCH_DATA_ID" = DBT_INTERNAL_SOURCE."SEARCH_DATA_ID","SEARCH_MODEL" = DBT_INTERNAL_SOURCE."SEARCH_MODEL","SEARCH_TYPE" = DBT_INTERNAL_SOURCE."SEARCH_TYPE","SEARCH_FEATURE" = DBT_INTERNAL_SOURCE."SEARCH_FEATURE","SEARCH_TERMS_TYPE" = DBT_INTERNAL_SOURCE."SEARCH_TERMS_TYPE"
    

    when not matched then insert
        ("SEARCH_DATA_ID", "SEARCH_MODEL", "SEARCH_TYPE", "SEARCH_FEATURE", "SEARCH_TERMS_TYPE")
    values
        ("SEARCH_DATA_ID", "SEARCH_MODEL", "SEARCH_TYPE", "SEARCH_FEATURE", "SEARCH_TERMS_TYPE")

;
[0m16:31:21.638556 [debug] [Thread-1 (]: SQL status: SUCCESS 72 in 0.781 seconds
[0m16:31:21.639940 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:21.641056 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
COMMIT
[0m16:31:21.864696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m16:31:21.876271 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp
[0m16:31:21.878491 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.dim_search_qu"
[0m16:31:21.879499 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.dim_search_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.dim_search_qu__dbt_tmp cascade
[0m16:31:21.968095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m16:31:21.972610 [debug] [Thread-1 (]: On model.brave_de_project.dim_search_qu: Close
[0m16:31:22.067166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddb52c500>]}
[0m16:31:22.068910 [info ] [Thread-1 (]: 17 of 100 OK created sql incremental model PROJECT_TEST.dim_search_qu .......... [[32mSUCCESS 72[0m in 4.71s]
[0m16:31:22.070637 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_qu
[0m16:31:22.071839 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:31:22.073185 [info ] [Thread-1 (]: 18 of 100 START test accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered  [RUN]
[0m16:31:22.074708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_qu, now test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8)
[0m16:31:22.075824 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:31:22.088126 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"
[0m16:31:22.089694 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:31:22.118739 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"
[0m16:31:22.120118 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"
[0m16:31:22.120748 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        inventory_status as value_field,
        count(*) as n_records

    from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
    group by inventory_status

)

select *
from all_values
where value_field not in (
    'in-stock','backordered'
)



      
    ) dbt_internal_test
[0m16:31:22.121232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:25.204727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.083 seconds
[0m16:31:25.213686 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8: Close
[0m16:31:25.306686 [info ] [Thread-1 (]: 18 of 100 PASS accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered  [[32mPASS[0m in 3.23s]
[0m16:31:25.308520 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:31:25.309776 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:31:25.311107 [info ] [Thread-1 (]: 19 of 100 START test not_null_dim_inv_detail_qu_inv_detail_id .................. [RUN]
[0m16:31:25.312405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8, now test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620)
[0m16:31:25.313520 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:31:25.330064 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"
[0m16:31:25.331102 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:31:25.335673 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"
[0m16:31:25.337191 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"
[0m16:31:25.337829 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inv_detail_id
from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
where inv_detail_id is null



      
    ) dbt_internal_test
[0m16:31:25.338350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:29.928501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.590 seconds
[0m16:31:29.933405 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620: Close
[0m16:31:30.030042 [info ] [Thread-1 (]: 19 of 100 PASS not_null_dim_inv_detail_qu_inv_detail_id ........................ [[32mPASS[0m in 4.72s]
[0m16:31:30.031838 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:31:30.033201 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:31:30.034570 [info ] [Thread-1 (]: 20 of 100 START test not_null_dim_inv_detail_qu_inventory_status ............... [RUN]
[0m16:31:30.035801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620, now test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e)
[0m16:31:30.036749 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:31:30.045525 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"
[0m16:31:30.046395 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:31:30.170177 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"
[0m16:31:30.170945 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"
[0m16:31:30.171285 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_status
from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
where inventory_status is null



      
    ) dbt_internal_test
[0m16:31:30.171592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:34.123763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.952 seconds
[0m16:31:34.128603 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e: Close
[0m16:31:34.230038 [info ] [Thread-1 (]: 20 of 100 PASS not_null_dim_inv_detail_qu_inventory_status ..................... [[32mPASS[0m in 4.19s]
[0m16:31:34.231835 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:31:34.233078 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:31:34.234452 [info ] [Thread-1 (]: 21 of 100 START test not_null_dim_inv_detail_qu_storage_condition .............. [RUN]
[0m16:31:34.235747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e, now test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc)
[0m16:31:34.236918 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:31:34.244629 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"
[0m16:31:34.245228 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:31:34.247736 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"
[0m16:31:34.248538 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"
[0m16:31:34.248962 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select storage_condition
from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
where storage_condition is null



      
    ) dbt_internal_test
[0m16:31:34.249356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:37.942417 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.693 seconds
[0m16:31:37.947134 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc: Close
[0m16:31:38.046422 [info ] [Thread-1 (]: 21 of 100 PASS not_null_dim_inv_detail_qu_storage_condition .................... [[32mPASS[0m in 3.81s]
[0m16:31:38.048142 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:31:38.049402 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:31:38.050710 [info ] [Thread-1 (]: 22 of 100 START test unique_dim_inv_detail_qu_inv_detail_id .................... [RUN]
[0m16:31:38.051950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc, now test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8)
[0m16:31:38.053066 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:31:38.065061 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"
[0m16:31:38.065853 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:31:38.069164 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"
[0m16:31:38.070312 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"
[0m16:31:38.070900 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    inv_detail_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
where inv_detail_id is not null
group by inv_detail_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:31:38.071428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:41.903231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.832 seconds
[0m16:31:41.907979 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8: Close
[0m16:31:42.004593 [info ] [Thread-1 (]: 22 of 100 PASS unique_dim_inv_detail_qu_inv_detail_id .......................... [[32mPASS[0m in 3.95s]
[0m16:31:42.006399 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:31:42.007659 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:31:42.009001 [info ] [Thread-1 (]: 23 of 100 START test not_null_dim_product_qu_product_id ........................ [RUN]
[0m16:31:42.010524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8, now test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53)
[0m16:31:42.011476 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:31:42.019582 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"
[0m16:31:42.020622 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:31:42.026224 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"
[0m16:31:42.027326 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"
[0m16:31:42.027937 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
where product_id is null



      
    ) dbt_internal_test
[0m16:31:42.028466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:46.304978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.276 seconds
[0m16:31:46.309730 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53: Close
[0m16:31:46.394969 [info ] [Thread-1 (]: 23 of 100 PASS not_null_dim_product_qu_product_id .............................. [[32mPASS[0m in 4.38s]
[0m16:31:46.397027 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:31:46.398352 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:31:46.399657 [info ] [Thread-1 (]: 24 of 100 START test not_null_dim_product_qu_product_name ...................... [RUN]
[0m16:31:46.400915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53, now test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8)
[0m16:31:46.402026 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:31:46.413193 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"
[0m16:31:46.414630 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:31:46.420902 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"
[0m16:31:46.422939 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"
[0m16:31:46.423711 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_name
from BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
where product_name is null



      
    ) dbt_internal_test
[0m16:31:46.424425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:50.433996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.009 seconds
[0m16:31:50.438789 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8: Close
[0m16:31:50.529098 [info ] [Thread-1 (]: 24 of 100 PASS not_null_dim_product_qu_product_name ............................ [[32mPASS[0m in 4.13s]
[0m16:31:50.530837 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:31:50.532083 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:31:50.533424 [info ] [Thread-1 (]: 25 of 100 START test not_null_dim_product_qu_supplier_id ....................... [RUN]
[0m16:31:50.534668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8, now test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514)
[0m16:31:50.535800 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:31:50.544766 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"
[0m16:31:50.545801 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:31:50.550266 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"
[0m16:31:50.551340 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"
[0m16:31:50.551921 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
where supplier_id is null



      
    ) dbt_internal_test
[0m16:31:50.552444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:54.629272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.077 seconds
[0m16:31:54.634031 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514: Close
[0m16:31:54.715275 [info ] [Thread-1 (]: 25 of 100 PASS not_null_dim_product_qu_supplier_id ............................. [[32mPASS[0m in 4.18s]
[0m16:31:54.717015 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:31:54.718241 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_product_dates
[0m16:31:54.719372 [info ] [Thread-1 (]: 26 of 100 START test test_product_dates ........................................ [RUN]
[0m16:31:54.720508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514, now test.brave_de_project.test_product_dates)
[0m16:31:54.721471 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_product_dates
[0m16:31:54.728261 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_product_dates"
[0m16:31:54.729258 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_product_dates
[0m16:31:54.735855 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_product_dates"
[0m16:31:54.737293 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_product_dates"
[0m16:31:54.738016 [debug] [Thread-1 (]: On test.brave_de_project.test_product_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_product_dates"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test: Test that the manufacturing date is before the expiration date

SELECT
    COUNT(*) AS invalid_rows
FROM
    BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
WHERE
    manufacturing_date > expiration_date
HAVING
    invalid_rows > 0
      
    ) dbt_internal_test
[0m16:31:54.738684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:58.832933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.094 seconds
[0m16:31:58.837697 [debug] [Thread-1 (]: On test.brave_de_project.test_product_dates: Close
[0m16:31:58.963666 [info ] [Thread-1 (]: 26 of 100 PASS test_product_dates .............................................. [[32mPASS[0m in 4.24s]
[0m16:31:58.965500 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_product_dates
[0m16:31:58.966758 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:31:58.968042 [info ] [Thread-1 (]: 27 of 100 START test unique_dim_product_qu_product_id .......................... [RUN]
[0m16:31:58.969349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_product_dates, now test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e)
[0m16:31:58.970292 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:31:58.978175 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"
[0m16:31:58.979210 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:31:58.982994 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"
[0m16:31:58.984218 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"
[0m16:31:58.984810 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_product_qu
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:31:58.985323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:03.217910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.232 seconds
[0m16:32:03.222634 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e: Close
[0m16:32:03.324711 [info ] [Thread-1 (]: 27 of 100 PASS unique_dim_product_qu_product_id ................................ [[32mPASS[0m in 4.35s]
[0m16:32:03.326474 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:32:03.328867 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:32:03.330187 [info ] [Thread-1 (]: 28 of 100 START test accepted_values_dim_user_qu_account_status__active__in_active__suspended  [RUN]
[0m16:32:03.331229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e, now test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d)
[0m16:32:03.332034 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:32:03.340424 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"
[0m16:32:03.341299 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:32:03.344747 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"
[0m16:32:03.345998 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"
[0m16:32:03.346609 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        account_status as value_field,
        count(*) as n_records

    from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
    group by account_status

)

select *
from all_values
where value_field not in (
    'active','in-active','suspended'
)



      
    ) dbt_internal_test
[0m16:32:03.347176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:07.319043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.972 seconds
[0m16:32:07.323881 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d: Close
[0m16:32:07.445320 [info ] [Thread-1 (]: 28 of 100 PASS accepted_values_dim_user_qu_account_status__active__in_active__suspended  [[32mPASS[0m in 4.11s]
[0m16:32:07.447069 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:32:07.448324 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:32:07.449637 [info ] [Thread-1 (]: 29 of 100 START test not_null_dim_user_qu_marketing_opt_in ..................... [RUN]
[0m16:32:07.450786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d, now test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459)
[0m16:32:07.451723 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:32:07.460402 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"
[0m16:32:07.461459 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:32:07.467172 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"
[0m16:32:07.468328 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"
[0m16:32:07.468939 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select marketing_opt_in
from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
where marketing_opt_in is null



      
    ) dbt_internal_test
[0m16:32:07.469500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:11.217531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.748 seconds
[0m16:32:11.222302 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459: Close
[0m16:32:11.335504 [info ] [Thread-1 (]: 29 of 100 PASS not_null_dim_user_qu_marketing_opt_in ........................... [[32mPASS[0m in 3.88s]
[0m16:32:11.337246 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:32:11.338529 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:32:11.339832 [info ] [Thread-1 (]: 30 of 100 START test not_null_dim_user_qu_user_id .............................. [RUN]
[0m16:32:11.341083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459, now test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9)
[0m16:32:11.342223 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:32:11.351634 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"
[0m16:32:11.352684 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:32:11.357454 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"
[0m16:32:11.358639 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"
[0m16:32:11.359203 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
where user_id is null



      
    ) dbt_internal_test
[0m16:32:11.359736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:15.411214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.051 seconds
[0m16:32:15.416160 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9: Close
[0m16:32:15.513893 [info ] [Thread-1 (]: 30 of 100 PASS not_null_dim_user_qu_user_id .................................... [[32mPASS[0m in 4.17s]
[0m16:32:15.515649 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:32:15.516913 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_user_data
[0m16:32:15.518192 [info ] [Thread-1 (]: 31 of 100 START test test_user_data ............................................ [RUN]
[0m16:32:15.519453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9, now test.brave_de_project.test_user_data)
[0m16:32:15.520567 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_user_data
[0m16:32:15.527513 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_user_data"
[0m16:32:15.528519 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_user_data
[0m16:32:15.533213 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_user_data"
[0m16:32:15.534996 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_user_data"
[0m16:32:15.535597 [debug] [Thread-1 (]: On test.brave_de_project.test_user_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_user_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test: test_user_data
-- Description: This test checks if the account_status in the dim_user_qu table is 'active',
-- if the email in the dim_user_qu table is a valid email address, and if the loyalty_points_balance
-- in the dim_user_qu table is greater than or equal to 0.
SELECT
    COUNT(*) AS invalid_rows
FROM
    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
WHERE
    account_status != 'active'
    OR NOT REGEXP_LIKE(email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$')
    OR loyalty_points_balance < 0
HAVING
    invalid_rows > 0
      
    ) dbt_internal_test
[0m16:32:15.536132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:19.639405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.103 seconds
[0m16:32:19.644124 [debug] [Thread-1 (]: On test.brave_de_project.test_user_data: Close
[0m16:32:19.775926 [info ] [Thread-1 (]: 31 of 100 PASS test_user_data .................................................. [[32mPASS[0m in 4.26s]
[0m16:32:19.777556 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_user_data
[0m16:32:19.778569 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:32:19.779937 [info ] [Thread-1 (]: 32 of 100 START test unique_dim_user_qu_user_id ................................ [RUN]
[0m16:32:19.781200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_user_data, now test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc)
[0m16:32:19.782219 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:32:19.788987 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"
[0m16:32:19.789909 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:32:19.795297 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"
[0m16:32:19.796219 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"
[0m16:32:19.796699 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:32:19.797097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:23.490707 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.693 seconds
[0m16:32:23.495525 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc: Close
[0m16:32:23.597398 [info ] [Thread-1 (]: 32 of 100 PASS unique_dim_user_qu_user_id ...................................... [[32mPASS[0m in 3.82s]
[0m16:32:23.599157 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:32:23.600430 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:32:23.601729 [info ] [Thread-1 (]: 33 of 100 START test not_null_dim_campaign_qu_campaign_id ...................... [RUN]
[0m16:32:23.602984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc, now test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2)
[0m16:32:23.604114 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:32:23.612942 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"
[0m16:32:23.613992 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:32:23.618558 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"
[0m16:32:23.619650 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"
[0m16:32:23.620221 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select campaign_id
from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where campaign_id is null



      
    ) dbt_internal_test
[0m16:32:23.620771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:27.552050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.931 seconds
[0m16:32:27.556889 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2: Close
[0m16:32:27.653496 [info ] [Thread-1 (]: 33 of 100 PASS not_null_dim_campaign_qu_campaign_id ............................ [[32mPASS[0m in 4.05s]
[0m16:32:27.655233 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:32:27.656517 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:32:27.657814 [info ] [Thread-1 (]: 34 of 100 START test not_null_dim_campaign_qu_campaign_name .................... [RUN]
[0m16:32:27.659082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2, now test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672)
[0m16:32:27.660207 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:32:27.669197 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"
[0m16:32:27.670246 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:32:27.674799 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"
[0m16:32:27.675900 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"
[0m16:32:27.676488 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select campaign_name
from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where campaign_name is null



      
    ) dbt_internal_test
[0m16:32:27.677009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:31.643628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.966 seconds
[0m16:32:31.648465 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672: Close
[0m16:32:31.741459 [info ] [Thread-1 (]: 34 of 100 PASS not_null_dim_campaign_qu_campaign_name .......................... [[32mPASS[0m in 4.08s]
[0m16:32:31.743188 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:32:31.744451 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:32:31.745755 [info ] [Thread-1 (]: 35 of 100 START test not_null_dim_campaign_qu_content .......................... [RUN]
[0m16:32:31.746999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672, now test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892)
[0m16:32:31.748114 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:32:31.756407 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"
[0m16:32:31.757448 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:32:31.763516 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"
[0m16:32:31.764604 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"
[0m16:32:31.765170 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select content
from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where content is null



      
    ) dbt_internal_test
[0m16:32:31.765706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:35.588402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.822 seconds
[0m16:32:35.592959 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892: Close
[0m16:32:35.685501 [info ] [Thread-1 (]: 35 of 100 PASS not_null_dim_campaign_qu_content ................................ [[32mPASS[0m in 3.94s]
[0m16:32:35.687300 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:32:35.688592 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:32:35.689908 [info ] [Thread-1 (]: 36 of 100 START test not_null_dim_campaign_qu_medium ........................... [RUN]
[0m16:32:35.691165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892, now test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b)
[0m16:32:35.692292 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:32:35.700690 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"
[0m16:32:35.701748 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:32:35.705834 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"
[0m16:32:35.706918 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"
[0m16:32:35.707506 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medium
from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where medium is null



      
    ) dbt_internal_test
[0m16:32:35.708026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:39.837510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.129 seconds
[0m16:32:39.839832 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b: Close
[0m16:32:39.980140 [info ] [Thread-1 (]: 36 of 100 PASS not_null_dim_campaign_qu_medium ................................. [[32mPASS[0m in 4.29s]
[0m16:32:39.981913 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:32:39.983164 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:32:39.984490 [info ] [Thread-1 (]: 37 of 100 START test not_null_dim_campaign_qu_source ........................... [RUN]
[0m16:32:39.985745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b, now test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5)
[0m16:32:39.986862 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:32:39.995408 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"
[0m16:32:39.996443 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:32:40.000613 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"
[0m16:32:40.001682 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"
[0m16:32:40.002242 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select source
from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where source is null



      
    ) dbt_internal_test
[0m16:32:40.002770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:43.697816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.695 seconds
[0m16:32:43.702569 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5: Close
[0m16:32:43.810216 [info ] [Thread-1 (]: 37 of 100 PASS not_null_dim_campaign_qu_source ................................. [[32mPASS[0m in 3.82s]
[0m16:32:43.812021 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:32:43.813270 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_campagin_combinations
[0m16:32:43.814589 [info ] [Thread-1 (]: 38 of 100 START test test_campagin_combinations ................................ [RUN]
[0m16:32:43.815859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5, now test.brave_de_project.test_campagin_combinations)
[0m16:32:43.817456 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_campagin_combinations
[0m16:32:43.827134 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_campagin_combinations"
[0m16:32:43.828610 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_campagin_combinations
[0m16:32:43.837569 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_campagin_combinations"
[0m16:32:43.839260 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_campagin_combinations"
[0m16:32:43.840149 [debug] [Thread-1 (]: On test.brave_de_project.test_campagin_combinations: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_campagin_combinations"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- checking for all combinations of fields are unique
SELECT
    campaign_name,
    medium,
    source,
    content,
    COUNT(*) AS count
FROM
    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
GROUP BY
    campaign_name,
    medium,
    source,
    content
HAVING
   count > 1
      
    ) dbt_internal_test
[0m16:32:43.840858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:47.679399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.838 seconds
[0m16:32:47.684146 [debug] [Thread-1 (]: On test.brave_de_project.test_campagin_combinations: Close
[0m16:32:47.786139 [info ] [Thread-1 (]: 38 of 100 PASS test_campagin_combinations ...................................... [[32mPASS[0m in 3.97s]
[0m16:32:47.787886 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_campagin_combinations
[0m16:32:47.789149 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:32:47.790489 [info ] [Thread-1 (]: 39 of 100 START test unique_dim_campaign_qu_campaign_id ........................ [RUN]
[0m16:32:47.791746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_campagin_combinations, now test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2)
[0m16:32:47.793232 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:32:47.804095 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"
[0m16:32:47.805552 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:32:47.811110 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"
[0m16:32:47.812760 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"
[0m16:32:47.813579 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    campaign_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
where campaign_id is not null
group by campaign_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:32:47.814319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:51.554346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.740 seconds
[0m16:32:51.559131 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2: Close
[0m16:32:51.654662 [info ] [Thread-1 (]: 39 of 100 PASS unique_dim_campaign_qu_campaign_id .............................. [[32mPASS[0m in 3.86s]
[0m16:32:51.656439 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:32:51.657693 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:32:51.659032 [info ] [Thread-1 (]: 40 of 100 START test not_null_dim_search_location_qu_city ...................... [RUN]
[0m16:32:51.660560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2, now test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42)
[0m16:32:51.661693 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:32:51.669742 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"
[0m16:32:51.670802 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:32:51.674652 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"
[0m16:32:51.675738 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"
[0m16:32:51.676300 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select city
from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where city is null



      
    ) dbt_internal_test
[0m16:32:51.676846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:55.541650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.864 seconds
[0m16:32:55.589137 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42: Close
[0m16:32:55.682926 [info ] [Thread-1 (]: 40 of 100 PASS not_null_dim_search_location_qu_city ............................ [[32mPASS[0m in 4.02s]
[0m16:32:55.684800 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:32:55.686050 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:32:55.687544 [info ] [Thread-1 (]: 41 of 100 START test not_null_dim_search_location_qu_country ................... [RUN]
[0m16:32:55.688748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42, now test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af)
[0m16:32:55.689569 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:32:55.697389 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"
[0m16:32:55.698370 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:32:55.703958 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"
[0m16:32:55.705011 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"
[0m16:32:55.705577 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select country
from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where country is null



      
    ) dbt_internal_test
[0m16:32:55.706119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.528160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.822 seconds
[0m16:32:59.532962 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af: Close
[0m16:32:59.638306 [info ] [Thread-1 (]: 41 of 100 PASS not_null_dim_search_location_qu_country ......................... [[32mPASS[0m in 3.95s]
[0m16:32:59.640063 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:32:59.641323 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:32:59.642684 [info ] [Thread-1 (]: 42 of 100 START test not_null_dim_search_location_qu_location_id ............... [RUN]
[0m16:32:59.643963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af, now test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee)
[0m16:32:59.645094 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:32:59.654629 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"
[0m16:32:59.655679 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:32:59.660304 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"
[0m16:32:59.661727 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"
[0m16:32:59.662332 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_id
from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where location_id is null



      
    ) dbt_internal_test
[0m16:32:59.662899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:03.759463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.096 seconds
[0m16:33:03.764233 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee: Close
[0m16:33:03.896918 [info ] [Thread-1 (]: 42 of 100 PASS not_null_dim_search_location_qu_location_id ..................... [[32mPASS[0m in 4.25s]
[0m16:33:03.898682 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:33:03.899941 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:33:03.901255 [info ] [Thread-1 (]: 43 of 100 START test not_null_dim_search_location_qu_region .................... [RUN]
[0m16:33:03.902555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee, now test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6)
[0m16:33:03.903667 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:33:03.911829 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"
[0m16:33:03.912877 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:33:03.917051 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"
[0m16:33:03.918190 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"
[0m16:33:03.918788 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where region is null



      
    ) dbt_internal_test
[0m16:33:03.919309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:07.934931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.015 seconds
[0m16:33:07.939716 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6: Close
[0m16:33:08.026175 [info ] [Thread-1 (]: 43 of 100 PASS not_null_dim_search_location_qu_region .......................... [[32mPASS[0m in 4.12s]
[0m16:33:08.027957 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:33:08.029220 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:33:08.030489 [info ] [Thread-1 (]: 44 of 100 START test not_null_dim_search_location_qu_zipcode ................... [RUN]
[0m16:33:08.031610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6, now test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6)
[0m16:33:08.032675 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:33:08.041678 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"
[0m16:33:08.042603 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:33:08.049193 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"
[0m16:33:08.050345 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"
[0m16:33:08.050864 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zipcode
from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where zipcode is null



      
    ) dbt_internal_test
[0m16:33:08.051309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:11.955486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.904 seconds
[0m16:33:11.960268 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6: Close
[0m16:33:12.059912 [info ] [Thread-1 (]: 44 of 100 PASS not_null_dim_search_location_qu_zipcode ......................... [[32mPASS[0m in 4.03s]
[0m16:33:12.061687 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:33:12.062957 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:33:12.064195 [info ] [Thread-1 (]: 45 of 100 START test unique_dim_search_location_qu_location_id ................. [RUN]
[0m16:33:12.065306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6, now test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be)
[0m16:33:12.066284 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:33:12.075036 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"
[0m16:33:12.075963 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:33:12.080047 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"
[0m16:33:12.081549 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"
[0m16:33:12.082257 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    location_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
where location_id is not null
group by location_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:33:12.082924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:15.995919 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.913 seconds
[0m16:33:16.066515 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be: Close
[0m16:33:16.156849 [info ] [Thread-1 (]: 45 of 100 PASS unique_dim_search_location_qu_location_id ....................... [[32mPASS[0m in 4.09s]
[0m16:33:16.158569 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:33:16.159779 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:33:16.160845 [info ] [Thread-1 (]: 46 of 100 START test accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead  [RUN]
[0m16:33:16.162157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be, now test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1)
[0m16:33:16.163222 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:33:16.171740 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"
[0m16:33:16.172745 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:33:16.176881 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"
[0m16:33:16.178051 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"
[0m16:33:16.178622 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        search_terms_type as value_field,
        count(*) as n_records

    from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
    group by search_terms_type

)

select *
from all_values
where value_field not in (
    'manual-search','type-ahead'
)



      
    ) dbt_internal_test
[0m16:33:16.179118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:20.330066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.151 seconds
[0m16:33:20.334849 [debug] [Thread-1 (]: On test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1: Close
[0m16:33:20.422165 [info ] [Thread-1 (]: 46 of 100 PASS accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead  [[32mPASS[0m in 4.26s]
[0m16:33:20.423953 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:33:20.425217 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:33:20.426557 [info ] [Thread-1 (]: 47 of 100 START test not_null_dim_search_qu_search_data_id ..................... [RUN]
[0m16:33:20.427824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1, now test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22)
[0m16:33:20.428955 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:33:20.437749 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"
[0m16:33:20.438806 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:33:20.445393 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"
[0m16:33:20.446493 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"
[0m16:33:20.447074 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_data_id
from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
where search_data_id is null



      
    ) dbt_internal_test
[0m16:33:20.447618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:24.176289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.728 seconds
[0m16:33:24.181099 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22: Close
[0m16:33:24.273138 [info ] [Thread-1 (]: 47 of 100 PASS not_null_dim_search_qu_search_data_id ........................... [[32mPASS[0m in 3.84s]
[0m16:33:24.274923 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:33:24.276183 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:33:24.277516 [info ] [Thread-1 (]: 48 of 100 START test not_null_dim_search_qu_search_feature ..................... [RUN]
[0m16:33:24.278630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22, now test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df)
[0m16:33:24.279610 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:33:24.288517 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"
[0m16:33:24.289458 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:33:24.293581 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"
[0m16:33:24.294948 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"
[0m16:33:24.295668 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_feature
from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
where search_feature is null



      
    ) dbt_internal_test
[0m16:33:24.296323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:28.037059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.740 seconds
[0m16:33:28.042089 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df: Close
[0m16:33:28.154691 [info ] [Thread-1 (]: 48 of 100 PASS not_null_dim_search_qu_search_feature ........................... [[32mPASS[0m in 3.87s]
[0m16:33:28.156446 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:33:28.157720 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:33:28.158983 [info ] [Thread-1 (]: 49 of 100 START test not_null_dim_search_qu_search_model ....................... [RUN]
[0m16:33:28.160097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df, now test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df)
[0m16:33:28.161071 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:33:28.169973 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"
[0m16:33:28.170905 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:33:28.174966 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"
[0m16:33:28.176308 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"
[0m16:33:28.177021 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_model
from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
where search_model is null



      
    ) dbt_internal_test
[0m16:33:28.177677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:31.850217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.672 seconds
[0m16:33:31.855035 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df: Close
[0m16:33:31.970524 [info ] [Thread-1 (]: 49 of 100 PASS not_null_dim_search_qu_search_model ............................. [[32mPASS[0m in 3.81s]
[0m16:33:31.972311 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:33:31.973602 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:33:31.974909 [info ] [Thread-1 (]: 50 of 100 START test not_null_dim_search_qu_search_type ........................ [RUN]
[0m16:33:31.976196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df, now test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1)
[0m16:33:31.977330 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:33:31.986516 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"
[0m16:33:31.987569 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:33:31.994303 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"
[0m16:33:31.995435 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"
[0m16:33:31.996011 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_type
from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
where search_type is null



      
    ) dbt_internal_test
[0m16:33:31.996545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:36.183036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.186 seconds
[0m16:33:36.187893 [debug] [Thread-1 (]: On test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1: Close
[0m16:33:36.280395 [info ] [Thread-1 (]: 50 of 100 PASS not_null_dim_search_qu_search_type .............................. [[32mPASS[0m in 4.30s]
[0m16:33:36.282137 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:33:36.283411 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:33:36.284709 [info ] [Thread-1 (]: 51 of 100 START test unique_dim_search_qu_search_data_id ....................... [RUN]
[0m16:33:36.285969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1, now test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941)
[0m16:33:36.287181 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:33:36.295559 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"
[0m16:33:36.296600 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:33:36.300427 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"
[0m16:33:36.301592 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"
[0m16:33:36.302158 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    search_data_id as unique_field,
    count(*) as n_records

from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
where search_data_id is not null
group by search_data_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:33:36.302696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:39.743968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.441 seconds
[0m16:33:39.748802 [debug] [Thread-1 (]: On test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941: Close
[0m16:33:39.836548 [info ] [Thread-1 (]: 51 of 100 PASS unique_dim_search_qu_search_data_id ............................. [[32mPASS[0m in 3.55s]
[0m16:33:39.838300 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:33:39.839606 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_inventory_management_qu
[0m16:33:39.841358 [info ] [Thread-1 (]: 52 of 100 START sql incremental model PROJECT_TEST.fact_inventory_management_qu  [RUN]
[0m16:33:39.843028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941, now model.brave_de_project.fact_inventory_management_qu)
[0m16:33:39.844179 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_inventory_management_qu
[0m16:33:39.854150 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:39.855502 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_inventory_management_qu
[0m16:33:39.863073 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:39.863917 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
  
  copy grants as (
    

WITH inventory_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu

),

product_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu 

),

inv_detail AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu
),

inventory_management AS (
    SELECT
    
    id.inventory_id,
    id.product_id,
    id.warehouse_id,
    id.supplier_id,
    idt.inv_detail_id,

    pd.price,
    id.stock_level,
    id.reorder_level,
    id.quantity_in_stock,
    id.sales_volume,
    id.safety_stock,
    id.average_monthly_demand,
    id.rating,
    id.prod_weight,
    id.discounts,
    last_audit_date,
    last_restock_date,
    restock_date,
    next_restock_date
                
    FROM inventory_data id
    INNER JOIN inv_detail idt 
        ON id.inventory_status = idt.storage_condition
        AND idt.inventory_status = id.inventory_status
    LEFT JOIN product_data pd ON id.product_id = pd.product_id
)

SELECT * FROM inventory_management
WHERE price >= discounts
  );
[0m16:33:39.864715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:43.582754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.718 seconds
[0m16:33:43.590839 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.592073 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
[0m16:33:43.658060 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.065 seconds
[0m16:33:43.670590 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.671561 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
[0m16:33:43.743449 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.071 seconds
[0m16:33:43.753644 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.754821 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_INVENTORY_MANAGEMENT_QU"
[0m16:33:43.821858 [debug] [Thread-1 (]: SQL status: SUCCESS 19 in 0.066 seconds
[0m16:33:43.831974 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.837033 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.837956 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:43.913451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:33:43.914644 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:43.916026 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.inventory_id = DBT_INTERNAL_DEST.inventory_id
                ) and (
                    DBT_INTERNAL_SOURCE.warehouse_id = DBT_INTERNAL_DEST.warehouse_id
                ) and (
                    DBT_INTERNAL_SOURCE.supplier_id = DBT_INTERNAL_DEST.supplier_id
                )

    
    when matched then update set
        "INVENTORY_ID" = DBT_INTERNAL_SOURCE."INVENTORY_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","WAREHOUSE_ID" = DBT_INTERNAL_SOURCE."WAREHOUSE_ID","SUPPLIER_ID" = DBT_INTERNAL_SOURCE."SUPPLIER_ID","INV_DETAIL_ID" = DBT_INTERNAL_SOURCE."INV_DETAIL_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","STOCK_LEVEL" = DBT_INTERNAL_SOURCE."STOCK_LEVEL","REORDER_LEVEL" = DBT_INTERNAL_SOURCE."REORDER_LEVEL","QUANTITY_IN_STOCK" = DBT_INTERNAL_SOURCE."QUANTITY_IN_STOCK","SALES_VOLUME" = DBT_INTERNAL_SOURCE."SALES_VOLUME","SAFETY_STOCK" = DBT_INTERNAL_SOURCE."SAFETY_STOCK","AVERAGE_MONTHLY_DEMAND" = DBT_INTERNAL_SOURCE."AVERAGE_MONTHLY_DEMAND","RATING" = DBT_INTERNAL_SOURCE."RATING","PROD_WEIGHT" = DBT_INTERNAL_SOURCE."PROD_WEIGHT","DISCOUNTS" = DBT_INTERNAL_SOURCE."DISCOUNTS","LAST_AUDIT_DATE" = DBT_INTERNAL_SOURCE."LAST_AUDIT_DATE","LAST_RESTOCK_DATE" = DBT_INTERNAL_SOURCE."LAST_RESTOCK_DATE","RESTOCK_DATE" = DBT_INTERNAL_SOURCE."RESTOCK_DATE","NEXT_RESTOCK_DATE" = DBT_INTERNAL_SOURCE."NEXT_RESTOCK_DATE"
    

    when not matched then insert
        ("INVENTORY_ID", "PRODUCT_ID", "WAREHOUSE_ID", "SUPPLIER_ID", "INV_DETAIL_ID", "PRICE", "STOCK_LEVEL", "REORDER_LEVEL", "QUANTITY_IN_STOCK", "SALES_VOLUME", "SAFETY_STOCK", "AVERAGE_MONTHLY_DEMAND", "RATING", "PROD_WEIGHT", "DISCOUNTS", "LAST_AUDIT_DATE", "LAST_RESTOCK_DATE", "RESTOCK_DATE", "NEXT_RESTOCK_DATE")
    values
        ("INVENTORY_ID", "PRODUCT_ID", "WAREHOUSE_ID", "SUPPLIER_ID", "INV_DETAIL_ID", "PRICE", "STOCK_LEVEL", "REORDER_LEVEL", "QUANTITY_IN_STOCK", "SALES_VOLUME", "SAFETY_STOCK", "AVERAGE_MONTHLY_DEMAND", "RATING", "PROD_WEIGHT", "DISCOUNTS", "LAST_AUDIT_DATE", "LAST_RESTOCK_DATE", "RESTOCK_DATE", "NEXT_RESTOCK_DATE")

;
[0m16:33:44.613372 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.696 seconds
[0m16:33:44.614776 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:44.615911 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
COMMIT
[0m16:33:44.751742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m16:33:44.759883 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp
[0m16:33:44.762115 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_inventory_management_qu"
[0m16:33:44.763279 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_inventory_management_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu__dbt_tmp cascade
[0m16:33:44.845639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m16:33:44.847973 [debug] [Thread-1 (]: On model.brave_de_project.fact_inventory_management_qu: Close
[0m16:33:44.936237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dc797fe30>]}
[0m16:33:44.938007 [info ] [Thread-1 (]: 52 of 100 OK created sql incremental model PROJECT_TEST.fact_inventory_management_qu  [[32mSUCCESS 0[0m in 5.09s]
[0m16:33:44.939754 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_inventory_management_qu
[0m16:33:44.941012 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:33:44.943013 [info ] [Thread-1 (]: 53 of 100 START sql incremental model PROJECT_TEST.fact_campaign_effectiveness_qu  [RUN]
[0m16:33:44.944316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_inventory_management_qu, now model.brave_de_project.fact_campaign_effectiveness_qu)
[0m16:33:44.945568 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:33:44.953795 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:44.954884 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:33:44.961893 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:44.962596 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
  
  copy grants as (
    

WITH user_journey AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu
),

valid_users as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
   WHERE account_status = 'active'

),

product_data AS (

    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu 
),

campaign_dim AS (
   SELECT * FROM BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu
),

filteirng AS (
   SELECT
      
      p.price,
      uj.has_purchase,
      uj.has_atc,
      uj.has_pdp,
      uj.has_qv,
      uj.product_id,
      uj.user_id,
      cd.campaign_id -- Foreign key from dim_campaign
    
   FROM user_journey uj
   INNER JOIN campaign_dim cd
     ON uj.campaign_name = cd.campaign_name
    AND uj.medium = cd.medium
    AND uj.source = cd.source
    AND uj.content = cd.content

   INNER JOIN valid_users vu 
     ON uj.user_id = vu.user_id
   
   LEFT JOIN product_data p
     ON uj.product_id = p.product_id
   
   GROUP BY 
      cd.campaign_id,
      uj.product_id, 
      uj.user_id,
      p.price,
      uj.has_purchase,
      uj.has_atc,
      uj.has_pdp,
      uj.has_qv

),

final AS (
    SELECT
       
      campaign_id,
      product_id,
      price AS product_price,
      SUM(CASE WHEN has_purchase = TRUE THEN 1 ELSE 0 END) AS total_unit_sold,
      SUM(CASE WHEN has_atc = TRUE THEN 1 ELSE 0 END) AS total_atc,
      SUM(CASE WHEN has_qv = TRUE THEN 1 ELSE 0 END) AS total_qv,
      SUM(CASE WHEN has_pdp = TRUE THEN 1 ELSE 0 END) AS total_pdp,
      user_id

    FROM filteirng
    GROUP BY 
      campaign_id,
      product_id,
      user_id,
      price
      
)



SELECT * FROM final
  );
[0m16:33:44.963221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:48.154931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.191 seconds
[0m16:33:48.162733 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.163785 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
[0m16:33:48.221504 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.057 seconds
[0m16:33:48.235007 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.236231 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
[0m16:33:48.316140 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.079 seconds
[0m16:33:48.325401 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.326591 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_CAMPAIGN_EFFECTIVENESS_QU"
[0m16:33:48.409533 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m16:33:48.417102 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.421072 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.422242 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:48.488916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m16:33:48.490110 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:48.491362 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
                ) and (
                    DBT_INTERNAL_SOURCE.campaign_id = DBT_INTERNAL_DEST.campaign_id
                ) and (
                    DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
                )

    
    when matched then update set
        "CAMPAIGN_ID" = DBT_INTERNAL_SOURCE."CAMPAIGN_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_PRICE" = DBT_INTERNAL_SOURCE."PRODUCT_PRICE","TOTAL_UNIT_SOLD" = DBT_INTERNAL_SOURCE."TOTAL_UNIT_SOLD","TOTAL_ATC" = DBT_INTERNAL_SOURCE."TOTAL_ATC","TOTAL_QV" = DBT_INTERNAL_SOURCE."TOTAL_QV","TOTAL_PDP" = DBT_INTERNAL_SOURCE."TOTAL_PDP","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID"
    

    when not matched then insert
        ("CAMPAIGN_ID", "PRODUCT_ID", "PRODUCT_PRICE", "TOTAL_UNIT_SOLD", "TOTAL_ATC", "TOTAL_QV", "TOTAL_PDP", "USER_ID")
    values
        ("CAMPAIGN_ID", "PRODUCT_ID", "PRODUCT_PRICE", "TOTAL_UNIT_SOLD", "TOTAL_ATC", "TOTAL_QV", "TOTAL_PDP", "USER_ID")

;
[0m16:33:51.902985 [debug] [Thread-1 (]: SQL status: SUCCESS 308663 in 3.410 seconds
[0m16:33:51.907909 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:51.909113 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
COMMIT
[0m16:33:52.050696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:33:52.059655 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp
[0m16:33:52.061933 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:33:52.063141 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_campaign_effectiveness_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu__dbt_tmp cascade
[0m16:33:52.151742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m16:33:52.156439 [debug] [Thread-1 (]: On model.brave_de_project.fact_campaign_effectiveness_qu: Close
[0m16:33:52.259779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ddb53a030>]}
[0m16:33:52.261565 [info ] [Thread-1 (]: 53 of 100 OK created sql incremental model PROJECT_TEST.fact_campaign_effectiveness_qu  [[32mSUCCESS 308663[0m in 7.31s]
[0m16:33:52.263293 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:33:52.264592 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_search_product_performance_qu
[0m16:33:52.266661 [info ] [Thread-1 (]: 54 of 100 START sql incremental model PROJECT_TEST.fact_search_product_performance_qu  [RUN]
[0m16:33:52.268053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_campaign_effectiveness_qu, now model.brave_de_project.fact_search_product_performance_qu)
[0m16:33:52.269276 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_search_product_performance_qu
[0m16:33:52.279243 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:52.280146 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_search_product_performance_qu
[0m16:33:52.287215 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:52.287803 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
create or replace  temporary view BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
  
  copy grants as (
    


with user_journey as (
   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu 
),

valid_users as (

   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu
   WHERE account_status = 'active'

),

products as (
   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu   
),

search_data as (
   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu
),

search_loc as (
   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu
),

final AS (
   SELECT
  
      uj.search_event_id,
      uj.user_id,
      uj.product_id,
      sd.search_data_id,
      sl.location_id,

      uj.search_terms,
      uj.search_results_count,
      uj.search_timestamp, 
      
      vp.price,
      vp.rating,
      vp.sales_volume,
      vp.discount_percentage,
      vp.weight_grams,
      
      uj.has_qv,
      uj.has_pdp,
      uj.has_atc,
      uj.has_purchase

   FROM user_journey uj
   INNER JOIN search_data sd 
      ON uj.search_model = sd.search_model
      AND uj.search_type = sd.search_type
      AND uj.search_feature = sd.search_feature
      AND uj.search_terms_type = sd.search_terms_type
   INNER JOIN search_loc sl
      ON uj.country = sl.country
      AND uj.city = sl.city
      AND uj.region = sl.region
      AND uj.zipcode = sl.zipcode   

   INNER JOIN valid_users vu ON uj.user_id = vu.user_id
   LEFT JOIN products vp ON uj.product_id = vp.product_id
   
)


SELECT * FROM final
  );
[0m16:33:52.288480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:55.575013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.286 seconds
[0m16:33:55.582912 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.584054 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
[0m16:33:55.673668 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.089 seconds
[0m16:33:55.687419 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.688642 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
[0m16:33:55.750787 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.061 seconds
[0m16:33:55.760529 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.761699 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
describe table "BRAVE_DATABASE"."PROJECT_TEST"."FACT_SEARCH_PRODUCT_PERFORMANCE_QU"
[0m16:33:55.856423 [debug] [Thread-1 (]: SQL status: SUCCESS 17 in 0.094 seconds
[0m16:33:55.866166 [debug] [Thread-1 (]: Writing runtime sql for node "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.870736 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.871880 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:55.962446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m16:33:55.963699 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:55.965054 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
merge into BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
                ) and (
                    DBT_INTERNAL_SOURCE.search_event_id = DBT_INTERNAL_DEST.search_event_id
                )

    
    when matched then update set
        "SEARCH_EVENT_ID" = DBT_INTERNAL_SOURCE."SEARCH_EVENT_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","SEARCH_DATA_ID" = DBT_INTERNAL_SOURCE."SEARCH_DATA_ID","LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","SEARCH_TERMS" = DBT_INTERNAL_SOURCE."SEARCH_TERMS","SEARCH_RESULTS_COUNT" = DBT_INTERNAL_SOURCE."SEARCH_RESULTS_COUNT","SEARCH_TIMESTAMP" = DBT_INTERNAL_SOURCE."SEARCH_TIMESTAMP","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RATING" = DBT_INTERNAL_SOURCE."RATING","SALES_VOLUME" = DBT_INTERNAL_SOURCE."SALES_VOLUME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE","WEIGHT_GRAMS" = DBT_INTERNAL_SOURCE."WEIGHT_GRAMS","HAS_QV" = DBT_INTERNAL_SOURCE."HAS_QV","HAS_PDP" = DBT_INTERNAL_SOURCE."HAS_PDP","HAS_ATC" = DBT_INTERNAL_SOURCE."HAS_ATC","HAS_PURCHASE" = DBT_INTERNAL_SOURCE."HAS_PURCHASE"
    

    when not matched then insert
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")
    values
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")

;
[0m16:33:59.564107 [debug] [Thread-1 (]: SQL status: SUCCESS 308683 in 3.598 seconds
[0m16:33:59.565599 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:59.566761 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
COMMIT
[0m16:33:59.758792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m16:33:59.767428 [debug] [Thread-1 (]: Applying DROP to: BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp
[0m16:33:59.769775 [debug] [Thread-1 (]: Using snowflake connection "model.brave_de_project.fact_search_product_performance_qu"
[0m16:33:59.770948 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "model.brave_de_project.fact_search_product_performance_qu"} */
drop view if exists BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp cascade
[0m16:33:59.858273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m16:33:59.862888 [debug] [Thread-1 (]: On model.brave_de_project.fact_search_product_performance_qu: Close
[0m16:33:59.953848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09af4c99-e2ba-49e6-8818-bfa5e7487462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de67bd310>]}
[0m16:33:59.955600 [info ] [Thread-1 (]: 54 of 100 OK created sql incremental model PROJECT_TEST.fact_search_product_performance_qu  [[32mSUCCESS 308683[0m in 7.68s]
[0m16:33:59.957325 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_search_product_performance_qu
[0m16:33:59.958640 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:33:59.959818 [info ] [Thread-1 (]: 55 of 100 START test not_null_fact_inventory_management_qu_inv_detail_id ....... [RUN]
[0m16:33:59.961729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_search_product_performance_qu, now test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c)
[0m16:33:59.962968 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:33:59.971834 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"
[0m16:33:59.972925 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:33:59.976778 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"
[0m16:33:59.977873 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"
[0m16:33:59.978471 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inv_detail_id
from BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
where inv_detail_id is null



      
    ) dbt_internal_test
[0m16:33:59.979025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:02.931300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.952 seconds
[0m16:34:02.936082 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c: Close
[0m16:34:03.027515 [info ] [Thread-1 (]: 55 of 100 PASS not_null_fact_inventory_management_qu_inv_detail_id ............. [[32mPASS[0m in 3.06s]
[0m16:34:03.029289 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:34:03.030578 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:34:03.031885 [info ] [Thread-1 (]: 56 of 100 START test not_null_fact_inventory_management_qu_inventory_id ........ [RUN]
[0m16:34:03.033166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c, now test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815)
[0m16:34:03.034306 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:34:03.043604 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"
[0m16:34:03.044668 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:34:03.049350 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"
[0m16:34:03.050498 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"
[0m16:34:03.051074 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
where inventory_id is null



      
    ) dbt_internal_test
[0m16:34:03.051620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:07.100823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.049 seconds
[0m16:34:07.105627 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815: Close
[0m16:34:07.197841 [info ] [Thread-1 (]: 56 of 100 PASS not_null_fact_inventory_management_qu_inventory_id .............. [[32mPASS[0m in 4.16s]
[0m16:34:07.267922 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:34:07.269316 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:34:07.270761 [info ] [Thread-1 (]: 57 of 100 START test not_null_fact_inventory_management_qu_product_id .......... [RUN]
[0m16:34:07.272166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815, now test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc)
[0m16:34:07.273333 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:34:07.283886 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"
[0m16:34:07.284916 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:34:07.289513 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"
[0m16:34:07.291014 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"
[0m16:34:07.291820 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
where product_id is null



      
    ) dbt_internal_test
[0m16:34:07.292562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:11.370023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.077 seconds
[0m16:34:11.374795 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc: Close
[0m16:34:11.467403 [info ] [Thread-1 (]: 57 of 100 PASS not_null_fact_inventory_management_qu_product_id ................ [[32mPASS[0m in 4.19s]
[0m16:34:11.469309 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:34:11.470636 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:34:11.471987 [info ] [Thread-1 (]: 58 of 100 START test not_null_fact_inventory_management_qu_supplier_id ......... [RUN]
[0m16:34:11.473507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc, now test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2)
[0m16:34:11.474868 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:34:11.483205 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"
[0m16:34:11.484248 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:34:11.488084 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"
[0m16:34:11.489180 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"
[0m16:34:11.489817 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
where supplier_id is null



      
    ) dbt_internal_test
[0m16:34:11.490393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:15.345320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.855 seconds
[0m16:34:15.350409 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2: Close
[0m16:34:15.442319 [info ] [Thread-1 (]: 58 of 100 PASS not_null_fact_inventory_management_qu_supplier_id ............... [[32mPASS[0m in 3.97s]
[0m16:34:15.444172 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:34:15.445580 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:34:15.446899 [info ] [Thread-1 (]: 59 of 100 START test not_null_fact_inventory_management_qu_warehouse_id ........ [RUN]
[0m16:34:15.448126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2, now test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617)
[0m16:34:15.449275 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:34:15.458633 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"
[0m16:34:15.459601 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:34:15.463898 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"
[0m16:34:15.465431 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"
[0m16:34:15.466124 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select warehouse_id
from BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
where warehouse_id is null



      
    ) dbt_internal_test
[0m16:34:15.466628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:19.573348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.106 seconds
[0m16:34:19.578213 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617: Close
[0m16:34:19.677545 [info ] [Thread-1 (]: 59 of 100 PASS not_null_fact_inventory_management_qu_warehouse_id .............. [[32mPASS[0m in 4.23s]
[0m16:34:19.679318 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:34:19.680631 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fim_price_discount
[0m16:34:19.682002 [info ] [Thread-1 (]: 60 of 100 START test test_fim_price_discount ................................... [RUN]
[0m16:34:19.683169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617, now test.brave_de_project.test_fim_price_discount)
[0m16:34:19.684086 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fim_price_discount
[0m16:34:19.693179 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fim_price_discount"
[0m16:34:19.694199 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fim_price_discount
[0m16:34:19.700059 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_fim_price_discount"
[0m16:34:19.701930 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_fim_price_discount"
[0m16:34:19.702922 [debug] [Thread-1 (]: On test.brave_de_project.test_fim_price_discount: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_fim_price_discount"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Testing for the presence if price is greater than discounts in fact_inventory_management_qu
SELECT
    COUNT(*) AS invalid_rows
FROM
    BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu
WHERE
    price < discounts
HAVING
    invalid_rows > 0
      
    ) dbt_internal_test
[0m16:34:19.703660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:23.524605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.821 seconds
[0m16:34:23.529462 [debug] [Thread-1 (]: On test.brave_de_project.test_fim_price_discount: Close
[0m16:34:23.627365 [info ] [Thread-1 (]: 60 of 100 PASS test_fim_price_discount ......................................... [[32mPASS[0m in 3.94s]
[0m16:34:23.629129 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fim_price_discount
[0m16:34:23.630420 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:34:23.631759 [info ] [Thread-1 (]: 61 of 100 START test not_null_fact_campaign_effectiveness_qu_campaign_id ....... [RUN]
[0m16:34:23.633015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fim_price_discount, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03)
[0m16:34:23.634121 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:34:23.641957 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"
[0m16:34:23.643018 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:34:23.646774 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"
[0m16:34:23.647931 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"
[0m16:34:23.648522 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select campaign_id
from BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
where campaign_id is null



      
    ) dbt_internal_test
[0m16:34:23.649051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:27.679341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.030 seconds
[0m16:34:27.730978 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03: Close
[0m16:34:27.824831 [info ] [Thread-1 (]: 61 of 100 PASS not_null_fact_campaign_effectiveness_qu_campaign_id ............. [[32mPASS[0m in 4.19s]
[0m16:34:27.826745 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:34:27.828018 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:34:27.829435 [info ] [Thread-1 (]: 62 of 100 START test not_null_fact_campaign_effectiveness_qu_product_id ........ [RUN]
[0m16:34:27.831017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7)
[0m16:34:27.832588 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:34:27.841094 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"
[0m16:34:27.842053 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:34:27.846350 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"
[0m16:34:27.847439 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"
[0m16:34:27.847979 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
where product_id is null



      
    ) dbt_internal_test
[0m16:34:27.848480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:31.816743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.968 seconds
[0m16:34:31.821529 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7: Close
[0m16:34:31.913336 [info ] [Thread-1 (]: 62 of 100 PASS not_null_fact_campaign_effectiveness_qu_product_id .............. [[32mPASS[0m in 4.08s]
[0m16:34:31.915079 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:34:31.916363 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:34:31.917677 [info ] [Thread-1 (]: 63 of 100 START test not_null_fact_campaign_effectiveness_qu_product_price ..... [RUN]
[0m16:34:31.918769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e)
[0m16:34:31.919846 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:34:31.928613 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"
[0m16:34:31.929474 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:34:31.933267 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"
[0m16:34:31.934508 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"
[0m16:34:31.935150 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_price
from BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
where product_price is null



      
    ) dbt_internal_test
[0m16:34:31.935758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:35.960788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.025 seconds
[0m16:34:35.965645 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e: Close
[0m16:34:36.053681 [info ] [Thread-1 (]: 63 of 100 PASS not_null_fact_campaign_effectiveness_qu_product_price ........... [[32mPASS[0m in 4.13s]
[0m16:34:36.055431 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:34:36.056692 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:34:36.058028 [info ] [Thread-1 (]: 64 of 100 START test not_null_fact_campaign_effectiveness_qu_user_id ........... [RUN]
[0m16:34:36.059176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52)
[0m16:34:36.060092 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:34:36.068709 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"
[0m16:34:36.069645 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:34:36.073394 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"
[0m16:34:36.074622 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"
[0m16:34:36.075255 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu
where user_id is null



      
    ) dbt_internal_test
[0m16:34:36.075866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:40.219722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.144 seconds
[0m16:34:40.224556 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52: Close
[0m16:34:40.315989 [info ] [Thread-1 (]: 64 of 100 PASS not_null_fact_campaign_effectiveness_qu_user_id ................. [[32mPASS[0m in 4.26s]
[0m16:34:40.317772 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:34:40.319061 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_campaign_id
[0m16:34:40.320408 [info ] [Thread-1 (]: 65 of 100 START test test_fce_campaign_id ...................................... [RUN]
[0m16:34:40.321703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52, now test.brave_de_project.test_fce_campaign_id)
[0m16:34:40.322831 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_campaign_id
[0m16:34:40.329613 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_campaign_id"
[0m16:34:40.330645 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_campaign_id
[0m16:34:40.335495 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_fce_campaign_id"
[0m16:34:40.338006 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_fce_campaign_id"
[0m16:34:40.339172 [debug] [Thread-1 (]: On test.brave_de_project.test_fce_campaign_id: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_fce_campaign_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Testing for the presence of campaign_id in fact_campaign_effectiveness_qu
SELECT
    fce.campaign_id
FROM
    BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce
LEFT JOIN
    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu dc
ON
    fce.campaign_id = dc.campaign_id
WHERE
    dc.campaign_id IS NULL
      
    ) dbt_internal_test
[0m16:34:40.340309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:44.230498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.890 seconds
[0m16:34:44.235250 [debug] [Thread-1 (]: On test.brave_de_project.test_fce_campaign_id: Close
[0m16:34:44.325717 [info ] [Thread-1 (]: 65 of 100 PASS test_fce_campaign_id ............................................ [[32mPASS[0m in 4.00s]
[0m16:34:44.327502 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_campaign_id
[0m16:34:44.328829 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_product_id
[0m16:34:44.330125 [info ] [Thread-1 (]: 66 of 100 START test test_fce_product_id ....................................... [RUN]
[0m16:34:44.331365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_campaign_id, now test.brave_de_project.test_fce_product_id)
[0m16:34:44.332482 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_product_id
[0m16:34:44.340398 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_product_id"
[0m16:34:44.341395 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_product_id
[0m16:34:44.346012 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_fce_product_id"
[0m16:34:44.347889 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_fce_product_id"
[0m16:34:44.348710 [debug] [Thread-1 (]: On test.brave_de_project.test_fce_product_id: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_fce_product_id"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- This test checks if the product_id in the fact_campaign_effectiveness_qu
-- table is present in the stg_product_data_qu table and if the product_price
-- in the fact_campaign_effectiveness_qu table is the same as the price in the
-- stg_product_data_qu table.
-- The test will fail if the product_id is not present in the stg_product_data_qu
-- table or if the product_price in the fact_campaign_effectiveness_qu table is
-- not the same as the price in the stg_product_data_qu table.

SELECT
    fce.product_id,
    fce.product_price AS fce_price,
    spd.price AS spd_price
FROM BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce
    
LEFT JOIN BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu spd
ON
    fce.product_id = spd.product_id
WHERE
    spd.product_id IS NULL
    OR fce.product_price != spd.price
      
    ) dbt_internal_test
[0m16:34:44.349260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:48.236967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.887 seconds
[0m16:34:48.241726 [debug] [Thread-1 (]: On test.brave_de_project.test_fce_product_id: Close
[0m16:34:48.318703 [info ] [Thread-1 (]: 66 of 100 PASS test_fce_product_id ............................................. [[32mPASS[0m in 3.99s]
[0m16:34:48.320569 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_product_id
[0m16:34:48.321840 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:34:48.323099 [info ] [Thread-1 (]: 67 of 100 START test not_null_fact_search_product_performance_qu_location_id ... [RUN]
[0m16:34:48.324303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_product_id, now test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c)
[0m16:34:48.325373 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:34:48.334499 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"
[0m16:34:48.335555 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:34:48.342456 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"
[0m16:34:48.344776 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"
[0m16:34:48.346178 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select location_id
from BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
where location_id is null



      
    ) dbt_internal_test
[0m16:34:48.347576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:52.344024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.996 seconds
[0m16:34:52.348897 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c: Close
[0m16:34:53.041210 [info ] [Thread-1 (]: 67 of 100 PASS not_null_fact_search_product_performance_qu_location_id ......... [[32mPASS[0m in 4.72s]
[0m16:34:53.043186 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:34:53.044508 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:34:53.045827 [info ] [Thread-1 (]: 68 of 100 START test not_null_fact_search_product_performance_qu_product_id .... [RUN]
[0m16:34:53.047032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c, now test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc)
[0m16:34:53.048199 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:34:53.056916 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"
[0m16:34:53.057760 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:34:53.061463 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"
[0m16:34:53.062888 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"
[0m16:34:53.063536 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
where product_id is null



      
    ) dbt_internal_test
[0m16:34:53.064115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:56.596959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.533 seconds
[0m16:34:56.601843 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc: Close
[0m16:34:56.688348 [info ] [Thread-1 (]: 68 of 100 PASS not_null_fact_search_product_performance_qu_product_id .......... [[32mPASS[0m in 3.64s]
[0m16:34:56.690101 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:34:56.691356 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:34:56.692678 [info ] [Thread-1 (]: 69 of 100 START test not_null_fact_search_product_performance_qu_search_data_id  [RUN]
[0m16:34:56.693936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5)
[0m16:34:56.695079 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:34:56.704078 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"
[0m16:34:56.705157 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:34:56.709917 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"
[0m16:34:56.711065 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"
[0m16:34:56.711731 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_data_id
from BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
where search_data_id is null



      
    ) dbt_internal_test
[0m16:34:56.712509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:00.714864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.002 seconds
[0m16:35:00.720199 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5: Close
[0m16:35:00.823840 [info ] [Thread-1 (]: 69 of 100 PASS not_null_fact_search_product_performance_qu_search_data_id ...... [[32mPASS[0m in 4.13s]
[0m16:35:00.825960 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:35:00.827466 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:00.828966 [info ] [Thread-1 (]: 70 of 100 START test not_null_fact_search_product_performance_qu_search_event_id  [RUN]
[0m16:35:00.830418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986)
[0m16:35:00.831570 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:00.838858 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"
[0m16:35:00.839687 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:00.842869 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"
[0m16:35:00.843788 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"
[0m16:35:00.844482 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select search_event_id
from BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
where search_event_id is null



      
    ) dbt_internal_test
[0m16:35:00.845006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:04.979451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.134 seconds
[0m16:35:04.984273 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986: Close
[0m16:35:05.082703 [info ] [Thread-1 (]: 70 of 100 PASS not_null_fact_search_product_performance_qu_search_event_id ..... [[32mPASS[0m in 4.25s]
[0m16:35:05.084475 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:05.085746 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:05.087059 [info ] [Thread-1 (]: 71 of 100 START test not_null_fact_search_product_performance_qu_user_id ....... [RUN]
[0m16:35:05.088344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986, now test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493)
[0m16:35:05.089518 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:05.098278 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"
[0m16:35:05.099335 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:05.103808 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"
[0m16:35:05.104916 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"
[0m16:35:05.105511 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu
where user_id is null



      
    ) dbt_internal_test
[0m16:35:05.106038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:08.963850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.858 seconds
[0m16:35:08.968758 [debug] [Thread-1 (]: On test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493: Close
[0m16:35:09.055436 [info ] [Thread-1 (]: 71 of 100 PASS not_null_fact_search_product_performance_qu_user_id ............. [[32mPASS[0m in 3.97s]
[0m16:35:09.057193 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:09.058513 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fspp_data
[0m16:35:09.059807 [info ] [Thread-1 (]: 72 of 100 START test test_fspp_data ............................................ [RUN]
[0m16:35:09.061065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493, now test.brave_de_project.test_fspp_data)
[0m16:35:09.062185 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fspp_data
[0m16:35:09.069442 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fspp_data"
[0m16:35:09.070482 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fspp_data
[0m16:35:09.075110 [debug] [Thread-1 (]: Writing runtime sql for node "test.brave_de_project.test_fspp_data"
[0m16:35:09.076896 [debug] [Thread-1 (]: Using snowflake connection "test.brave_de_project.test_fspp_data"
[0m16:35:09.077515 [debug] [Thread-1 (]: On test.brave_de_project.test_fspp_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "node_id": "test.brave_de_project.test_fspp_data"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test: test_fspp_data
-- Description: This test checks if the user_id in the fact_search_product_performance_qu
-- table is present in the dim_user_qu table and if the discount_percentage in the
-- fact_search_product_performance_qu table is between 0 and 100, given the account_status
-- in the dim_user_qu table is 'active'.
SELECT
    COUNT(*) AS invalid_rows
FROM
    BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu fsp
JOIN
    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu du
ON
    fsp.user_id = du.user_id
WHERE
    (discount_percentage < 0 OR discount_percentage > 100)
    OR du.account_status != 'active'
HAVING
    invalid_rows > 0
      
    ) dbt_internal_test
[0m16:35:09.078068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:13.102127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.024 seconds
[0m16:35:13.106914 [debug] [Thread-1 (]: On test.brave_de_project.test_fspp_data: Close
[0m16:35:13.201576 [info ] [Thread-1 (]: 72 of 100 PASS test_fspp_data .................................................. [[32mPASS[0m in 4.14s]
[0m16:35:13.203312 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fspp_data
[0m16:35:13.206660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:13.207636 [debug] [MainThread]: Connection 'test.brave_de_project.test_fspp_data' was properly closed.
[0m16:35:13.208991 [info ] [MainThread]: 
[0m16:35:13.210101 [info ] [MainThread]: Finished running 7 unit tests, 4 view models, 9 incremental models, 52 data tests in 0 hours 5 minutes and 21.01 seconds (321.01s).
[0m16:35:13.230506 [debug] [MainThread]: Command end result
[0m16:35:13.280406 [info ] [MainThread]: 
[0m16:35:13.280923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:13.281290 [info ] [MainThread]: 
[0m16:35:13.281644 [info ] [MainThread]: Done. PASS=72 WARN=0 ERROR=0 SKIP=0 TOTAL=72
[0m16:35:13.282575 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 323.81152, "process_user_time": 15.280902, "process_kernel_time": 3.337634, "process_mem_max_rss": "212836", "process_in_blocks": "664", "process_out_blocks": "9424"}
[0m16:35:13.283097 [debug] [MainThread]: Command `dbt build` succeeded at 16:35:13.282998 after 323.81 seconds
[0m16:35:13.283461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27d277a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27f2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8de099a2a0>]}
[0m16:35:13.283821 [debug] [MainThread]: Flushing usage events
[0m16:35:35.989633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8e89f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8e7a1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8e89f500>]}


============================== 16:35:35.991722 | 8e33a1e1-ffaa-41d5-9d43-3085ef519800 ==============================
[0m16:35:35.991722 [info ] [MainThread]: Running with dbt=1.8.8
[0m16:35:35.992156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:35:36.570893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8de82f90>]}
[0m16:35:36.611394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8db2e840>]}
[0m16:35:36.611913 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:35:36.636816 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m16:35:36.742059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:36.742423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:36.746224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.brave_de_project
[0m16:35:36.777235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4ebde240>]}
[0m16:35:36.793883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c83e97230>]}
[0m16:35:36.794288 [info ] [MainThread]: Found 13 models, 52 data tests, 4 sources, 851 macros, 7 unit tests
[0m16:35:36.794635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8f217770>]}
[0m16:35:36.797109 [info ] [MainThread]: 
[0m16:35:36.797603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:36.801559 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_BRAVE_DATABASE_PROJECT_TEST'
[0m16:35:36.833762 [debug] [ThreadPool]: Using snowflake connection "list_BRAVE_DATABASE_PROJECT_TEST"
[0m16:35:36.834506 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "list_BRAVE_DATABASE_PROJECT_TEST"} */
show objects in BRAVE_DATABASE.PROJECT_TEST limit 10000
[0m16:35:36.835128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:40.439072 [debug] [ThreadPool]: SQL status: SUCCESS 99 in 3.604 seconds
[0m16:35:40.451277 [debug] [ThreadPool]: On list_BRAVE_DATABASE_PROJECT_TEST: Close
[0m16:35:40.553267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e33a1e1-ffaa-41d5-9d43-3085ef519800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c6ef11cd0>]}
[0m16:35:40.554128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:40.554673 [info ] [MainThread]: 
[0m16:35:40.559298 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_inventory_data_qu
[0m16:35:40.560622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_BRAVE_DATABASE_PROJECT_TEST, now model.brave_de_project.stg_inventory_data_qu)
[0m16:35:40.561773 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_inventory_data_qu
[0m16:35:40.589653 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_inventory_data_qu"
[0m16:35:40.591207 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_inventory_data_qu
[0m16:35:40.592635 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_inventory_data_qu
[0m16:35:40.593489 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_product_data_qu
[0m16:35:40.594294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_inventory_data_qu, now model.brave_de_project.stg_product_data_qu)
[0m16:35:40.595043 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_product_data_qu
[0m16:35:40.601406 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_product_data_qu"
[0m16:35:40.602344 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_product_data_qu
[0m16:35:40.603263 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_product_data_qu
[0m16:35:40.603845 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_data_qu
[0m16:35:40.604373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_product_data_qu, now model.brave_de_project.stg_user_data_qu)
[0m16:35:40.605037 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_data_qu
[0m16:35:40.610762 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_data_qu"
[0m16:35:40.611462 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_data_qu
[0m16:35:40.612118 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_data_qu
[0m16:35:40.612868 [debug] [Thread-1 (]: Began running node model.brave_de_project.stg_user_journey_qu
[0m16:35:40.614188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_data_qu, now model.brave_de_project.stg_user_journey_qu)
[0m16:35:40.615437 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.stg_user_journey_qu
[0m16:35:40.624180 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.stg_user_journey_qu"
[0m16:35:40.625388 [debug] [Thread-1 (]: Began executing node model.brave_de_project.stg_user_journey_qu
[0m16:35:40.626946 [debug] [Thread-1 (]: Finished running node model.brave_de_project.stg_user_journey_qu
[0m16:35:40.627970 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_inv_detail_qu
[0m16:35:40.629071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.stg_user_journey_qu, now model.brave_de_project.dim_inv_detail_qu)
[0m16:35:40.630223 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_inv_detail_qu
[0m16:35:40.649196 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_inv_detail_qu"
[0m16:35:40.649889 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_inv_detail_qu
[0m16:35:40.650677 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_inv_detail_qu
[0m16:35:40.651163 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_product_qu
[0m16:35:40.651812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_inv_detail_qu, now model.brave_de_project.dim_product_qu)
[0m16:35:40.652429 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_product_qu
[0m16:35:40.655133 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_product_qu"
[0m16:35:40.655617 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_product_qu
[0m16:35:40.656195 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_product_qu
[0m16:35:40.656578 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_user_qu
[0m16:35:40.657070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_product_qu, now model.brave_de_project.dim_user_qu)
[0m16:35:40.657549 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_user_qu
[0m16:35:40.660046 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_user_qu"
[0m16:35:40.660523 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_user_qu
[0m16:35:40.661100 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_user_qu
[0m16:35:40.661471 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_campaign_qu
[0m16:35:40.661972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_user_qu, now model.brave_de_project.dim_campaign_qu)
[0m16:35:40.662410 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_campaign_qu
[0m16:35:40.666889 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_campaign_qu"
[0m16:35:40.667358 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_campaign_qu
[0m16:35:40.667939 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_campaign_qu
[0m16:35:40.668320 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_location_qu
[0m16:35:40.668856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_campaign_qu, now model.brave_de_project.dim_search_location_qu)
[0m16:35:40.669384 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_location_qu
[0m16:35:40.672520 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_location_qu"
[0m16:35:40.672984 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_location_qu
[0m16:35:40.673565 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_location_qu
[0m16:35:40.673927 [debug] [Thread-1 (]: Began running node model.brave_de_project.dim_search_qu
[0m16:35:40.674424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_location_qu, now model.brave_de_project.dim_search_qu)
[0m16:35:40.674855 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.dim_search_qu
[0m16:35:40.677903 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.dim_search_qu"
[0m16:35:40.678404 [debug] [Thread-1 (]: Began executing node model.brave_de_project.dim_search_qu
[0m16:35:40.678977 [debug] [Thread-1 (]: Finished running node model.brave_de_project.dim_search_qu
[0m16:35:40.679330 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_inventory_management_qu
[0m16:35:40.679834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.dim_search_qu, now model.brave_de_project.fact_inventory_management_qu)
[0m16:35:40.680270 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_inventory_management_qu
[0m16:35:40.683059 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_inventory_management_qu"
[0m16:35:40.683518 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_inventory_management_qu
[0m16:35:40.684081 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_inventory_management_qu
[0m16:35:40.684450 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:35:40.684932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_inventory_management_qu, now test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8)
[0m16:35:40.685410 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:35:40.694452 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8"
[0m16:35:40.694908 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:35:40.695490 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8
[0m16:35:40.695846 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:35:40.696266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8, now test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620)
[0m16:35:40.696601 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:35:40.702653 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620"
[0m16:35:40.703092 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:35:40.703653 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620
[0m16:35:40.704001 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:35:40.704428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620, now test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e)
[0m16:35:40.704751 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:35:40.708461 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e"
[0m16:35:40.708880 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:35:40.709421 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e
[0m16:35:40.709766 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:35:40.710171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e, now test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc)
[0m16:35:40.710499 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:35:40.713206 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc"
[0m16:35:40.713632 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:35:40.714131 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc
[0m16:35:40.714479 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:35:40.714884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc, now test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8)
[0m16:35:40.715209 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:35:40.719346 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8"
[0m16:35:40.719764 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:35:40.720259 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8
[0m16:35:40.720614 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:35:40.721021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8, now test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53)
[0m16:35:40.721334 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:35:40.724059 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53"
[0m16:35:40.724499 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:35:40.724994 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53
[0m16:35:40.725343 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:35:40.725757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53, now test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8)
[0m16:35:40.726067 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:35:40.728727 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8"
[0m16:35:40.729114 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:35:40.729667 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8
[0m16:35:40.730003 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:35:40.730413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8, now test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514)
[0m16:35:40.730727 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:35:40.733362 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514"
[0m16:35:40.733775 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:35:40.734281 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514
[0m16:35:40.734641 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_product_dates
[0m16:35:40.735044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514, now test.brave_de_project.test_product_dates)
[0m16:35:40.735368 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_product_dates
[0m16:35:40.737248 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_product_dates"
[0m16:35:40.737639 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_product_dates
[0m16:35:40.738120 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_product_dates
[0m16:35:40.738456 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:35:40.738856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_product_dates, now test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e)
[0m16:35:40.739162 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:35:40.742682 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e"
[0m16:35:40.743099 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:35:40.743629 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e
[0m16:35:40.743970 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:35:40.744366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e, now test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d)
[0m16:35:40.744688 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:35:40.814121 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d"
[0m16:35:40.814671 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:35:40.815210 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d
[0m16:35:40.815541 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:35:40.815931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d, now test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459)
[0m16:35:40.816217 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:35:40.818759 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459"
[0m16:35:40.819137 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:35:40.819647 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459
[0m16:35:40.819973 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:35:40.820365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459, now test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9)
[0m16:35:40.820680 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:35:40.823260 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9"
[0m16:35:40.823652 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:35:40.824177 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9
[0m16:35:40.824518 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_user_data
[0m16:35:40.824833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9, now test.brave_de_project.test_user_data)
[0m16:35:40.825200 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_user_data
[0m16:35:40.827127 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_user_data"
[0m16:35:40.827563 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_user_data
[0m16:35:40.828158 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_user_data
[0m16:35:40.828501 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:35:40.828889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_user_data, now test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc)
[0m16:35:40.829186 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:35:40.831683 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc"
[0m16:35:40.832051 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:35:40.832547 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc
[0m16:35:40.832859 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:35:40.833228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc, now model.brave_de_project.fact_campaign_effectiveness_qu)
[0m16:35:40.833523 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:35:40.836126 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_campaign_effectiveness_qu"
[0m16:35:40.836509 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:35:40.837004 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_campaign_effectiveness_qu
[0m16:35:40.837309 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:35:40.837739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_campaign_effectiveness_qu, now test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2)
[0m16:35:40.838177 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:35:40.840769 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2"
[0m16:35:40.841153 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:35:40.841691 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2
[0m16:35:40.842017 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:35:40.842414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2, now test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672)
[0m16:35:40.842718 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:35:40.846195 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672"
[0m16:35:40.846580 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:35:40.847118 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672
[0m16:35:40.847453 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:35:40.847840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672, now test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892)
[0m16:35:40.848139 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:35:40.850692 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892"
[0m16:35:40.851077 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:35:40.851583 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892
[0m16:35:40.851913 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:35:40.852225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892, now test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b)
[0m16:35:40.852610 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:35:40.855246 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b"
[0m16:35:40.855626 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:35:40.856152 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b
[0m16:35:40.856480 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:35:40.856869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b, now test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5)
[0m16:35:40.857168 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:35:40.859691 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5"
[0m16:35:40.860097 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:35:40.860622 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5
[0m16:35:40.860956 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_campagin_combinations
[0m16:35:40.861345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5, now test.brave_de_project.test_campagin_combinations)
[0m16:35:40.861657 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_campagin_combinations
[0m16:35:40.863513 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_campagin_combinations"
[0m16:35:40.863891 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_campagin_combinations
[0m16:35:40.864362 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_campagin_combinations
[0m16:35:40.864698 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:35:40.865087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_campagin_combinations, now test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2)
[0m16:35:40.865396 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:35:40.867902 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2"
[0m16:35:40.868293 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:35:40.868823 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2
[0m16:35:40.869148 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:35:40.869542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2, now test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42)
[0m16:35:40.869852 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:35:40.872563 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42"
[0m16:35:40.872972 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:35:40.873494 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42
[0m16:35:40.873832 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:35:40.874186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42, now test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af)
[0m16:35:40.874492 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:35:40.878007 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af"
[0m16:35:40.878419 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:35:40.878935 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af
[0m16:35:40.879270 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:35:40.879630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af, now test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee)
[0m16:35:40.879937 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:35:40.882425 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee"
[0m16:35:40.882811 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:35:40.883288 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee
[0m16:35:40.883612 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:35:40.883942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee, now test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6)
[0m16:35:40.884224 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:35:40.886721 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6"
[0m16:35:40.887108 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:35:40.887601 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6
[0m16:35:40.887914 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:35:40.888237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6, now test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6)
[0m16:35:40.888537 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:35:40.891061 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6"
[0m16:35:40.891473 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:35:40.891975 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6
[0m16:35:40.892319 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:35:40.892691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6, now test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be)
[0m16:35:40.892995 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:35:40.895556 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be"
[0m16:35:40.895959 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:35:40.896480 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be
[0m16:35:40.896832 [debug] [Thread-1 (]: Began running node model.brave_de_project.fact_search_product_performance_qu
[0m16:35:40.897161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be, now model.brave_de_project.fact_search_product_performance_qu)
[0m16:35:40.897453 [debug] [Thread-1 (]: Began compiling node model.brave_de_project.fact_search_product_performance_qu
[0m16:35:40.900094 [debug] [Thread-1 (]: Writing injected SQL for node "model.brave_de_project.fact_search_product_performance_qu"
[0m16:35:40.900524 [debug] [Thread-1 (]: Began executing node model.brave_de_project.fact_search_product_performance_qu
[0m16:35:40.901043 [debug] [Thread-1 (]: Finished running node model.brave_de_project.fact_search_product_performance_qu
[0m16:35:40.901389 [debug] [Thread-1 (]: Began running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:35:40.901781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.brave_de_project.fact_search_product_performance_qu, now test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1)
[0m16:35:40.902293 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:35:40.905925 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1"
[0m16:35:40.906318 [debug] [Thread-1 (]: Began executing node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:35:40.906864 [debug] [Thread-1 (]: Finished running node test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1
[0m16:35:40.907196 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:35:40.907555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1, now test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22)
[0m16:35:40.907854 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:35:40.910398 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22"
[0m16:35:40.910784 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:35:40.911258 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22
[0m16:35:40.911576 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:35:40.911898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22, now test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df)
[0m16:35:40.912177 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:35:40.915725 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df"
[0m16:35:40.916111 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:35:40.916594 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df
[0m16:35:40.916908 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:35:40.917230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df, now test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df)
[0m16:35:40.917524 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:35:40.920055 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df"
[0m16:35:40.920454 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:35:40.920967 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df
[0m16:35:40.921302 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:35:40.921664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df, now test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1)
[0m16:35:40.921979 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:35:40.924443 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1"
[0m16:35:40.924844 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:35:40.925357 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1
[0m16:35:40.925703 [debug] [Thread-1 (]: Began running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:35:40.926051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1, now test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941)
[0m16:35:40.926365 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:35:40.928822 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941"
[0m16:35:40.929225 [debug] [Thread-1 (]: Began executing node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:35:40.929749 [debug] [Thread-1 (]: Finished running node test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941
[0m16:35:40.930087 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:35:40.930449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941, now test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c)
[0m16:35:40.930762 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:35:40.933315 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c"
[0m16:35:40.933773 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:35:40.934294 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c
[0m16:35:40.934651 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:35:40.935010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c, now test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815)
[0m16:35:40.935320 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:35:40.937918 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815"
[0m16:35:40.938322 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:35:40.938853 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815
[0m16:35:40.939188 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:35:40.939550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815, now test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc)
[0m16:35:40.939855 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:35:40.942483 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc"
[0m16:35:40.942887 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:35:40.943417 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc
[0m16:35:40.943756 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:35:40.944107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc, now test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2)
[0m16:35:40.944428 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:35:40.947936 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2"
[0m16:35:40.948308 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:35:40.948824 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2
[0m16:35:40.949138 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:35:40.949471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2, now test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617)
[0m16:35:40.949761 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:35:40.952186 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617"
[0m16:35:40.952582 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:35:40.953109 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617
[0m16:35:40.953459 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fim_price_discount
[0m16:35:40.953815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617, now test.brave_de_project.test_fim_price_discount)
[0m16:35:40.954110 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fim_price_discount
[0m16:35:40.956013 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fim_price_discount"
[0m16:35:40.956384 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fim_price_discount
[0m16:35:40.956861 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fim_price_discount
[0m16:35:40.957198 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:35:40.957557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fim_price_discount, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03)
[0m16:35:40.957862 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:35:40.960370 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03"
[0m16:35:40.960766 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:35:40.961248 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03
[0m16:35:40.961573 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:35:40.961897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7)
[0m16:35:40.962181 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:35:40.964792 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7"
[0m16:35:40.965185 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:35:40.965676 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7
[0m16:35:40.965992 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:35:40.966323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e)
[0m16:35:40.966622 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:35:40.969136 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e"
[0m16:35:40.969529 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:35:40.970016 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e
[0m16:35:40.970330 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:35:40.970687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e, now test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52)
[0m16:35:40.970991 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:35:40.973516 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52"
[0m16:35:40.973886 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:35:40.974388 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52
[0m16:35:40.974702 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_campaign_id
[0m16:35:40.975025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52, now test.brave_de_project.test_fce_campaign_id)
[0m16:35:40.975301 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_campaign_id
[0m16:35:40.978130 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_campaign_id"
[0m16:35:40.978519 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_campaign_id
[0m16:35:40.978997 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_campaign_id
[0m16:35:40.979329 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fce_product_id
[0m16:35:40.979692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_campaign_id, now test.brave_de_project.test_fce_product_id)
[0m16:35:40.979992 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fce_product_id
[0m16:35:40.981944 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fce_product_id"
[0m16:35:40.982326 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fce_product_id
[0m16:35:40.982812 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fce_product_id
[0m16:35:40.983122 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:35:40.983456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.test_fce_product_id, now test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c)
[0m16:35:40.983743 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:35:40.986221 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c"
[0m16:35:40.986620 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:35:40.987117 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c
[0m16:35:40.987462 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:35:40.987817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c, now test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc)
[0m16:35:40.988128 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:35:40.990885 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc"
[0m16:35:40.991319 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:35:40.991811 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc
[0m16:35:40.992128 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:35:40.992463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5)
[0m16:35:40.992753 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:35:40.995174 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5"
[0m16:35:40.995572 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:35:40.996055 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5
[0m16:35:40.996415 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:40.996775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5, now test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986)
[0m16:35:40.997086 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:40.999635 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986"
[0m16:35:41.000024 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:41.000516 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986
[0m16:35:41.000840 [debug] [Thread-1 (]: Began running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:41.001173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986, now test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493)
[0m16:35:41.001470 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:41.004124 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493"
[0m16:35:41.004519 [debug] [Thread-1 (]: Began executing node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:41.005050 [debug] [Thread-1 (]: Finished running node test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493
[0m16:35:41.005393 [debug] [Thread-1 (]: Began running node test.brave_de_project.test_fspp_data
[0m16:35:41.005743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493, now test.brave_de_project.test_fspp_data)
[0m16:35:41.006048 [debug] [Thread-1 (]: Began compiling node test.brave_de_project.test_fspp_data
[0m16:35:41.007944 [debug] [Thread-1 (]: Writing injected SQL for node "test.brave_de_project.test_fspp_data"
[0m16:35:41.008306 [debug] [Thread-1 (]: Began executing node test.brave_de_project.test_fspp_data
[0m16:35:41.008799 [debug] [Thread-1 (]: Finished running node test.brave_de_project.test_fspp_data
[0m16:35:41.010089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:41.010996 [debug] [MainThread]: Connection 'test.brave_de_project.test_fspp_data' was properly closed.
[0m16:35:41.029829 [debug] [MainThread]: Command end result
[0m16:35:41.166833 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m16:35:41.167104 [info ] [MainThread]: Building catalog
[0m16:35:41.175109 [debug] [ThreadPool]: Acquiring new snowflake connection 'BRAVE_DATABASE.information_schema'
[0m16:35:41.204582 [debug] [ThreadPool]: Using snowflake connection "BRAVE_DATABASE.information_schema"
[0m16:35:41.205582 [debug] [ThreadPool]: On BRAVE_DATABASE.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "BRAVE_DATABASE.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from BRAVE_DATABASE.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_inventory_management_qu' and upper("table_name") = upper('fact_inventory_management_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_inventory_data_qu' and upper("table_name") = upper('stg_inventory_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_data_qu' and upper("table_name") = upper('stg_user_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_user_qu' and upper("table_name") = upper('dim_user_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_search_product_performance_qu' and upper("table_name") = upper('fact_search_product_performance_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_journey_qu' and upper("table_name") = upper('stg_user_journey_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_inv_detail_qu' and upper("table_name") = upper('dim_inv_detail_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_qu' and upper("table_name") = upper('dim_search_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_location_qu' and upper("table_name") = upper('dim_search_location_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_product_data_qu' and upper("table_name") = upper('stg_product_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_campaign_effectiveness_qu' and upper("table_name") = upper('fact_campaign_effectiveness_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_campaign_qu' and upper("table_name") = upper('dim_campaign_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_product_qu' and upper("table_name") = upper('dim_product_qu')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from BRAVE_DATABASE.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_inventory_management_qu' and upper("table_name") = upper('fact_inventory_management_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_inventory_data_qu' and upper("table_name") = upper('stg_inventory_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_data_qu' and upper("table_name") = upper('stg_user_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_user_qu' and upper("table_name") = upper('dim_user_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_search_product_performance_qu' and upper("table_name") = upper('fact_search_product_performance_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_user_journey_qu' and upper("table_name") = upper('stg_user_journey_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_inv_detail_qu' and upper("table_name") = upper('dim_inv_detail_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_qu' and upper("table_name") = upper('dim_search_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_search_location_qu' and upper("table_name") = upper('dim_search_location_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'stg_product_data_qu' and upper("table_name") = upper('stg_product_data_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'fact_campaign_effectiveness_qu' and upper("table_name") = upper('fact_campaign_effectiveness_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_campaign_qu' and upper("table_name") = upper('dim_campaign_qu')

                )
             or 
                (
                    
    "table_schema" ilike 'PROJECT_TEST' and upper("table_schema") = upper('PROJECT_TEST')

                    and 
    "table_name" ilike 'dim_product_qu' and upper("table_name") = upper('dim_product_qu')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:35:41.206516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:50.454373 [debug] [ThreadPool]: SQL status: SUCCESS 181 in 9.248 seconds
[0m16:35:50.713174 [debug] [ThreadPool]: On BRAVE_DATABASE.information_schema: Close
[0m16:35:50.793108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly BRAVE_DATABASE.information_schema, now brave_database.information_schema)
[0m16:35:50.804029 [debug] [ThreadPool]: Using snowflake connection "brave_database.information_schema"
[0m16:35:50.805191 [debug] [ThreadPool]: On brave_database.information_schema: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "brave_de_project", "target_name": "dev", "connection_name": "brave_database.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from brave_database.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_data' and upper("table_name") = upper('user_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'inventory_data' and upper("table_name") = upper('inventory_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_journey' and upper("table_name") = upper('user_journey')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'product_data' and upper("table_name") = upper('product_data')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from brave_database.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_data' and upper("table_name") = upper('user_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'inventory_data' and upper("table_name") = upper('inventory_data')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'user_journey' and upper("table_name") = upper('user_journey')

                )
             or 
                (
                    
    "table_schema" ilike 'de_project' and upper("table_schema") = upper('de_project')

                    and 
    "table_name" ilike 'product_data' and upper("table_name") = upper('product_data')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m16:35:50.806255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:56.496399 [debug] [ThreadPool]: SQL status: SUCCESS 101 in 5.690 seconds
[0m16:35:56.521744 [debug] [ThreadPool]: On brave_database.information_schema: Close
[0m16:35:56.705780 [info ] [MainThread]: Catalog written to /home/user/Documents/AirflowSnowflakeProject/dbt/target/catalog.json
[0m16:35:56.706885 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 20.74946, "process_user_time": 3.290481, "process_kernel_time": 2.848551, "process_mem_max_rss": "202784", "process_out_blocks": "8520", "process_in_blocks": "0"}
[0m16:35:56.707474 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:35:56.707353 after 20.75 seconds
[0m16:35:56.707777 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:35:56.708034 [debug] [MainThread]: Connection 'brave_database.information_schema' was properly closed.
[0m16:35:56.708331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8e7a1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c83e97230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c8e33df70>]}
[0m16:35:56.708676 [debug] [MainThread]: Flushing usage events
[0m10:48:30.445917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e9166af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e91c92780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e9166af30>]}


============================== 10:48:30.448159 | 6300faf1-7489-4a18-8aed-69e19be40e5e ==============================
[0m10:48:30.448159 [info ] [MainThread]: Running with dbt=1.8.8
[0m10:48:30.448614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8000', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:48:31.000559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6300faf1-7489-4a18-8aed-69e19be40e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e5fdb2f60>]}
[0m10:48:31.041364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6300faf1-7489-4a18-8aed-69e19be40e5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e763ff410>]}
[0m10:53:14.301608 [error] [MainThread]: Encountered an error:

[0m10:53:14.324207 [error] [MainThread]: Traceback (most recent call last):
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/user/miniconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:53:14.326961 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 283.9165, "process_user_time": 1.836801, "process_kernel_time": 2.8131, "process_mem_max_rss": "188572", "process_in_blocks": "208", "process_out_blocks": "2976", "command_success": false}
[0m10:53:14.328705 [debug] [MainThread]: Command `dbt docs serve` failed at 10:53:14.328411 after 283.92 seconds
[0m10:53:14.329759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e92e62c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e521566f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760e4f7f4e90>]}
[0m10:53:14.330866 [debug] [MainThread]: Flushing usage events
[0m14:49:19.430269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d5a7fc6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d5a63a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d5ca34530>]}


============================== 14:49:19.432685 | 5f5e1de7-83cf-48c7-8d42-8feac602fb38 ==============================
[0m14:49:19.432685 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:49:19.433158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8000', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:20.002772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f5e1de7-83cf-48c7-8d42-8feac602fb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d41514530>]}
[0m14:49:20.044829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f5e1de7-83cf-48c7-8d42-8feac602fb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d5b718aa0>]}
[0m14:49:43.996022 [error] [MainThread]: Encountered an error:

[0m14:49:44.000663 [error] [MainThread]: Traceback (most recent call last):
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/user/miniconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:49:44.003116 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 24.609016, "process_user_time": 1.911434, "process_kernel_time": 2.827079, "process_mem_max_rss": "187532", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m14:49:44.004659 [debug] [MainThread]: Command `dbt docs serve` failed at 14:49:44.004397 after 24.61 seconds
[0m14:49:44.005611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d5b18e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d13f04fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792d55967da0>]}
[0m14:49:44.006562 [debug] [MainThread]: Flushing usage events
[0m15:11:04.727069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc5ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b9ee1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8ba771160>]}


============================== 15:11:04.734638 | bb38eb3e-461f-49d4-8a2b-c19215780db0 ==============================
[0m15:11:04.734638 [info ] [MainThread]: Running with dbt=1.8.8
[0m15:11:04.736439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/user/Documents/AirflowSnowflakeProject/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8000', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:05.316234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb38eb3e-461f-49d4-8a2b-c19215780db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8b9d42c00>]}
[0m15:11:05.358717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb38eb3e-461f-49d4-8a2b-c19215780db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bab5c170>]}
[0m15:13:00.485085 [error] [MainThread]: Encountered an error:

[0m15:13:00.489778 [error] [MainThread]: Traceback (most recent call last):
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/user/miniconda3/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/miniconda3/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:13:00.492264 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 115.80166, "process_user_time": 1.947035, "process_kernel_time": 2.832415, "process_mem_max_rss": "187104", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m15:13:00.493992 [debug] [MainThread]: Command `dbt docs serve` failed at 15:13:00.493702 after 115.80 seconds
[0m15:13:00.495072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bc5ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd87b17ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd877df40b0>]}
[0m15:13:00.496163 [debug] [MainThread]: Flushing usage events
