{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-10-31T16:46:18.866171Z", "invocation_id": "e769959f-c019-4327-b7cd-507e51b018a3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.399638Z", "completed_at": "2024-10-31T16:46:18.422799Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.423432Z", "completed_at": "2024-10-31T16:46:18.423457Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026576519012451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_inventory_data_qu", "compiled": true, "compiled_code": "\n\n\nwith source as (\n\n    select * from brave_database.de_project.inventory_data\n\n),\n\nstaging_data as (\n\n    select\n        inventory_id,\n        warehouse_id,\n        stock_level,\n        restock_date,\n        supplier_id,\n        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,\n        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,\n        reorder_level,\n        quantity_in_stock,\n        sales_volume,\n        safety_stock,\n        average_monthly_demand,\n        last_restock_date,\n        next_restock_date,\n\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n        \n        -- Extract last audit date from timestamp and\n        -- convert to date format\n        CAST(last_audit_date AS DATE) AS last_audit_date, \n\n        -- Change data type from varchar to NUMBER(38,1)\n        \n    IFF(\n        rating IS NULL OR TRIM(rating) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))\n    )\n AS rating, \n      \n        -- Change data type from varchar to NUMBER(38,1)\n        \n    IFF(\n        weight IS NULL OR TRIM(weight) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))\n    )\n AS prod_weight, \n        \n        -- Change data type to NUMBER(38,2)\n        \n    IFF(\n        discounts IS NULL OR TRIM(discounts) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))\n    )\n AS discounts\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.426533Z", "completed_at": "2024-10-31T16:46:18.430839Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.431232Z", "completed_at": "2024-10-31T16:46:18.431241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061054229736328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_product_data_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.product_data\n\n),\n\nstaging_data as (\n\n    select\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n        \n        -- Extract warranty_period from varchar to NUMBER\n        \n    IFF(\n        warranty_period IS NULL OR TRIM(warranty_period) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)\n    )\n AS warranty_period_months, \n      \n        -- Converting to smaller string\n        CAST(product_name AS VARCHAR(64)) AS product_name,\n        CAST(product_category AS VARCHAR(64)) AS product_category,\n        CAST(product_color AS VARCHAR(64)) AS product_color,\n\n        price,\n        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       \n        manufacturing_date,\n        expiration_date,\n        quantity_in_stock,\n        rating,\n        sales_volume,\n        weight_grams,\n        discount_percentage\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.433397Z", "completed_at": "2024-10-31T16:46:18.437475Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.437861Z", "completed_at": "2024-10-31T16:46:18.437868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005495548248291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_user_data_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.user_data\n\n),\n\nstaging_data as (\n\n    select\n        user_id,\n        \n        -- Converting to short field\n        CAST(first_name AS VARCHAR(64)) AS first_name,\n        CAST(last_name AS VARCHAR(64)) AS last_name,\n        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,\n        CAST(account_status AS VARCHAR(64)) AS account_status,\n\n        -- Checking for invalid email id format \n        CASE \n            WHEN email not like '%_@__%.__%' THEN NULL \n            ELSE CAST(email AS VARCHAR(256)) \n        END AS email,\n\n        -- Convert signup_date from VARCHAR to DATE\n        \n    IFF(\n        signup_date IS NULL OR TRIM(signup_date) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(signup_date), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(signup_date) AS DATE), \n            NULL\n        )\n    )\n AS signup_date,\n\n        -- Convert dob from VARCHAR to DATE\n        \n    IFF(\n        dob IS NULL OR TRIM(dob) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(dob), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(dob) AS DATE), \n            NULL\n        )\n    )\n AS dob,\n\n         -- Convert marketing_opt_in from VARCHAR to BOOLEAN\n        CASE \n            WHEN marketing_opt_in = 'True' THEN TRUE\n            WHEN marketing_opt_in = 'False' THEN FALSE\n            ELSE False \n        END AS marketing_opt_in,\n\n        -- Convert loyalty_points_balance from VARCHAR to NUMBER\n        \n    IFF(\n        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)\n    )\n AS loyalty_points_balance\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.439843Z", "completed_at": "2024-10-31T16:46:18.442817Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.443191Z", "completed_at": "2024-10-31T16:46:18.443197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004300594329833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_user_journey_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.user_journey\n\n),\n\nstaging_data as (\n\n    select\n        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,\n        has_qv,\n        has_pdp,\n        has_atc,\n        has_purchase,\n        impressions_with_attributions,\n        cart_id,\n        CAST(session_id AS VARCHAR(64)) AS session_id,\n        search_request_id,\n        search_results_count,\n        CAST(search_terms AS VARCHAR(64)) AS search_terms,\n        CAST(search_feature AS VARCHAR(64)) AS search_feature,\n        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,\n        CAST(search_type AS VARCHAR(64)) AS search_type,\n        aes_hash,\n        date_last_purchase,\n        login_status,\n        CAST(user_id AS VARCHAR(64)) AS user_id,     \n        sha256_hash,\n        banner,  \n        fulfillment_type,\n        selected_timeslot_date,\n        selected_timeslot_time,\n        selected_timeslot_type,    \n        br_viewwidth,\n        br_viewheight,\n        dvce_screenwidth,\n        dvce_screenheight,\n        doc_width,\n        doc_height,\n        CAST(mkt_medium AS VARCHAR(64)) AS medium,\n        CAST(mkt_source AS VARCHAR(64)) AS source,\n        CAST(mkt_content AS VARCHAR(64)) AS content,\n        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     \n        geo_latitude AS latitude,\n        geo_longitude AS longitude,\n\n        -- Reformat data\n        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,\n\n        -- Convert dob from VARCHAR to DATE\n        \n    IFF(\n        date_last_login IS NULL OR TRIM(date_last_login) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(date_last_login), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(date_last_login) AS DATE), \n            NULL\n        )\n    )\n AS date_last_login,\n\n        -- converting to interger, as count can only be integer\n        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,\n        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,\n\n        -- converting id to integer number\n        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,\n        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,\n        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,\n        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,\n\n        -- Truncate the field to necessary length\n        CAST(registration_status AS VARCHAR(32)) AS registration_status,\n        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,\n        CAST(device_class AS VARCHAR(32)) AS device_class,\n        CAST(br_lang AS VARCHAR(32)) AS br_language,\n        CAST(page_language AS VARCHAR(32)) AS page_language,\n        CAST(geo_country AS VARCHAR(32)) AS country,\n        CAST(geo_region AS VARCHAR(32)) AS region,\n        CAST(geo_city AS VARCHAR(32)) AS city,\n        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,\n        CAST(search_model AS VARCHAR(32)) AS search_model,\n        CAST(geo_timezone AS VARCHAR(32)) AS timezone,\n\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n\n        -- Converting timestamp to\n        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,\n        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,\n     \n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.445076Z", "completed_at": "2024-10-31T16:46:18.456532Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.456905Z", "completed_at": "2024-10-31T16:46:18.456913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01275634765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_inv_detail_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu\n),\n\n\ninventory_data AS (\n   SELECT\n      md5(cast(coalesce(cast(storage_condition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(inventory_status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as inv_detail_id,\n      storage_condition,\n      inventory_status\n      \n   FROM source\n   GROUP BY storage_condition, inventory_status\n)\n\n\nSELECT * FROM inventory_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.459853Z", "completed_at": "2024-10-31T16:46:18.467536Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.468597Z", "completed_at": "2024-10-31T16:46:18.468615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010824441909790039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_product_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu\n),\n\nproduct_data AS (\n   SELECT\n   \n       product_id,\n       product_name,\n       product_category,\n       product_color,\n       supplier_id,\n       manufacturing_date,\n       expiration_date,\n       warranty_period_months\n   \n   FROM source\n)\n\n\nSELECT * FROM product_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_product_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.474262Z", "completed_at": "2024-10-31T16:46:18.481603Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.482337Z", "completed_at": "2024-10-31T16:46:18.482350Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01066446304321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_user_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n),\n\n\nuser_data AS (\n   SELECT\n      \n      user_id,\n      first_name,\n      last_name,\n      email,\n      signup_date,\n      preferred_language,\n      dob,\n      marketing_opt_in,\n      account_status,\n      loyalty_points_balance\n   FROM source\n   WHERE account_status = 'active'\n)\n\nSELECT * FROM user_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_user_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.485799Z", "completed_at": "2024-10-31T16:46:18.494273Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.494824Z", "completed_at": "2024-10-31T16:46:18.494833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010598897933959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_campaign_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\ncampaign_data AS (\n   SELECT\n      --ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS campaign_id,\n      md5(cast(coalesce(cast(campaign_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(medium as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(content as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS campaign_id,\n      campaign_name,\n      medium,\n      source,\n      content\n     \n   FROM source\n   GROUP BY campaign_name, medium, source, content\n)\n\nSELECT * FROM campaign_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.497579Z", "completed_at": "2024-10-31T16:46:18.559993Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.560364Z", "completed_at": "2024-10-31T16:46:18.560369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0639345645904541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_search_location_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\nsearch_location_data AS (\n   SELECT\n       \n      md5(cast(coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(city as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(region as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id, \n      country,\n      city,\n      region,\n      zipcode\n\n   FROM source\n   GROUP BY city, country, region, zipcode\n)\n\nselect * from search_location_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.562233Z", "completed_at": "2024-10-31T16:46:18.565225Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.565566Z", "completed_at": "2024-10-31T16:46:18.565572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004374980926513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_search_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\nsearch_data AS (\n   SELECT\n      \n     md5(cast(coalesce(cast(search_model as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_feature as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_terms_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as search_data_id,\n      search_model,  \n      search_type,\n      search_feature,\n      search_terms_type\n        \n   FROM source\n   GROUP BY search_model, \n            search_type, \n            search_feature, \n            search_terms_type\n)\n\n\nSELECT * FROM search_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_search_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.567332Z", "completed_at": "2024-10-31T16:46:18.570015Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.570336Z", "completed_at": "2024-10-31T16:46:18.570341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038568973541259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_inventory_management_qu", "compiled": true, "compiled_code": "\n\nWITH inventory_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu\n\n),\n\nproduct_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu \n\n),\n\ninv_detail AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\n),\n\ninventory_management AS (\n    SELECT\n    \n    id.inventory_id,\n    id.product_id,\n    id.warehouse_id,\n    id.supplier_id,\n    idt.inv_detail_id,\n\n    pd.price,\n    id.stock_level,\n    id.reorder_level,\n    id.quantity_in_stock,\n    id.sales_volume,\n    id.safety_stock,\n    id.average_monthly_demand,\n    id.rating,\n    id.prod_weight,\n    id.discounts,\n    last_audit_date,\n    last_restock_date,\n    restock_date,\n    next_restock_date\n                \n    FROM inventory_data id\n    INNER JOIN inv_detail idt \n        ON id.inventory_status = idt.storage_condition\n        AND idt.inventory_status = id.inventory_status\n    LEFT JOIN product_data pd ON id.product_id = pd.product_id\n)\n\nSELECT * FROM inventory_management\nWHERE price >= discounts", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.572068Z", "completed_at": "2024-10-31T16:46:18.580625Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.580941Z", "completed_at": "2024-10-31T16:46:18.580946Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00981450080871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        inventory_status as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\n    group by inventory_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'in-stock','backordered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.582524Z", "completed_at": "2024-10-31T16:46:18.588120Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.588441Z", "completed_at": "2024-10-31T16:46:18.588446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006636142730712891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inv_detail_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inv_detail_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.589890Z", "completed_at": "2024-10-31T16:46:18.592560Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.592867Z", "completed_at": "2024-10-31T16:46:18.592872Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036368370056152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_status\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inventory_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.594417Z", "completed_at": "2024-10-31T16:46:18.597945Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.598276Z", "completed_at": "2024-10-31T16:46:18.598281Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004581928253173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect storage_condition\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere storage_condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.599830Z", "completed_at": "2024-10-31T16:46:18.603895Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.604202Z", "completed_at": "2024-10-31T16:46:18.604207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005064964294433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    inv_detail_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inv_detail_id is not null\ngroup by inv_detail_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.605683Z", "completed_at": "2024-10-31T16:46:18.608444Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.608749Z", "completed_at": "2024-10-31T16:46:18.608754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037543773651123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.610176Z", "completed_at": "2024-10-31T16:46:18.612696Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.612996Z", "completed_at": "2024-10-31T16:46:18.613001Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034596920013427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.614442Z", "completed_at": "2024-10-31T16:46:18.616977Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.617277Z", "completed_at": "2024-10-31T16:46:18.617282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034928321838378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere supplier_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.618794Z", "completed_at": "2024-10-31T16:46:18.620726Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.621026Z", "completed_at": "2024-10-31T16:46:18.621031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029211044311523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_product_dates", "compiled": true, "compiled_code": "-- Test: Test that the manufacturing date is before the expiration date\n\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nWHERE\n    manufacturing_date > expiration_date\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.622445Z", "completed_at": "2024-10-31T16:46:18.625018Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.625329Z", "completed_at": "2024-10-31T16:46:18.625334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035381317138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.626875Z", "completed_at": "2024-10-31T16:46:18.631814Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.632104Z", "completed_at": "2024-10-31T16:46:18.632109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059278011322021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','in-active','suspended'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.633620Z", "completed_at": "2024-10-31T16:46:18.636344Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.636644Z", "completed_at": "2024-10-31T16:46:18.636649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037186145782470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect marketing_opt_in\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere marketing_opt_in is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.638055Z", "completed_at": "2024-10-31T16:46:18.640713Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.641012Z", "completed_at": "2024-10-31T16:46:18.641016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035898685455322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.642522Z", "completed_at": "2024-10-31T16:46:18.644469Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.644747Z", "completed_at": "2024-10-31T16:46:18.644752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002912282943725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_user_data", "compiled": true, "compiled_code": "-- Test: test_user_data\n-- Description: This test checks if the account_status in the dim_user_qu table is 'active',\n-- if the email in the dim_user_qu table is a valid email address, and if the loyalty_points_balance\n-- in the dim_user_qu table is greater than or equal to 0.\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nWHERE\n    account_status != 'active'\n    OR NOT REGEXP_LIKE(email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$')\n    OR loyalty_points_balance < 0\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.646239Z", "completed_at": "2024-10-31T16:46:18.648871Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.649158Z", "completed_at": "2024-10-31T16:46:18.649162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036017894744873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.650680Z", "completed_at": "2024-10-31T16:46:18.653442Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.653772Z", "completed_at": "2024-10-31T16:46:18.653777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037953853607177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_campaign_effectiveness_qu", "compiled": true, "compiled_code": "\n\nWITH user_journey AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n),\n\nvalid_users as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n   WHERE account_status = 'active'\n\n),\n\nproduct_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu \n),\n\ncampaign_dim AS (\n   SELECT * FROM BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\n),\n\nfilteirng AS (\n   SELECT\n      \n      p.price,\n      uj.has_purchase,\n      uj.has_atc,\n      uj.has_pdp,\n      uj.has_qv,\n      uj.product_id,\n      uj.user_id,\n      cd.campaign_id -- Foreign key from dim_campaign\n    \n   FROM user_journey uj\n   INNER JOIN campaign_dim cd\n     ON uj.campaign_name = cd.campaign_name\n    AND uj.medium = cd.medium\n    AND uj.source = cd.source\n    AND uj.content = cd.content\n\n   INNER JOIN valid_users vu \n     ON uj.user_id = vu.user_id\n   \n   LEFT JOIN product_data p\n     ON uj.product_id = p.product_id\n   \n   GROUP BY \n      cd.campaign_id,\n      uj.product_id, \n      uj.user_id,\n      p.price,\n      uj.has_purchase,\n      uj.has_atc,\n      uj.has_pdp,\n      uj.has_qv\n\n),\n\nfinal AS (\n    SELECT\n       \n      campaign_id,\n      product_id,\n      price AS product_price,\n      SUM(CASE WHEN has_purchase = TRUE THEN 1 ELSE 0 END) AS total_unit_sold,\n      SUM(CASE WHEN has_atc = TRUE THEN 1 ELSE 0 END) AS total_atc,\n      SUM(CASE WHEN has_qv = TRUE THEN 1 ELSE 0 END) AS total_qv,\n      SUM(CASE WHEN has_pdp = TRUE THEN 1 ELSE 0 END) AS total_pdp,\n      user_id\n\n    FROM filteirng\n    GROUP BY \n      campaign_id,\n      product_id,\n      user_id,\n      price\n      \n)\n\n\n\nSELECT * FROM final", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.655490Z", "completed_at": "2024-10-31T16:46:18.658141Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.658438Z", "completed_at": "2024-10-31T16:46:18.658443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037679672241210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.659933Z", "completed_at": "2024-10-31T16:46:18.662452Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.662754Z", "completed_at": "2024-10-31T16:46:18.662759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003499746322631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_name\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.664235Z", "completed_at": "2024-10-31T16:46:18.667834Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.668140Z", "completed_at": "2024-10-31T16:46:18.668145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004623889923095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.669654Z", "completed_at": "2024-10-31T16:46:18.672450Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.672754Z", "completed_at": "2024-10-31T16:46:18.672759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037789344787597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect medium\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere medium is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.674185Z", "completed_at": "2024-10-31T16:46:18.676739Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.677034Z", "completed_at": "2024-10-31T16:46:18.677039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034983158111572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere source is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.678457Z", "completed_at": "2024-10-31T16:46:18.680278Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.680584Z", "completed_at": "2024-10-31T16:46:18.680589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027666091918945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_campagin_combinations", "compiled": true, "compiled_code": "-- checking for all combinations of fields are unique\nSELECT\n    campaign_name,\n    medium,\n    source,\n    content,\n    COUNT(*) AS count\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nGROUP BY\n    campaign_name,\n    medium,\n    source,\n    content\nHAVING\n   count > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.682091Z", "completed_at": "2024-10-31T16:46:18.684677Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.684977Z", "completed_at": "2024-10-31T16:46:18.684982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035598278045654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    campaign_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_id is not null\ngroup by campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.686406Z", "completed_at": "2024-10-31T16:46:18.688870Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.689169Z", "completed_at": "2024-10-31T16:46:18.689173Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003402233123779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere city is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.690676Z", "completed_at": "2024-10-31T16:46:18.693204Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.693516Z", "completed_at": "2024-10-31T16:46:18.693521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003524303436279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere country is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.694936Z", "completed_at": "2024-10-31T16:46:18.698547Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.698853Z", "completed_at": "2024-10-31T16:46:18.698858Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0045626163482666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.700351Z", "completed_at": "2024-10-31T16:46:18.702898Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.703221Z", "completed_at": "2024-10-31T16:46:18.703226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035545825958251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere region is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.704758Z", "completed_at": "2024-10-31T16:46:18.707471Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.707771Z", "completed_at": "2024-10-31T16:46:18.707775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003705263137817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect zipcode\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere zipcode is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.709199Z", "completed_at": "2024-10-31T16:46:18.711671Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.711971Z", "completed_at": "2024-10-31T16:46:18.711975Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034027099609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.713513Z", "completed_at": "2024-10-31T16:46:18.716164Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.716483Z", "completed_at": "2024-10-31T16:46:18.716487Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037240982055664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_search_product_performance_qu", "compiled": true, "compiled_code": "\n\n\nwith user_journey as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu \n),\n\nvalid_users as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n   WHERE account_status = 'active'\n\n),\n\nproducts as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu   \n),\n\nsearch_data as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\n),\n\nsearch_loc as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\n),\n\nfinal AS (\n   SELECT\n  \n      uj.search_event_id,\n      uj.user_id,\n      uj.product_id,\n      sd.search_data_id,\n      sl.location_id,\n\n      uj.search_terms,\n      uj.search_results_count,\n      uj.search_timestamp, \n      \n      vp.price,\n      vp.rating,\n      vp.sales_volume,\n      vp.discount_percentage,\n      vp.weight_grams,\n      \n      uj.has_qv,\n      uj.has_pdp,\n      uj.has_atc,\n      uj.has_purchase\n\n   FROM user_journey uj\n   INNER JOIN search_data sd \n      ON uj.search_model = sd.search_model\n      AND uj.search_type = sd.search_type\n      AND uj.search_feature = sd.search_feature\n      AND uj.search_terms_type = sd.search_terms_type\n   INNER JOIN search_loc sl\n      ON uj.country = sl.country\n      AND uj.city = sl.city\n      AND uj.region = sl.region\n      AND uj.zipcode = sl.zipcode   \n\n   INNER JOIN valid_users vu ON uj.user_id = vu.user_id\n   LEFT JOIN products vp ON uj.product_id = vp.product_id\n   \n)\n\n\nSELECT * FROM final", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.718123Z", "completed_at": "2024-10-31T16:46:18.721661Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.721950Z", "completed_at": "2024-10-31T16:46:18.721955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00463414192199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        search_terms_type as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\n    group by search_terms_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'manual-search','type-ahead'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.723372Z", "completed_at": "2024-10-31T16:46:18.726046Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.726347Z", "completed_at": "2024-10-31T16:46:18.726351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003620624542236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_data_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_data_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.727890Z", "completed_at": "2024-10-31T16:46:18.731338Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.731648Z", "completed_at": "2024-10-31T16:46:18.731653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004538774490356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_feature\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_feature is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.733128Z", "completed_at": "2024-10-31T16:46:18.735735Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.736042Z", "completed_at": "2024-10-31T16:46:18.736047Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003641843795776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_model\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_model is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.737584Z", "completed_at": "2024-10-31T16:46:18.740192Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.740526Z", "completed_at": "2024-10-31T16:46:18.740531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036323070526123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_type\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.743684Z", "completed_at": "2024-10-31T16:46:18.752601Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.753344Z", "completed_at": "2024-10-31T16:46:18.753355Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012022256851196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    search_data_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_data_id is not null\ngroup by search_data_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.756698Z", "completed_at": "2024-10-31T16:46:18.762912Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.763447Z", "completed_at": "2024-10-31T16:46:18.763455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008273124694824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inv_detail_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere inv_detail_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.765728Z", "completed_at": "2024-10-31T16:46:18.769833Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.770303Z", "completed_at": "2024-10-31T16:46:18.770311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005637407302856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere inventory_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.772743Z", "completed_at": "2024-10-31T16:46:18.776064Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.777139Z", "completed_at": "2024-10-31T16:46:18.777156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005730390548706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.782136Z", "completed_at": "2024-10-31T16:46:18.793645Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.794414Z", "completed_at": "2024-10-31T16:46:18.794424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01456451416015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere supplier_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.797498Z", "completed_at": "2024-10-31T16:46:18.803101Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.803756Z", "completed_at": "2024-10-31T16:46:18.803766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007683277130126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect warehouse_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere warehouse_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.806047Z", "completed_at": "2024-10-31T16:46:18.808877Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.809325Z", "completed_at": "2024-10-31T16:46:18.809332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0042836666107177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fim_price_discount", "compiled": true, "compiled_code": "-- Testing for the presence if price is greater than discounts in fact_inventory_management_qu\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nWHERE\n    price < discounts\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.811518Z", "completed_at": "2024-10-31T16:46:18.815131Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.815456Z", "completed_at": "2024-10-31T16:46:18.815462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004904508590698242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.816993Z", "completed_at": "2024-10-31T16:46:18.819682Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.819987Z", "completed_at": "2024-10-31T16:46:18.819992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036864280700683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.821480Z", "completed_at": "2024-10-31T16:46:18.824184Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.824500Z", "completed_at": "2024-10-31T16:46:18.824505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003707408905029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_price\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere product_price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.825934Z", "completed_at": "2024-10-31T16:46:18.828551Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.828854Z", "completed_at": "2024-10-31T16:46:18.828859Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035686492919921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.830361Z", "completed_at": "2024-10-31T16:46:18.832420Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.832704Z", "completed_at": "2024-10-31T16:46:18.832709Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030231475830078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fce_campaign_id", "compiled": true, "compiled_code": "-- Testing for the presence of campaign_id in fact_campaign_effectiveness_qu\nSELECT\n    fce.campaign_id\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce\nLEFT JOIN\n    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu dc\nON\n    fce.campaign_id = dc.campaign_id\nWHERE\n    dc.campaign_id IS NULL", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.834206Z", "completed_at": "2024-10-31T16:46:18.837196Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.837519Z", "completed_at": "2024-10-31T16:46:18.837523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003981828689575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fce_product_id", "compiled": true, "compiled_code": "-- This test checks if the product_id in the fact_campaign_effectiveness_qu\n-- table is present in the stg_product_data_qu table and if the product_price\n-- in the fact_campaign_effectiveness_qu table is the same as the price in the\n-- stg_product_data_qu table.\n-- The test will fail if the product_id is not present in the stg_product_data_qu\n-- table or if the product_price in the fact_campaign_effectiveness_qu table is\n-- not the same as the price in the stg_product_data_qu table.\n\nSELECT\n    fce.product_id,\n    fce.product_price AS fce_price,\n    spd.price AS spd_price\nFROM BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce\n    \nLEFT JOIN BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu spd\nON\n    fce.product_id = spd.product_id\nWHERE\n    spd.product_id IS NULL\n    OR fce.product_price != spd.price", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.838948Z", "completed_at": "2024-10-31T16:46:18.841444Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.841736Z", "completed_at": "2024-10-31T16:46:18.841741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034406185150146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.843197Z", "completed_at": "2024-10-31T16:46:18.845870Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.846159Z", "completed_at": "2024-10-31T16:46:18.846163Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036468505859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.847693Z", "completed_at": "2024-10-31T16:46:18.850438Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.850728Z", "completed_at": "2024-10-31T16:46:18.850732Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037431716918945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_data_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere search_data_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.852260Z", "completed_at": "2024-10-31T16:46:18.854831Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.855115Z", "completed_at": "2024-10-31T16:46:18.855119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035326480865478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_event_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere search_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.856558Z", "completed_at": "2024-10-31T16:46:18.859122Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.859451Z", "completed_at": "2024-10-31T16:46:18.859456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036191940307617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T16:46:18.860966Z", "completed_at": "2024-10-31T16:46:18.862981Z"}, {"name": "execute", "started_at": "2024-10-31T16:46:18.863292Z", "completed_at": "2024-10-31T16:46:18.863297Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003016233444213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fspp_data", "compiled": true, "compiled_code": "-- Test: test_fspp_data\n-- Description: This test checks if the user_id in the fact_search_product_performance_qu\n-- table is present in the dim_user_qu table and if the discount_percentage in the\n-- fact_search_product_performance_qu table is between 0 and 100, given the account_status\n-- in the dim_user_qu table is 'active'.\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu fsp\nJOIN\n    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu du\nON\n    fsp.user_id = du.user_id\nWHERE\n    (discount_percentage < 0 OR discount_percentage > 100)\n    OR du.account_status != 'active'\nHAVING\n    invalid_rows > 0", "relation_name": null}], "elapsed_time": 4.260264158248901, "args": {"compile": true, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "print": true, "exclude": [], "static": false, "log_level": "info", "cache_selected_only": false, "macro_debugging": false, "profiles_dir": "/home/user/.dbt", "use_colors": true, "invocation_command": "dbt docs generate", "log_format_file": "debug", "populate_cache": true, "quiet": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "static_parser": true, "use_colors_file": true, "introspect": true, "printer_width": 80, "show_resource_report": false, "defer": false, "partial_parse_file_diff": true, "log_path": "/home/user/Documents/AirflowSnowflakeProject/dbt/logs", "vars": {}, "version_check": true, "favor_state": false, "indirect_selection": "eager", "select": [], "strict_mode": false, "empty_catalog": false, "enable_legacy_logger": false, "which": "generate", "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "send_anonymous_usage_stats": true, "project_dir": "/home/user/Documents/AirflowSnowflakeProject/dbt", "require_resource_names_without_spaces": false, "log_file_max_bytes": 10485760}}