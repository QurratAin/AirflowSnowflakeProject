{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2024-10-31T20:35:41.011779Z", "invocation_id": "8e33a1e1-ffaa-41d5-9d43-3085ef519800", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.562699Z", "completed_at": "2024-10-31T20:35:40.590914Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.591829Z", "completed_at": "2024-10-31T20:35:40.591857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03183746337890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_inventory_data_qu", "compiled": true, "compiled_code": "\n\n\nwith source as (\n\n    select * from brave_database.de_project.inventory_data\n\n),\n\nstaging_data as (\n\n    select\n        inventory_id,\n        warehouse_id,\n        stock_level,\n        restock_date,\n        supplier_id,\n        CAST(storage_condition AS VARCHAR(64)) AS storage_condition,\n        CAST(inventory_status AS VARCHAR(64)) AS inventory_status,\n        reorder_level,\n        quantity_in_stock,\n        sales_volume,\n        safety_stock,\n        average_monthly_demand,\n        last_restock_date,\n        next_restock_date,\n\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n        \n        -- Extract last audit date from timestamp and\n        -- convert to date format\n        CAST(last_audit_date AS DATE) AS last_audit_date, \n\n        -- Change data type from varchar to NUMBER(38,1)\n        \n    IFF(\n        rating IS NULL OR TRIM(rating) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(rating), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 1))\n    )\n AS rating, \n      \n        -- Change data type from varchar to NUMBER(38,1)\n        \n    IFF(\n        weight IS NULL OR TRIM(weight) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(weight), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))\n    )\n AS prod_weight, \n        \n        -- Change data type to NUMBER(38,2)\n        \n    IFF(\n        discounts IS NULL OR TRIM(discounts) = '', \n        0, \n        TRY_CAST(REPLACE(REGEXP_REPLACE(TRIM(discounts), '[^0-9,]', ''), ',', '.') AS NUMBER(38, 2))\n    )\n AS discounts\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.595571Z", "completed_at": "2024-10-31T20:35:40.602161Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.602752Z", "completed_at": "2024-10-31T20:35:40.602765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008848428726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_product_data_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.product_data\n\n),\n\nstaging_data as (\n\n    select\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n        \n        -- Extract warranty_period from varchar to NUMBER\n        \n    IFF(\n        warranty_period IS NULL OR TRIM(warranty_period) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(warranty_period, '[^0-9.]', '') AS NUMBER)\n    )\n AS warranty_period_months, \n      \n        -- Converting to smaller string\n        CAST(product_name AS VARCHAR(64)) AS product_name,\n        CAST(product_category AS VARCHAR(64)) AS product_category,\n        CAST(product_color AS VARCHAR(64)) AS product_color,\n\n        price,\n        CAST(supplier_id AS VARCHAR(64)) AS supplier_id,       \n        manufacturing_date,\n        expiration_date,\n        quantity_in_stock,\n        rating,\n        sales_volume,\n        weight_grams,\n        discount_percentage\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.605535Z", "completed_at": "2024-10-31T20:35:40.611294Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.611772Z", "completed_at": "2024-10-31T20:35:40.611779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0076558589935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_user_data_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.user_data\n\n),\n\nstaging_data as (\n\n    select\n        user_id,\n        \n        -- Converting to short field\n        CAST(first_name AS VARCHAR(64)) AS first_name,\n        CAST(last_name AS VARCHAR(64)) AS last_name,\n        CAST(preferred_language AS VARCHAR(64)) AS preferred_language,\n        CAST(account_status AS VARCHAR(64)) AS account_status,\n\n        -- Checking for invalid email id format \n        CASE \n            WHEN email not like '%_@__%.__%' THEN NULL \n            ELSE CAST(email AS VARCHAR(256)) \n        END AS email,\n\n        -- Convert signup_date from VARCHAR to DATE\n        \n    IFF(\n        signup_date IS NULL OR TRIM(signup_date) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(signup_date), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(signup_date) AS DATE), \n            NULL\n        )\n    )\n AS signup_date,\n\n        -- Convert dob from VARCHAR to DATE\n        \n    IFF(\n        dob IS NULL OR TRIM(dob) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(dob), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(dob) AS DATE), \n            NULL\n        )\n    )\n AS dob,\n\n         -- Convert marketing_opt_in from VARCHAR to BOOLEAN\n        CASE \n            WHEN marketing_opt_in = 'True' THEN TRUE\n            WHEN marketing_opt_in = 'False' THEN FALSE\n            ELSE False \n        END AS marketing_opt_in,\n\n        -- Convert loyalty_points_balance from VARCHAR to NUMBER\n        \n    IFF(\n        loyalty_points_balance IS NULL OR TRIM(loyalty_points_balance) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(loyalty_points_balance, '[^0-9.]', '') AS NUMBER)\n    )\n AS loyalty_points_balance\n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.616210Z", "completed_at": "2024-10-31T20:35:40.625107Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.626064Z", "completed_at": "2024-10-31T20:35:40.626080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012427091598510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.stg_user_journey_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from brave_database.de_project.user_journey\n\n),\n\nstaging_data as (\n\n    select\n        CAST(search_event_id AS VARCHAR(64)) AS search_event_id,\n        has_qv,\n        has_pdp,\n        has_atc,\n        has_purchase,\n        impressions_with_attributions,\n        cart_id,\n        CAST(session_id AS VARCHAR(64)) AS session_id,\n        search_request_id,\n        search_results_count,\n        CAST(search_terms AS VARCHAR(64)) AS search_terms,\n        CAST(search_feature AS VARCHAR(64)) AS search_feature,\n        CAST(search_terms_type AS VARCHAR(64)) AS search_terms_type,\n        CAST(search_type AS VARCHAR(64)) AS search_type,\n        aes_hash,\n        date_last_purchase,\n        login_status,\n        CAST(user_id AS VARCHAR(64)) AS user_id,     \n        sha256_hash,\n        banner,  \n        fulfillment_type,\n        selected_timeslot_date,\n        selected_timeslot_time,\n        selected_timeslot_type,    \n        br_viewwidth,\n        br_viewheight,\n        dvce_screenwidth,\n        dvce_screenheight,\n        doc_width,\n        doc_height,\n        CAST(mkt_medium AS VARCHAR(64)) AS medium,\n        CAST(mkt_source AS VARCHAR(64)) AS source,\n        CAST(mkt_content AS VARCHAR(64)) AS content,\n        CAST(mkt_campaign AS VARCHAR(64)) AS campaign_name,     \n        geo_latitude AS latitude,\n        geo_longitude AS longitude,\n\n        -- Reformat data\n        CAST(REGEXP_REPLACE(app_id, '-prod$', '') AS VARCHAR(32)) AS app_id,\n\n        -- Convert dob from VARCHAR to DATE\n        \n    IFF(\n        date_last_login IS NULL OR TRIM(date_last_login) = '', \n        NULL, \n        IFF(\n            REGEXP_LIKE(TRIM(date_last_login), '^\\d{4}-\\d{2}-\\d{2}$'), \n            TRY_CAST(TRIM(date_last_login) AS DATE), \n            NULL\n        )\n    )\n AS date_last_login,\n\n        -- converting to interger, as count can only be integer\n        CAST(lifetime_offline_orders_count AS NUMBER(38, 0)) AS lifetime_offline_orders_count,\n        CAST(lifetime_online_orders_count AS NUMBER(38, 0)) AS lifetime_online_orders_count,\n\n        -- converting id to integer number\n        CAST(auto_localized_store_id AS NUMBER(38, 0)) AS auto_localized_store_id,\n        CAST(rx_home_store_id AS NUMBER(38, 0)) AS rx_home_store_id,\n        CAST(selected_store_id AS NUMBER(38, 0)) AS selected_store_id,\n        CAST(grocery_home_store_id AS NUMBER(38, 0)) AS grocery_home_store_id,\n\n        -- Truncate the field to necessary length\n        CAST(registration_status AS VARCHAR(32)) AS registration_status,\n        CAST(shopping_mode AS VARCHAR(32)) AS shopping_mode,\n        CAST(device_class AS VARCHAR(32)) AS device_class,\n        CAST(br_lang AS VARCHAR(32)) AS br_language,\n        CAST(page_language AS VARCHAR(32)) AS page_language,\n        CAST(geo_country AS VARCHAR(32)) AS country,\n        CAST(geo_region AS VARCHAR(32)) AS region,\n        CAST(geo_city AS VARCHAR(32)) AS city,\n        CAST(geo_zipcode AS VARCHAR(32)) AS zipcode,\n        CAST(search_model AS VARCHAR(32)) AS search_model,\n        CAST(geo_timezone AS VARCHAR(32)) AS timezone,\n\n        -- Extract product id from varchar string and cast to NUMBER\n        \n    IFF(\n        product_id IS NULL OR TRIM(product_id) = '', \n        0, \n        TRY_CAST(REGEXP_REPLACE(product_id, '[^0-9.]', '') AS NUMBER)\n    )\n AS product_id, \n\n        -- Converting timestamp to\n        to_timestamp(replace(timestamp, ' UTC', '')) AS search_timestamp,\n        to_timestamp(replace(collector_tstamp, ' UTC', '')) AS collector_tstamp,\n     \n\n    from source\n\n)\n\nselect * from staging_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.630922Z", "completed_at": "2024-10-31T20:35:40.649742Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.650232Z", "completed_at": "2024-10-31T20:35:40.650241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02156853675842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_inv_detail_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu\n),\n\n\ninventory_data AS (\n   SELECT\n      md5(cast(coalesce(cast(storage_condition as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(inventory_status as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as inv_detail_id,\n      storage_condition,\n      inventory_status\n      \n   FROM source\n   GROUP BY storage_condition, inventory_status\n)\n\n\nSELECT * FROM inventory_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.652758Z", "completed_at": "2024-10-31T20:35:40.655511Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.655870Z", "completed_at": "2024-10-31T20:35:40.655876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0043070316314697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_product_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu\n),\n\nproduct_data AS (\n   SELECT\n   \n       product_id,\n       product_name,\n       product_category,\n       product_color,\n       supplier_id,\n       manufacturing_date,\n       expiration_date,\n       warranty_period_months\n   \n   FROM source\n)\n\n\nSELECT * FROM product_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_product_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.657801Z", "completed_at": "2024-10-31T20:35:40.660418Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.660777Z", "completed_at": "2024-10-31T20:35:40.660784Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003918170928955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_user_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n),\n\n\nuser_data AS (\n   SELECT\n      \n      user_id,\n      first_name,\n      last_name,\n      email,\n      signup_date,\n      preferred_language,\n      dob,\n      marketing_opt_in,\n      account_status,\n      loyalty_points_balance\n   FROM source\n   WHERE account_status = 'active'\n)\n\nSELECT * FROM user_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_user_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.662685Z", "completed_at": "2024-10-31T20:35:40.667252Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.667619Z", "completed_at": "2024-10-31T20:35:40.667625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005855083465576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_campaign_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\ncampaign_data AS (\n   SELECT\n      --ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS campaign_id,\n      md5(cast(coalesce(cast(campaign_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(medium as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(source as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(content as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS campaign_id,\n      campaign_name,\n      medium,\n      source,\n      content\n     \n   FROM source\n   GROUP BY campaign_name, medium, source, content\n)\n\nSELECT * FROM campaign_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.669658Z", "completed_at": "2024-10-31T20:35:40.672879Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.673235Z", "completed_at": "2024-10-31T20:35:40.673241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0045816898345947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_search_location_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\nsearch_location_data AS (\n   SELECT\n       \n      md5(cast(coalesce(cast(country as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(city as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(region as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(zipcode as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as location_id, \n      country,\n      city,\n      region,\n      zipcode\n\n   FROM source\n   GROUP BY city, country, region, zipcode\n)\n\nselect * from search_location_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.675120Z", "completed_at": "2024-10-31T20:35:40.678281Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.678659Z", "completed_at": "2024-10-31T20:35:40.678666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004450559616088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.dim_search_qu", "compiled": true, "compiled_code": "\n\nwith source as (\n\n   select * from  BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n\n),\n\nsearch_data AS (\n   SELECT\n      \n     md5(cast(coalesce(cast(search_model as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_type as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_feature as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(search_terms_type as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as search_data_id,\n      search_model,  \n      search_type,\n      search_feature,\n      search_terms_type\n        \n   FROM source\n   GROUP BY search_model, \n            search_type, \n            search_feature, \n            search_terms_type\n)\n\n\nSELECT * FROM search_data", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.dim_search_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.680565Z", "completed_at": "2024-10-31T20:35:40.683414Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.683765Z", "completed_at": "2024-10-31T20:35:40.683771Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004132986068725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_inventory_management_qu", "compiled": true, "compiled_code": "\n\nWITH inventory_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_inventory_data_qu\n\n),\n\nproduct_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu \n\n),\n\ninv_detail AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\n),\n\ninventory_management AS (\n    SELECT\n    \n    id.inventory_id,\n    id.product_id,\n    id.warehouse_id,\n    id.supplier_id,\n    idt.inv_detail_id,\n\n    pd.price,\n    id.stock_level,\n    id.reorder_level,\n    id.quantity_in_stock,\n    id.sales_volume,\n    id.safety_stock,\n    id.average_monthly_demand,\n    id.rating,\n    id.prod_weight,\n    id.discounts,\n    last_audit_date,\n    last_restock_date,\n    restock_date,\n    next_restock_date\n                \n    FROM inventory_data id\n    INNER JOIN inv_detail idt \n        ON id.inventory_status = idt.storage_condition\n        AND idt.inventory_status = id.inventory_status\n    LEFT JOIN product_data pd ON id.product_id = pd.product_id\n)\n\nSELECT * FROM inventory_management\nWHERE price >= discounts", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.685653Z", "completed_at": "2024-10-31T20:35:40.694800Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.695166Z", "completed_at": "2024-10-31T20:35:40.695172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010434389114379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_inv_detail_qu_inventory_status__in_stock__backordered.36dd0377d8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        inventory_status as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\n    group by inventory_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'in-stock','backordered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.696822Z", "completed_at": "2024-10-31T20:35:40.702994Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.703334Z", "completed_at": "2024-10-31T20:35:40.703340Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0072727203369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inv_detail_id.5972377620", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inv_detail_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inv_detail_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.704971Z", "completed_at": "2024-10-31T20:35:40.708788Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.709097Z", "completed_at": "2024-10-31T20:35:40.709103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004862785339355469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_inventory_status.5b424e943e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_status\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inventory_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.710719Z", "completed_at": "2024-10-31T20:35:40.713540Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.713851Z", "completed_at": "2024-10-31T20:35:40.713857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003861665725708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_inv_detail_qu_storage_condition.46b21294fc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect storage_condition\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere storage_condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.715436Z", "completed_at": "2024-10-31T20:35:40.719673Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.719980Z", "completed_at": "2024-10-31T20:35:40.719986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005277395248413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_inv_detail_qu_inv_detail_id.d8f934f7d8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    inv_detail_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_inv_detail_qu\nwhere inv_detail_id is not null\ngroup by inv_detail_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.721565Z", "completed_at": "2024-10-31T20:35:40.724408Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.724716Z", "completed_at": "2024-10-31T20:35:40.724721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038743019104003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_product_id.f1215dbc53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.726280Z", "completed_at": "2024-10-31T20:35:40.729025Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.729360Z", "completed_at": "2024-10-31T20:35:40.729366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037941932678222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_product_name.72b5fb1cc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.730941Z", "completed_at": "2024-10-31T20:35:40.733687Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.733991Z", "completed_at": "2024-10-31T20:35:40.733996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003763437271118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_product_qu_supplier_id.a9eb939514", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere supplier_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.735597Z", "completed_at": "2024-10-31T20:35:40.737551Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.737851Z", "completed_at": "2024-10-31T20:35:40.737856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029838085174560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_product_dates", "compiled": true, "compiled_code": "-- Test: Test that the manufacturing date is before the expiration date\n\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nWHERE\n    manufacturing_date > expiration_date\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.739372Z", "completed_at": "2024-10-31T20:35:40.742995Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.743327Z", "completed_at": "2024-10-31T20:35:40.743332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004659414291381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_product_qu_product_id.47d39ecd3e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_product_qu\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.744902Z", "completed_at": "2024-10-31T20:35:40.814545Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.814912Z", "completed_at": "2024-10-31T20:35:40.814917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07073283195495605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_user_qu_account_status__active__in_active__suspended.c981bae45d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','in-active','suspended'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.816425Z", "completed_at": "2024-10-31T20:35:40.819053Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.819363Z", "completed_at": "2024-10-31T20:35:40.819368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036182403564453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_user_qu_marketing_opt_in.2dfa36a459", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect marketing_opt_in\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere marketing_opt_in is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.820897Z", "completed_at": "2024-10-31T20:35:40.823569Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.823887Z", "completed_at": "2024-10-31T20:35:40.823893Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003696918487548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_user_qu_user_id.0cc00a35f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.825425Z", "completed_at": "2024-10-31T20:35:40.827473Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.827791Z", "completed_at": "2024-10-31T20:35:40.827796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032007694244384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_user_data", "compiled": true, "compiled_code": "-- Test: test_user_data\n-- Description: This test checks if the account_status in the dim_user_qu table is 'active',\n-- if the email in the dim_user_qu table is a valid email address, and if the loyalty_points_balance\n-- in the dim_user_qu table is greater than or equal to 0.\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nWHERE\n    account_status != 'active'\n    OR NOT REGEXP_LIKE(email, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$')\n    OR loyalty_points_balance < 0\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.829407Z", "completed_at": "2024-10-31T20:35:40.831970Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.832274Z", "completed_at": "2024-10-31T20:35:40.832279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003549814224243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_user_qu_user_id.7d3aef83cc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_user_qu\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.833721Z", "completed_at": "2024-10-31T20:35:40.836424Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.836734Z", "completed_at": "2024-10-31T20:35:40.836739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003668069839477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_campaign_effectiveness_qu", "compiled": true, "compiled_code": "\n\nWITH user_journey AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu\n),\n\nvalid_users as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n   WHERE account_status = 'active'\n\n),\n\nproduct_data AS (\n\n    select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu \n),\n\ncampaign_dim AS (\n   SELECT * FROM BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\n),\n\nfilteirng AS (\n   SELECT\n      \n      p.price,\n      uj.has_purchase,\n      uj.has_atc,\n      uj.has_pdp,\n      uj.has_qv,\n      uj.product_id,\n      uj.user_id,\n      cd.campaign_id -- Foreign key from dim_campaign\n    \n   FROM user_journey uj\n   INNER JOIN campaign_dim cd\n     ON uj.campaign_name = cd.campaign_name\n    AND uj.medium = cd.medium\n    AND uj.source = cd.source\n    AND uj.content = cd.content\n\n   INNER JOIN valid_users vu \n     ON uj.user_id = vu.user_id\n   \n   LEFT JOIN product_data p\n     ON uj.product_id = p.product_id\n   \n   GROUP BY \n      cd.campaign_id,\n      uj.product_id, \n      uj.user_id,\n      p.price,\n      uj.has_purchase,\n      uj.has_atc,\n      uj.has_pdp,\n      uj.has_qv\n\n),\n\nfinal AS (\n    SELECT\n       \n      campaign_id,\n      product_id,\n      price AS product_price,\n      SUM(CASE WHEN has_purchase = TRUE THEN 1 ELSE 0 END) AS total_unit_sold,\n      SUM(CASE WHEN has_atc = TRUE THEN 1 ELSE 0 END) AS total_atc,\n      SUM(CASE WHEN has_qv = TRUE THEN 1 ELSE 0 END) AS total_qv,\n      SUM(CASE WHEN has_pdp = TRUE THEN 1 ELSE 0 END) AS total_pdp,\n      user_id\n\n    FROM filteirng\n    GROUP BY \n      campaign_id,\n      product_id,\n      user_id,\n      price\n      \n)\n\n\n\nSELECT * FROM final", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.838411Z", "completed_at": "2024-10-31T20:35:40.841054Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.841401Z", "completed_at": "2024-10-31T20:35:40.841407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003831624984741211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_id.2858aa15d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.842933Z", "completed_at": "2024-10-31T20:35:40.846495Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.846823Z", "completed_at": "2024-10-31T20:35:40.846828Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004590272903442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_campaign_name.9a0f3a9672", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_name\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.848346Z", "completed_at": "2024-10-31T20:35:40.850993Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.851287Z", "completed_at": "2024-10-31T20:35:40.851292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036144256591796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_content.1b894eb892", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect content\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere content is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.852825Z", "completed_at": "2024-10-31T20:35:40.855541Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.855864Z", "completed_at": "2024-10-31T20:35:40.855870Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038080215454101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_medium.a3dd14680b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect medium\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere medium is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.857386Z", "completed_at": "2024-10-31T20:35:40.860006Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.860323Z", "completed_at": "2024-10-31T20:35:40.860329Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036344528198242188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_campaign_qu_source.09bf6683d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere source is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.861866Z", "completed_at": "2024-10-31T20:35:40.863808Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.864097Z", "completed_at": "2024-10-31T20:35:40.864102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029184818267822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_campagin_combinations", "compiled": true, "compiled_code": "-- checking for all combinations of fields are unique\nSELECT\n    campaign_name,\n    medium,\n    source,\n    content,\n    COUNT(*) AS count\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nGROUP BY\n    campaign_name,\n    medium,\n    source,\n    content\nHAVING\n   count > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.865610Z", "completed_at": "2024-10-31T20:35:40.868191Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.868533Z", "completed_at": "2024-10-31T20:35:40.868538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036191940307617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_campaign_qu_campaign_id.bc388bd6d2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    campaign_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu\nwhere campaign_id is not null\ngroup by campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.870066Z", "completed_at": "2024-10-31T20:35:40.872879Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.873200Z", "completed_at": "2024-10-31T20:35:40.873205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038335323333740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_city.6681221a42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere city is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.874688Z", "completed_at": "2024-10-31T20:35:40.878315Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.878646Z", "completed_at": "2024-10-31T20:35:40.878652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004634857177734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_country.14d26ed1af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect country\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere country is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.880158Z", "completed_at": "2024-10-31T20:35:40.882725Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.883020Z", "completed_at": "2024-10-31T20:35:40.883025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003559112548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_location_id.4c3bc271ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.884436Z", "completed_at": "2024-10-31T20:35:40.887022Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.887320Z", "completed_at": "2024-10-31T20:35:40.887325Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035483837127685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_region.d462d40de6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere region is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.888734Z", "completed_at": "2024-10-31T20:35:40.891372Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.891709Z", "completed_at": "2024-10-31T20:35:40.891714Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003634214401245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_location_qu_zipcode.a823f32ea6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect zipcode\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere zipcode is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.893205Z", "completed_at": "2024-10-31T20:35:40.895867Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.896183Z", "completed_at": "2024-10-31T20:35:40.896188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003666400909423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_search_location_qu_location_id.24f8f068be", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.897649Z", "completed_at": "2024-10-31T20:35:40.900429Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.900752Z", "completed_at": "2024-10-31T20:35:40.900758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037577152252197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.brave_de_project.fact_search_product_performance_qu", "compiled": true, "compiled_code": "\n\n\nwith user_journey as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_journey_qu \n),\n\nvalid_users as (\n\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_user_data_qu\n   WHERE account_status = 'active'\n\n),\n\nproducts as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu   \n),\n\nsearch_data as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\n),\n\nsearch_loc as (\n   select * from BRAVE_DATABASE.PROJECT_TEST.dim_search_location_qu\n),\n\nfinal AS (\n   SELECT\n  \n      uj.search_event_id,\n      uj.user_id,\n      uj.product_id,\n      sd.search_data_id,\n      sl.location_id,\n\n      uj.search_terms,\n      uj.search_results_count,\n      uj.search_timestamp, \n      \n      vp.price,\n      vp.rating,\n      vp.sales_volume,\n      vp.discount_percentage,\n      vp.weight_grams,\n      \n      uj.has_qv,\n      uj.has_pdp,\n      uj.has_atc,\n      uj.has_purchase\n\n   FROM user_journey uj\n   INNER JOIN search_data sd \n      ON uj.search_model = sd.search_model\n      AND uj.search_type = sd.search_type\n      AND uj.search_feature = sd.search_feature\n      AND uj.search_terms_type = sd.search_terms_type\n   INNER JOIN search_loc sl\n      ON uj.country = sl.country\n      AND uj.city = sl.city\n      AND uj.region = sl.region\n      AND uj.zipcode = sl.zipcode   \n\n   INNER JOIN valid_users vu ON uj.user_id = vu.user_id\n   LEFT JOIN products vp ON uj.product_id = vp.product_id\n   \n)\n\n\nSELECT * FROM final", "relation_name": "BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.902549Z", "completed_at": "2024-10-31T20:35:40.906230Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.906572Z", "completed_at": "2024-10-31T20:35:40.906577Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004965782165527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.accepted_values_dim_search_qu_search_terms_type__manual_search__type_ahead.ac36c8c8d1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        search_terms_type as value_field,\n        count(*) as n_records\n\n    from BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\n    group by search_terms_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'manual-search','type-ahead'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.908048Z", "completed_at": "2024-10-31T20:35:40.910698Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.910993Z", "completed_at": "2024-10-31T20:35:40.910998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003607511520385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_data_id.be8f546b22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_data_id\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_data_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.912405Z", "completed_at": "2024-10-31T20:35:40.916025Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.916317Z", "completed_at": "2024-10-31T20:35:40.916322Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004586935043334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_feature.88f533c6df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_feature\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_feature is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.917720Z", "completed_at": "2024-10-31T20:35:40.920361Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.920666Z", "completed_at": "2024-10-31T20:35:40.920671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036118030548095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_model.26ef00f9df", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_model\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_model is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.922176Z", "completed_at": "2024-10-31T20:35:40.924752Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.925069Z", "completed_at": "2024-10-31T20:35:40.925076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035791397094726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_dim_search_qu_search_type.8a6c5876d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_type\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.926574Z", "completed_at": "2024-10-31T20:35:40.929122Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.929459Z", "completed_at": "2024-10-31T20:35:40.929465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003582000732421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.unique_dim_search_qu_search_data_id.3fce824941", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    search_data_id as unique_field,\n    count(*) as n_records\n\nfrom BRAVE_DATABASE.PROJECT_TEST.dim_search_qu\nwhere search_data_id is not null\ngroup by search_data_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.930958Z", "completed_at": "2024-10-31T20:35:40.933678Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.934003Z", "completed_at": "2024-10-31T20:35:40.934008Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037374496459960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inv_detail_id.867e89a33c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inv_detail_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere inv_detail_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.935545Z", "completed_at": "2024-10-31T20:35:40.938229Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.938561Z", "completed_at": "2024-10-31T20:35:40.938566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003726482391357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_inventory_id.f281743815", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere inventory_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.940064Z", "completed_at": "2024-10-31T20:35:40.942793Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.943112Z", "completed_at": "2024-10-31T20:35:40.943118Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037393569946289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_product_id.14e454bbbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.944648Z", "completed_at": "2024-10-31T20:35:40.948221Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.948552Z", "completed_at": "2024-10-31T20:35:40.948557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004615306854248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_supplier_id.b6ddfc6ca2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere supplier_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.949955Z", "completed_at": "2024-10-31T20:35:40.952494Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.952817Z", "completed_at": "2024-10-31T20:35:40.952823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035212039947509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_inventory_management_qu_warehouse_id.2d2a662617", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect warehouse_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nwhere warehouse_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.954329Z", "completed_at": "2024-10-31T20:35:40.956296Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.956595Z", "completed_at": "2024-10-31T20:35:40.956600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029506683349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fim_price_discount", "compiled": true, "compiled_code": "-- Testing for the presence if price is greater than discounts in fact_inventory_management_qu\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_inventory_management_qu\nWHERE\n    price < discounts\nHAVING\n    invalid_rows > 0", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.958074Z", "completed_at": "2024-10-31T20:35:40.960679Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.960979Z", "completed_at": "2024-10-31T20:35:40.960984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035910606384277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_campaign_id.b94a331b03", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.962373Z", "completed_at": "2024-10-31T20:35:40.965097Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.965404Z", "completed_at": "2024-10-31T20:35:40.965409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036716461181640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_id.b81d35f2e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.966820Z", "completed_at": "2024-10-31T20:35:40.969441Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.969744Z", "completed_at": "2024-10-31T20:35:40.969749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035855770111083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_product_price.614bc7227e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_price\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere product_price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.971203Z", "completed_at": "2024-10-31T20:35:40.973799Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.974113Z", "completed_at": "2024-10-31T20:35:40.974118Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003609180450439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_campaign_effectiveness_qu_user_id.0f38b88b52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.975510Z", "completed_at": "2024-10-31T20:35:40.978435Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.978728Z", "completed_at": "2024-10-31T20:35:40.978733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038650035858154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fce_campaign_id", "compiled": true, "compiled_code": "-- Testing for the presence of campaign_id in fact_campaign_effectiveness_qu\nSELECT\n    fce.campaign_id\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce\nLEFT JOIN\n    BRAVE_DATABASE.PROJECT_TEST.dim_campaign_qu dc\nON\n    fce.campaign_id = dc.campaign_id\nWHERE\n    dc.campaign_id IS NULL", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.980200Z", "completed_at": "2024-10-31T20:35:40.982242Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.982547Z", "completed_at": "2024-10-31T20:35:40.982552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030221939086914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fce_product_id", "compiled": true, "compiled_code": "-- This test checks if the product_id in the fact_campaign_effectiveness_qu\n-- table is present in the stg_product_data_qu table and if the product_price\n-- in the fact_campaign_effectiveness_qu table is the same as the price in the\n-- stg_product_data_qu table.\n-- The test will fail if the product_id is not present in the stg_product_data_qu\n-- table or if the product_price in the fact_campaign_effectiveness_qu table is\n-- not the same as the price in the stg_product_data_qu table.\n\nSELECT\n    fce.product_id,\n    fce.product_price AS fce_price,\n    spd.price AS spd_price\nFROM BRAVE_DATABASE.PROJECT_TEST.fact_campaign_effectiveness_qu fce\n    \nLEFT JOIN BRAVE_DATABASE.PROJECT_TEST.stg_product_data_qu spd\nON\n    fce.product_id = spd.product_id\nWHERE\n    spd.product_id IS NULL\n    OR fce.product_price != spd.price", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.983936Z", "completed_at": "2024-10-31T20:35:40.986531Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.986830Z", "completed_at": "2024-10-31T20:35:40.986835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003543853759765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_location_id.c15a71a61c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect location_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere location_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.988340Z", "completed_at": "2024-10-31T20:35:40.991230Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.991540Z", "completed_at": "2024-10-31T20:35:40.991545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003894329071044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_product_id.766329f7bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.992951Z", "completed_at": "2024-10-31T20:35:40.995484Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:40.995784Z", "completed_at": "2024-10-31T20:35:40.995789Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0034918785095214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_data_id.34ccbdc3f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_data_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere search_data_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:40.997298Z", "completed_at": "2024-10-31T20:35:40.999936Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:41.000236Z", "completed_at": "2024-10-31T20:35:41.000242Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003632783889770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_search_event_id.c2c96fc986", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect search_event_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere search_event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:41.001668Z", "completed_at": "2024-10-31T20:35:41.004431Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:41.004761Z", "completed_at": "2024-10-31T20:35:41.004767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037581920623779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.not_null_fact_search_product_performance_qu_user_id.57c3994493", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-31T20:35:41.006241Z", "completed_at": "2024-10-31T20:35:41.008225Z"}, {"name": "execute", "started_at": "2024-10-31T20:35:41.008537Z", "completed_at": "2024-10-31T20:35:41.008542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029625892639160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.brave_de_project.test_fspp_data", "compiled": true, "compiled_code": "-- Test: test_fspp_data\n-- Description: This test checks if the user_id in the fact_search_product_performance_qu\n-- table is present in the dim_user_qu table and if the discount_percentage in the\n-- fact_search_product_performance_qu table is between 0 and 100, given the account_status\n-- in the dim_user_qu table is 'active'.\nSELECT\n    COUNT(*) AS invalid_rows\nFROM\n    BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu fsp\nJOIN\n    BRAVE_DATABASE.PROJECT_TEST.dim_user_qu du\nON\n    fsp.user_id = du.user_id\nWHERE\n    (discount_percentage < 0 OR discount_percentage > 100)\n    OR du.account_status != 'active'\nHAVING\n    invalid_rows > 0", "relation_name": null}], "elapsed_time": 4.214334487915039, "args": {"select": [], "require_resource_names_without_spaces": false, "project_dir": "/home/user/Documents/AirflowSnowflakeProject/dbt", "static_parser": true, "vars": {}, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "introspect": true, "quiet": false, "use_colors": true, "log_level_file": "debug", "strict_mode": false, "write_json": true, "profiles_dir": "/home/user/.dbt", "invocation_command": "dbt docs generate", "use_colors_file": true, "which": "generate", "favor_state": false, "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "log_format_file": "debug", "enable_legacy_logger": false, "log_path": "/home/user/Documents/AirflowSnowflakeProject/dbt/logs", "log_file_max_bytes": 10485760, "printer_width": 80, "empty_catalog": false, "indirect_selection": "eager", "defer": false, "static": false, "exclude": [], "version_check": true, "macro_debugging": false, "partial_parse": true, "partial_parse_file_diff": true, "log_format": "default", "show_resource_report": false, "source_freshness_run_project_hooks": false, "cache_selected_only": false, "compile": true, "print": true}}