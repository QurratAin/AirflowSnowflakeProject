-- back compat for old kwarg name
  
  begin;
    
        
            
                
                
            
                
                
            
        
    

    

    merge into BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu as DBT_INTERNAL_DEST
        using BRAVE_DATABASE.PROJECT_TEST.fact_search_product_performance_qu__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.user_id = DBT_INTERNAL_DEST.user_id
                ) and (
                    DBT_INTERNAL_SOURCE.search_event_id = DBT_INTERNAL_DEST.search_event_id
                )

    
    when matched then update set
        "SEARCH_EVENT_ID" = DBT_INTERNAL_SOURCE."SEARCH_EVENT_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","SEARCH_DATA_ID" = DBT_INTERNAL_SOURCE."SEARCH_DATA_ID","LOCATION_ID" = DBT_INTERNAL_SOURCE."LOCATION_ID","SEARCH_TERMS" = DBT_INTERNAL_SOURCE."SEARCH_TERMS","SEARCH_RESULTS_COUNT" = DBT_INTERNAL_SOURCE."SEARCH_RESULTS_COUNT","SEARCH_TIMESTAMP" = DBT_INTERNAL_SOURCE."SEARCH_TIMESTAMP","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RATING" = DBT_INTERNAL_SOURCE."RATING","SALES_VOLUME" = DBT_INTERNAL_SOURCE."SALES_VOLUME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE","WEIGHT_GRAMS" = DBT_INTERNAL_SOURCE."WEIGHT_GRAMS","HAS_QV" = DBT_INTERNAL_SOURCE."HAS_QV","HAS_PDP" = DBT_INTERNAL_SOURCE."HAS_PDP","HAS_ATC" = DBT_INTERNAL_SOURCE."HAS_ATC","HAS_PURCHASE" = DBT_INTERNAL_SOURCE."HAS_PURCHASE"
    

    when not matched then insert
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")
    values
        ("SEARCH_EVENT_ID", "USER_ID", "PRODUCT_ID", "SEARCH_DATA_ID", "LOCATION_ID", "SEARCH_TERMS", "SEARCH_RESULTS_COUNT", "SEARCH_TIMESTAMP", "PRICE", "RATING", "SALES_VOLUME", "DISCOUNT_PERCENTAGE", "WEIGHT_GRAMS", "HAS_QV", "HAS_PDP", "HAS_ATC", "HAS_PURCHASE")

;
    commit;